<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
  <DataSources>
    <DataSource Name="DataSource1">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString>Data Source=VENKAT\SQLEXPRESS;Initial Catalog=MedAll</ConnectString>
      </ConnectionProperties>
      <rd:DataSourceID>c91f57c1-244a-40e3-8cc3-37215e5be467</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Fields>
        <Field Name="SeqNo">
          <DataField>SeqNo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Time">
          <DataField>Time</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Blood">
          <DataField>Blood</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Urine">
          <DataField>Urine</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DefaultValue">
          <DataField>DefaultValue</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="UOM">
          <DataField>UOM</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Type">
          <DataField>Type</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InvestigationID">
          <DataField>InvestigationID</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
        <Field Name="InvestigationName">
          <DataField>InvestigationName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GlucoseValue">
          <DataField>GlucoseValue</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandType>StoredProcedure</CommandType>
        <CommandText>pGetGttReportForaPatient</CommandText>
        <QueryParameters>
          <QueryParameter Name="@pVisitID">
            <Value>=Parameters!pVisitID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@OrgID">
            <Value>=Parameters!OrgID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@TemplateID">
            <Value>=Parameters!TemplateID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@InvestigationID">
            <Value>=Parameters!InvestigationID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="DataSet3">
      <Fields>
        <Field Name="InvestigationName">
          <DataField>InvestigationName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GlucoseValue">
          <DataField>GlucoseValue</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>DECLARE @idoc int      
DECLARE @doc varchar(MAX) 

Declare @Temp Table        
(       
 PatientVisitID bigint,       
 InvestigationID bigint,       
 InvestigationName varchar(255),       
 ReportName varchar(255),       
 TemplateID int,      
 ReportStatus varchar(255)       
      
)       
insert into @Temp       
      
    SELECT piv.PatientVisitID,piv.InvestigationID       
    ,piv.InvestigationName       
    --,ISNULL (im.reporttemplatename,       
    --(SELECT Reporttemplatename       
    --FROM InvReportMaster       
    --WHERE IsDefault='Y')) 
    ,im.ReportTemplateName  AS ReportName       
    --,ISNULL(im.templateid,       
    --(SELECT TemplateID from InvReportMaster       
    --WHERE IsDefault='Y'))
    ,im.TemplateID   AS TemplateID 
    ,piv.ReportStatus      
    FROM PatientInvestigation piv       
    LEFT OUTER JOIN invreportmapping irm ON irm.investigationid = piv.InvestigationID       
    LEFT OUTER JOIN invreportmaster im ON im.templateid = irm.templateid       
    WHERE piv.PatientVisitID=@pVisitID      
    AND piv.OrgID=@OrgID    and im.TemplateID = @TemplateID and im.OrgID = @OrgID
      
SET @doc = (SELECT Value FROM InvestigationValues  invValues      
   inner join @Temp tmp on tmp.InvestigationID = invValues.InvestigationID      
   and tmp.PatientVisitID =invValues.PatientVisitID       
   where tmp.InvestigationID=@InvestigationID and tmp.TemplateID=@TemplateID    
   and invValues.Orgid=@OrgID)      
      

EXEC sp_xml_preparedocument @idoc OUTPUT, @doc

SELECT InvestigationName , GlucoseValue    
FROM   OPENXML (@idoc, '/InvestigationResults/InvestigationDetails')      
WITH  (      
  		InvestigationName varchar(500) 'InvestigationName',     
 		GlucoseValue  varchar(500) 'GlucoseValue'
		            
      )</CommandText>
        <QueryParameters>
          <QueryParameter Name="@pVisitID">
            <Value>=Parameters!pVisitID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@OrgID">
            <Value>=Parameters!OrgID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@InvestigationID">
            <Value>=Parameters!InvestigationID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@TemplateID">
            <Value>=Parameters!TemplateID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <Body>
    <ReportItems>
      <Tablix Name="Tablix9">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="InvestigationName">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!InvestigationName.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>InvestigationName</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>4</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox87">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Time</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox86</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox89">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Blood</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox88</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox91">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Urine</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox90</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox4">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox4</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Time2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Fasting:</Value>
                              <Style />
                            </TextRun>
                            <TextRun>
                              <Value>=Fields!Time.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Time2</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Blood2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Blood.Value</Value>
                              <Style />
                            </TextRun>
                            <TextRun>
                              <Value>=Fields!UOM.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Blood2</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Urine2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Urine.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Urine2</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox126">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox126</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox11">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Amount Of Glucose in grams : </Value>
                              <Style>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                            <TextRun>
                              <Value>=Fields!GlucoseValue.Value</Value>
                              <Style>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <LeftIndent>0cm</LeftIndent>
                          <HangingIndent>0cm</HangingIndent>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox1</rd:DefaultName>
                      <ZIndex>1</ZIndex>
                      <Style>
                        <Border />
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox127">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style>
                                <FontSize>9pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox127</rd:DefaultName>
                      <Style>
                        <Border />
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.65809in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Subreport Name="Subreport4">
                      <ReportName>SubGttRdmValue</ReportName>
                      <Parameters>
                        <Parameter Name="pVisitID">
                          <Value>=Parameters!pVisitID.Value</Value>
                        </Parameter>
                        <Parameter Name="OrgID">
                          <Value>=Parameters!OrgID.Value</Value>
                        </Parameter>
                        <Parameter Name="TemplateID">
                          <Value>=Parameters!TemplateID.Value</Value>
                        </Parameter>
                        <Parameter Name="InvestigationID">
                          <Value>=Fields!InvestigationID.Value</Value>
                        </Parameter>
                        <Parameter Name="ConnectionString">
                          <Value>=Parameters!ConnectionString.Value</Value>
                        </Parameter>
                      </Parameters>
                      <ZIndex>7</ZIndex>
                      <Style>
                        <Border>
                          <Style>None</Style>
                        </Border>
                      </Style>
                    </Subreport>
                    <ColSpan>3</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
                <TablixCell />
                <TablixCell>
                  <CellContents>
                    <Subreport Name="Subreport7">
                      <ReportName>SubGttChart</ReportName>
                      <Parameters>
                        <Parameter Name="pVisitID">
                          <Value>=Parameters!pVisitID.Value</Value>
                        </Parameter>
                        <Parameter Name="OrgID">
                          <Value>=Parameters!OrgID.Value</Value>
                        </Parameter>
                        <Parameter Name="TemplateID">
                          <Value>=Parameters!TemplateID.Value</Value>
                        </Parameter>
                        <Parameter Name="InvestigationID">
                          <Value>=Fields!InvestigationID.Value</Value>
                        </Parameter>
                        <Parameter Name="ConnectionString">
                          <Value>=Parameters!ConnectionString.Value</Value>
                        </Parameter>
                      </Parameters>
                      <ZIndex>7</ZIndex>
                      <Style>
                        <Border>
                          <Style>None</Style>
                        </Border>
                      </Style>
                    </Subreport>
                    <rd:Selected>true</rd:Selected>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="Group1">
                <GroupExpressions>
                  <GroupExpression>=Fields!InvestigationID.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!InvestigationID.Value</Value>
                </SortExpression>
              </SortExpressions>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Details2" />
                  <TablixMembers>
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet1</DataSetName>
        <Filters>
          <Filter>
            <FilterExpression>=Fields!Type.Value</FilterExpression>
            <Operator>Equal</Operator>
            <FilterValues>
              <FilterValue>Fasting</FilterValue>
            </FilterValues>
          </Filter>
          <Filter>
            <FilterExpression>=Fields!DefaultValue.Value</FilterExpression>
            <Operator>NotEqual</Operator>
            <FilterValues>
              <FilterValue>Y</FilterValue>
            </FilterValues>
          </Filter>
        </Filters>
        <Height>1.65809in</Height>
        <Width>4in</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>1.69976in</Height>
    <Style>
      <Border>
        <Style>None</Style>
      </Border>
    </Style>
  </Body>
  <ReportParameters>
    <ReportParameter Name="pVisitID">
      <DataType>Integer</DataType>
      <Prompt>p Visit ID</Prompt>
    </ReportParameter>
    <ReportParameter Name="OrgID">
      <DataType>Integer</DataType>
      <Prompt>Org ID</Prompt>
    </ReportParameter>
    <ReportParameter Name="TemplateID">
      <DataType>Integer</DataType>
      <Prompt>Template ID</Prompt>
    </ReportParameter>
    <ReportParameter Name="InvestigationID">
      <DataType>String</DataType>
      <Prompt>InvestigationID</Prompt>
    </ReportParameter>
    <ReportParameter Name="ConnectionString">
      <DataType>String</DataType>
      <Prompt>ConnectionString</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Width>4.02786in</Width>
  <Page>
    <PageHeight>10.02in</PageHeight>
    <PageWidth>8.66in</PageWidth>
    <LeftMargin>0.59in</LeftMargin>
    <TopMargin>1.3in</TopMargin>
    <BottomMargin>1.3in</BottomMargin>
    <Style />
  </Page>
  <rd:ReportID>f10b31ee-ee68-47ed-a343-6aa7e3229c9a</rd:ReportID>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
</Report>