
if not exists(select * from ActionManagerType where [ActionType]='Email')  
INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay]) VALUES (N'Email', N'Y')
go
if not exists(select * from ActionManagerType where [ActionType]='RedirectURL')  
INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay]) VALUES (N'RedirectURL', N'N')
go
if not exists(select * from ActionManagerType where [ActionType]='Sms')  

INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay]) VALUES (N'Sms', N'Y')
go
if not exists(select * from ActionManagerType where [ActionType]='Sms/Email')  

INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay]) VALUES (N'Sms/Email', N'Y')
go

if not exists(select * from ActionManagerType where [ActionType]='Postal')  

INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay]) VALUES (N'Postal', N'Y')
go

 if not exists(select * from [ClientAttributes] where [AttributeName]='Invoice')  
 INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES (N'Invoice', N'INV', NULL)
 go
 if not exists(select * from [ClientAttributes] where [AttributeName]='TurnOver Discount')  
INSERT [dbo].[ClientAttributes] ( [AttributeName], [AttributeCode], [OrgID]) VALUES (N'TurnOver Discount', N'TOD', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='Registration SMS')   
INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES ( N'Registration SMS', N'RSMS', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='Bill SMS')  
INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES ( N'Bill SMS', N'BSMS', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='Reply SMS')  

INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES (N'Reply SMS', N'REPSMS', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='Header Logo')  
INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES (N'Header Logo', N'HL', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='Stationery Type')  

INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES (N'Stationery Type', N'ST', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='IsReply Email')  
INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES (N'IsReply Email', N'REPEMail', NULL)
go
 if not exists(select * from [ClientAttributes] where [AttributeName]='Footer Logo')  
INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode], [OrgID]) VALUES (N'Footer Logo', N'HL', NULL)
GO
IF NOT EXISTS(SELECT * FROM [TaskEntityMap] WHERE [MappingType]='InvestigationStatus' AND [MappingID]=2 AND [TaskActionID]=39)
	INSERT [dbo].[TaskEntityMap] ([MappingType], [MappingID], [TaskActionID]) VALUES (N'InvestigationStatus', 2, 39)
GO
IF NOT EXISTS(SELECT * FROM [TaskEntityMap] WHERE [MappingType]='InvestigationStatus' AND [MappingID]=11 AND [TaskActionID]=62)
	INSERT [dbo].[TaskEntityMap] ([MappingType], [MappingID], [TaskActionID]) VALUES (N'InvestigationStatus', 11, 62)
GO
 
IF NOT EXISTS(SELECT * FROM [TaskActions] WHERE [ActionName]='EnterResult')
insert into TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category,RoleID) select MAX(TaskActionID)+1,'EnterResult','','',0,'EnterResult',0 from TaskActions
GO
-----------New Investigation Status Added in InvestigationStatus Master Table------------------------- 
IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Retest')
insert into InvestigationStatus(InvestigationStatusID,Status) select MAX(InvestigationStatusID)+1,'Retest' from InvestigationStatus
GO
IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Validate')
insert into InvestigationStatus(InvestigationStatusID,Status) select MAX(InvestigationStatusID)+1,'Validate' from InvestigationStatus
GO
 
IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Ordered')
insert into InvestigationStatus(InvestigationStatusID,Status) select MAX(InvestigationStatusID)+1,'Ordered' from InvestigationStatus
GO

IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Recheck')
	BEGIN
		IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Retest With Existing Sample')
		insert into InvestigationStatus(InvestigationStatusID,Status) select MAX(InvestigationStatusID)+1,'Retest With Existing Sample' from InvestigationStatus
		
		IF EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Retest With Existing Sample')
		Update InvestigationStatus Set Status='Recheck' WHERE [Status]='Retest With Existing Sample'
	END
GO 


IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='Refered')
insert into InvestigationStatus(InvestigationStatusID,Status) select MAX(InvestigationStatusID)+1,'Refered' from InvestigationStatus
GO

IF NOT EXISTS(SELECT * FROM [InvestigationStatus] WHERE [Status]='SampleTransferred')
insert into InvestigationStatus(InvestigationStatusID,Status) select MAX(InvestigationStatusID)+1,'SampleTransferred' from InvestigationStatus
GO
---------------------------------------------------------------------------------------------------------

-----------Module Category Added in ModuleCategory Master Table------------------------- 
IF NOT EXISTS(SELECT * FROM ModuleCategory WHERE ModuleCode='LAB')
 INSERT INTO ModuleCategory(ModuleName,ModuleCode) VALUES ('Lab Management','LAB')
GO
IF NOT EXISTS(SELECT * FROM ModuleCategory WHERE ModuleCode='IP')
 INSERT INTO ModuleCategory(ModuleName,ModuleCode) VALUES ('IP Management','IP')
GO
IF NOT EXISTS(SELECT * FROM ModuleCategory WHERE ModuleCode='INV')
 INSERT INTO ModuleCategory(ModuleName,ModuleCode) VALUES ('Inventory Management','INV')
GO
IF NOT EXISTS(SELECT * FROM ModuleCategory WHERE ModuleCode='FDM')
INSERT INTO ModuleCategory(ModuleName,ModuleCode) VALUES ('Frontdisk Management','FDM')
GO
---------------------------------------------------------------------------------------------------------

------ For Employee Master in MetroPolis --------
BEGIN
	DECLARE @OrgIDMetro BIGINT
	SET @OrgIDMetro=67
	IF NOT EXISTS(SELECT 1 FROM CorporateEmployeeNoMaster WHERE OrgID=@OrgIDMetro AND EmployeeNo=1)
	BEGIN
		INSERT INTO CorporateEmployeeNoMaster(OrgID,EmployeeNo)VALUES(@OrgIDMetro,1)
	END
	IF NOT EXISTS(SELECT 1 FROM CorporateExtendedIDMaster WHERE OrgID=@OrgIDMetro AND ExtendedNo=1)
	BEGIN
		INSERT INTO CorporateExtendedIDMaster(OrgID,ExtendedNo)VALUES(@OrgIDMetro,1)
	END
	IF NOT EXISTS(SELECT 1 FROM CorporateExternalIDMaster WHERE OrgID=@OrgIDMetro AND ExternalNo=1)
	BEGIN
		INSERT INTO CorporateExternalIDMaster(OrgID,ExternalNo)VALUES(@OrgIDMetro,1)
	END
END
------ Employee Master --------

------ Trigger workflow action for Lab Patient Registration --------
BEGIN
	IF EXISTS (SELECT 1 FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='\Billing\LabQuickBilling.aspx')
	BEGIN
		UPDATE Pages SET PageURL='/Billing/LabQuickBilling.aspx' WHERE PageName='Lab Quick Billing' AND PageURL='\Billing\LabQuickBilling.aspx'
	END
	IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='/Billing/LabQuickBilling.aspx')
	BEGIN
		INSERT INTO Pages(PageID,PageName,PageURL)
		SELECT MAX(PageID)+1,'Lab Quick Billing','/Billing/LabQuickBilling.aspx' FROM Pages
	END
	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ActionManagerType]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM ActionManagerType WHERE ActionType='Sms')
			INSERT INTO ActionManagerType(ActionType) VALUES('Sms')
			
		IF NOT EXISTS (SELECT 1 FROM ActionManagerType WHERE ActionType='Email')
			INSERT INTO ActionManagerType(ActionType) VALUES('Email')
			
		IF NOT EXISTS (SELECT 1 FROM ActionManagerType WHERE ActionType='RedirectURL')
			INSERT INTO ActionManagerType(ActionType) VALUES('RedirectURL')
	END

	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ActionTemplateType]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM ActionTemplateType WHERE TemplateType='Booking')
			INSERT INTO ActionTemplateType(TemplateType) VALUES('Booking')
			
		IF NOT EXISTS (SELECT 1 FROM ActionTemplateType WHERE TemplateType='PatientRegistration')
			INSERT INTO ActionTemplateType(TemplateType) VALUES('PatientRegistration')
			
		IF NOT EXISTS (SELECT 1 FROM ActionTemplateType WHERE TemplateType='Report')
			INSERT INTO ActionTemplateType(TemplateType) VALUES('Report')
	END
	IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {PatientName},</p><p>Your investigation e-report is now being sent to you as a pdf document. Please enter your patient number as password, to view your report.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{OrgAddress}</strong></div></div>')
	BEGIN
		UPDATE ActionTemplate SET Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {Name},</p><p>Your investigation e-report is now being sent to you as a pdf document. Please enter your patient number as password, to view your report.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{OrgAddress}</strong></div></div>' WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {PatientName},</p><p>Your investigation e-report is now being sent to you as a pdf document. Please enter your patient number as password, to view your report.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{OrgAddress}</strong></div></div>'
	END
	IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {PatientName},\nYour test request has been registered successfully with\n{OrgName} at {MsgedDate}. Thank you.')
	BEGIN
		UPDATE ActionTemplate SET Template='Dear {Name}, Your test request has been registered successfully with {OrgName} at {MsgedDate}. Thank you.' WHERE Template='Dear {PatientName}, Your test request has been registered successfully with {OrgName} at {MsgedDate}. Thank you.'
	END
	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ActionTemplate]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {Name}, Your test request has been registered successfully with {OrgName} at {MsgedDate}. Thank you.' AND TemplateTypeID=(SELECT TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'))
		BEGIN
			INSERT INTO ActionTemplate(TemplateTypeID,Template)
			SELECT (SELECT TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'),'Dear {Name}, Your test request has been registered successfully with {OrgName} at {MsgedDate}. Thank you.'
		END
		IF NOT EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {Name},</p><p>Your investigation e-report is now being sent to you as a pdf document. Please enter your patient number as password, to view your report.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{OrgAddress}</strong></div></div>' AND TemplateTypeID=(SELECT TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'))
		BEGIN
			INSERT INTO ActionTemplate(TemplateTypeID,Template)
			SELECT (SELECT TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'),'<div style="font-family:Verdana;font-size:12;"><p>Dear {Name},</p><p>Your investigation e-report is now being sent to you as a pdf document. Please enter your patient number as password, to view your report.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{OrgAddress}</strong></div></div>'
		END
	END

	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PageContext]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='/Billing/LabQuickBilling.aspx') AND ButtonName='btnGenerate')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='/Billing/LabQuickBilling.aspx'),'btnGenerate','Generate Bill'
		END
	END

	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PageContextActionMapping]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='/Billing/LabQuickBilling.aspx') AND ButtonName='btnGenerate') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='LabReception' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
		BEGIN
			INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
			SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='/Billing/LabQuickBilling.aspx') AND ButtonName='btnGenerate'),(SELECT RoleId FROM Role WHERE RoleName='LabReception' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),1,'P'
		END
	END
END
------ Trigger workflow action for Lab Patient Registration --------

------ Trigger Workflow Action for Investigation Approval --------
BEGIN
	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Pages]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx')
		BEGIN
			INSERT INTO Pages(PageID,PageName,PageURL)
			SELECT MAX(PageID)+1,'InvestigationApproval','/Investigation/InvestigationApprovel.aspx' FROM Pages
		END
	END
	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ActionTemplate]') AND type in (N'U', N'PC'))
	BEGIN
		IF EXISTS (SELECT 1 FROM ActionTemplateType WHERE TemplateType='Report')
		BEGIN
			IF NOT EXISTS (SELECT 1 FROM ActionTemplate WHERE Template='Dear {Name}, Your report is ready. Pls have them collected at your convinience.')
			BEGIN
				INSERT INTO ActionTemplate(TemplateTypeID,Template)
				SELECT (SELECT TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'),'Dear {Name}, Your report is ready. Pls have them collected at your convinience.'
			END
		END
	END
	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PageContext]') AND type in (N'U', N'PC'))
	BEGIN
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR1')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx'),'btnShowRR1','Save And Continue'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSave')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx'),'btnSave','Save And Continue'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx'),'btnShowRR','Save And Continue'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSaveConfirm')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx'),'btnSaveConfirm','Yes'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval1')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx'),'btnApproval1','Save And Home'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx'),'btnApproval','Save And Home'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave1')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx'),'btnSave1','Save'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch1')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx'),'btnSaveToDispatch1','Save And Home'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx'),'btnSave','Save'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx'),'btnSaveToDispatch','Save And Home'
		END
		IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveConfirm')
		BEGIN
			INSERT INTO PageContext(PageID,ButtonName,ButtionValue)
			SELECT (SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx'),'btnSaveConfirm','Yes'
		END
	END

	IF EXISTS (SELECT 1 FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PageContextActionMapping]') AND type in (N'U', N'PC'))
	BEGIN
		IF EXISTS(SELECT 1 FROM Role WHERE RoleName='Lab Technician' and OrgID=67)
		BEGIN
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR1'),(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSave') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSave'),(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR'),(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSaveConfirm') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSaveConfirm'),(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval1'),(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval'),(SELECT RoleId FROM Role WHERE RoleName='Lab Technician' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
		END
		IF EXISTS(SELECT 1 FROM Role WHERE RoleName='SrLabTech' and OrgID=67)
		BEGIN
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR1'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSave') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSave'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnShowRR'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSaveConfirm') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnSaveConfirm'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval1'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationResultsCapture' AND PageURL='/Investigation/InvestigationResultsCapture.aspx') AND ButtonName='btnApproval'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			
			--- Approval Page for SrLabTech
			
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave1'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch1'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveConfirm') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveConfirm'),(SELECT RoleId FROM Role WHERE RoleName='SrLabTech' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
		END
		IF EXISTS(SELECT 1 FROM Role WHERE RoleName='Doctor' and OrgID=67)
		BEGIN
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave1'),(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch1') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch1'),(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSave'),(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveToDispatch'),(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
			IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=(SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveConfirm') AND RoleID=(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67) AND ActionTypeID=(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms') AND ContextType='P')
			BEGIN
				INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
				SELECT (SELECT PageContextID FROM PageContext WHERE PageID=(SELECT PageID FROM Pages WHERE PageName='InvestigationApproval' AND PageURL='/Investigation/InvestigationApprovel.aspx') AND ButtonName='btnSaveConfirm'),(SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=67),(SELECT ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'),(SELECT MAX(TemplateID) FROM ActionTemplate),'P'
			END
		END
	END
END
------ Trigger Workflow Action for Investigation Approval --------

--------------SearchColumns--------------
IF NOT EXISTS(SELECT 1 from SearchColumns where SearchColumnName ='Location')
BEGIN
INSERT INTO SearchColumns(SearchColumnName) values('Location')
END

update Pages set PageName='Meta Master' where PageName='GroupMaster'
update MenuMaster set DisplayText='Meta Master' where DisplayText='GroupMaster'

IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageName='Blood/BloodComponet Request' AND PageURL='/BloodBank/BloodRequestForm.aspx')
BEGIN
  INSERT INTO pages(PageID,PageName,PageURL) SELECT Max(PageID)+1,'Blood/BloodComponet Request','/BloodBank/BloodRequestForm.aspx' FROM Pages
END
IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageName='Blood demand planning' AND PageURL='/BloodBank/BloodDemand.aspx')
BEGIN
  INSERT INTO pages(PageID,PageName,PageURL) SELECT Max(PageID)+1,'Blood demand planning','/BloodBank/BloodDemand.aspx' FROM Pages
END

-- Script for Bulk SMS ActionTemplate & Type ------------------
BEGIN
	
	DECLARE @TemplateTypeID INT

	INSERT INTO ActionTemplateType(TemplateType)VALUES('SMS')

	SELECT @TemplateTypeID=TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SMS'

	INSERT INTO ActionTemplate(TemplateTypeID,Template)VALUES(@TemplateTypeID,'Your Lab Test e-report is now being sent to you as a PDF document. Please enter your Patient Number as Password, to view your Report.    Sincerely,    {OrgName}  {OrgAddress}')
	INSERT INTO ActionTemplate(TemplateTypeID,Template)VALUES(@TemplateTypeID,'Dear Sir/Madam,    Your Lab Test e-report is now being sent to you as a PDF document. Please enter your Patient Number as Password, to view your Report.    Sincerely,    {OrgName}  {OrgAddress}')

END
-- Script for Bulk SMS ActionTemplate & Type ------------------


--ADD NEW TASK ACTION 

IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName='EpisodeApprovel')
BEGIN
	INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category)
	SELECT MAX(TaskActionID)+1,'EpisodeApprovel','~\ClinicalTrial\VisitEpisodeMaster.aspx?Eid={EpisodeID}','Approve Episode Details for (EpisodeName: {EpisodeName})(EpisodeNo:{EpisodeNo})',0,'Episode Approvel' FROM TaskActions
END
--- Add Summary Report Begin ---
DECLARE @pOrgID INT
SET @pOrgID = 67 --Metropolis
IF NOT EXISTS(SELECT 1 FROM InvReportMaster WHERE Type='SummaryReport' AND OrgID=@pOrgID)
BEGIN
	INSERT INTO InvReportMaster (TemplateID,ReportTemplateName,IsDefault,OrgID,IsActive,Type)
	SELECT Max(TemplateID)+1,'/Metropolis/SummaryReport','N',@pOrgID,'A','SummaryReport' FROM InvReportMaster
END
--- Add Summary Report End ---


-----------------------------------------------Daywise Collection Report for LIMS------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------
--IF NOT EXISTS(SELECT 1 FROM Pages WHERE PageName ='Daywise Collection Report' AND PageURL='/Reports/CollectionReportLIMS.aspx')
--BEGIN
--	IF EXISTS(SELECT 1 FROM Pages WHERE PageName ='Daywise Collection Report' AND PageURL='/Reports/CollectionReportOPIPWithFilter.aspx')
--	BEGIN 
--		UPDATE Pages SET PageURL ='/Reports/CollectionReportLIMS.aspx' WHERE PageID=(SELECT TOP 1 PageID FROM Pages WHERE PageName ='Daywise Collection Report' 
--					 AND PageURL='/Reports/CollectionReportOPIPWithFilter.aspx' )
--		UPDATE ReportMaster SET ReportPath='../Reports/CollectionReportLIMS.aspx',RedirectURL='../Reports/CollectionReportLIMS.aspx' 
--					 WHERE PageID=(SELECT TOP 1 PageID FROM Pages WHERE PageName ='Daywise Collection Report' 
--					 AND PageURL='/Reports/CollectionReportOPIPWithFilter.aspx' )
--	END
--	ELSE
--	BEGIN 
--		DECLARE @PageID bigint
--		SELECT @PageID=MAX(PageID)+1 FROM Pages
--		INSERT INTO ReportMaster (ReportID,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedAt,CreatedBy,PageID)
--		SELECT MAX(ReportID)+1,'Day-wise Collection Reports','../Reports/CollectionReportLIMS.aspx','../Reports/CollectionReportLIMS.aspx',5,GETDATE(),1,@PageID
--		FROM ReportMaster
--	END
--END	   
-----------------------------------------------Daywise Collection Report for LIMS------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------


-- To convert LabReferenceOrg - Status IS NULL into 'A' ---------
BEGIN
	DECLARE @OrgID INT
	SET @OrgID = 67
	IF EXISTS(SELECT 1 FROM LabReferenceOrg WHERE OrgID=@OrgID AND Status IS NULL)
	BEGIN
		UPDATE LabReferenceOrg SET Status='A' WHERE OrgID=@OrgID AND Status IS NULL
	END
END





IF NOT EXISTS (select 1 from PaymentType where PaymentName='Coupon')
BEGIN
	DECLARE @PaymentTypeID int
	select @PaymentTypeID=MAX(PaymentTypeID)+1 from PaymentType 
	insert into PaymentType
	select MAX(PaymentTypeID)+1,'Coupon',null,null,null,null,null,'N' from PaymentType
	insert into PaymentTypeOrgMapping
	select @PaymentTypeID,67,0,null,null,null,null,null
END
---------------------------------------------Rename PasswordPolicy menu as Policy Master------------------------------------------------------
IF EXISTS(SELECT 1 FROM Pages WHERE PageURL='/Admin/PasswordPolicy.aspx')
BEGIN
	UPDATE Pages SET PageName='Policy Master' WHERE PageURL='/Admin/PasswordPolicy.aspx'
END
IF EXISTS(SELECT 1 FROM MenuMaster MM JOIN Pages P ON P.PageID = MM.PageID WHERE P.PageURL='/Admin/PasswordPolicy.aspx')
BEGIN
	UPDATE MM SET DisplayText='Policy Master' FROM MenuMaster MM JOIN Pages P ON P.PageID = MM.PageID WHERE P.PageURL='/Admin/PasswordPolicy.aspx'
END
---------------------------------------------Rename PasswordPolicy menu as Policy Master------------------------------------------------------

 
IF NOT EXISTS(SELECT 1 from ShippingConditionMaster)
BEGIN
INSERT [dbo].[ShippingConditionMaster] ([ShippingConditionID], [ConditionDesc]) VALUES (0, N'--Select--')
INSERT [dbo].[ShippingConditionMaster] ([ShippingConditionID], [ConditionDesc]) VALUES (1, N'Refrigerated-(2oC to 8oC)')
INSERT [dbo].[ShippingConditionMaster] ([ShippingConditionID], [ConditionDesc]) VALUES (2, N'Frozen-(-20oC)')
INSERT [dbo].[ShippingConditionMaster] ([ShippingConditionID], [ConditionDesc]) VALUES (3, N'Temprature control Ambient-(15oC to 25oC )')
INSERT [dbo].[ShippingConditionMaster] ([ShippingConditionID], [ConditionDesc]) VALUES (4, N'Ambient–(Room temprature)')
END


   if not exists(select * from [ClientAttributes] where [AttributeName]='Is Sponsor')  
 INSERT [dbo].[ClientAttributes] ([AttributeName], [AttributeCode],[AttributesType] ,[OrgID]) VALUES (N'Is Sponsor', N'IS',N'Sponsor', NULL)
 go
 
 
 BEGIN
 
     ALTER TABLE Role ALTER COLUMN RoleName varchar(25)        
    DECLARE @NewRoleID BIGINT    
	DECLARE @orgid bigint
	set @orgid=67
    SELECT @NewRoleID=MAX(roleid) + 1 FROM Role    
    IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Credit Controller')
   BEGIN
    INSERT INTO Role (RoleID,RoleName,Description,OrgID)VALUES(@NewRoleID,'Credit Controller','Credit Controller',@orgid)
    END
    SELECT @NewRoleID=MAX(roleid) + 1 FROM Role
     IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Senior Credit Controller')
   BEGIN   
    INSERT INTO Role (RoleID,RoleName,Description,OrgID)VALUES(@NewRoleID,'Senior Credit Controller','Senior Credit Controller',@orgid)
    END
	DECLARE @pageID bigint
	select @pageID= PageID from Pages where PageURL ='/Reception/LabReceptionHome.aspx'
	DECLARE @RoleID bigint
	select @RoleID = RoleID from Role where RoleName='Credit Controller'
	 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
   BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
   END	
	
	DECLARE @sRoleID bigint
	select @sRoleID = RoleID from Role where RoleName='Senior Credit Controller'
	IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@sRoleID)
   BEGIN
	insert into PageMapping(RoleId,PageID,SeqNo) values(@sRoleID,@pageID,1)
	END
-----------------------------------------------------------------------------------------------------
DECLARE @RoleID1 bigint
select @RoleID1 = RoleID from Role where RoleName='Credit Controller'
DECLARE @RoleID2 bigint
select @RoleID2 = RoleID from Role where RoleName='Senior Credit Controller'
------------------------------------------------------------------------------------------------------
IF NOT EXISTS(SELECT RoleID FROM Role WHERE RoleID=@RoleID2)
BEGIN
DECLARE @pageID0 bigint
select @pageID0= PageID from Pages where PageURL ='/Reception/LabReceptionHome.aspx'
declare @menuid bigint
select @menuid = MenuID from MenuMaster where PageID=@pageID0
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuid,@RoleID2,'Y')
-----------------------------------------------------------------------------------------------
DECLARE @pageID1 bigint
select @pageID1= PageID from Pages where PageURL ='/ChangePassword/ChangePassword.aspx' 
declare @menuid1 bigint
select @menuid1 = MenuID from MenuMaster where PageID=@pageID1 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuid1,@RoleID2,'Y')
-----------------------------------------------------------------------------------------------
DECLARE @pageID2 bigint
select @pageID2= PageID from Pages where PageURL ='/Invoice/InvoiceTracker.aspx' 
declare @menuid2 bigint
select @menuid2 = MenuID from MenuMaster where PageID=@pageID2 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuid2,@RoleID2,'Y')
-----------------------------------------------------------------------------------------------
DECLARE @pageID3 bigint
select @pageID3= PageID from Pages where PageURL ='/Reports/ViewReportList.aspx' 
declare @menuid3 bigint
select @menuid3 = MenuID from MenuMaster where PageID=@pageID3 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuid3,@RoleID2,'Y')
insert into ReportOrgMapping(ReportID,RoleID,OrgID) values(5,@RoleID2,@orgid)
-----------------------------------------------------------------------------------------------
DECLARE @pageID4 bigint
select @pageID4= PageID from Pages where PageURL ='/Billing/HospitalBillSearch.aspx' 
declare @menuid4 bigint
select @menuid4 = MenuID from MenuMaster where PageID=@pageID4 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuid4,@RoleID2,'Y')
---------------------------------------------------------------------------------------------------
DECLARE @pageID5 bigint
select @pageID5= PageID from Pages where PageURL ='/Admin/DoctorSchedule.aspx' 
declare @menuid5 bigint
select @menuid5=Max(MenuID) from MenuMaster where PageID=@pageID5 and Parentid=7
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuid5,@RoleID2,'Y')
------------------------------------------------------------------------------------------------------
END

---------------------------------------------------------------------------------------------------------
IF NOT EXISTS(SELECT RoleID FROM Role WHERE RoleID=@RoleID1)
BEGIN
DECLARE @spageID0 bigint
select @spageID0= PageID from Pages where PageURL ='/Reception/LabReceptionHome.aspx'
declare @smenuid bigint
select @smenuid = MenuID from MenuMaster where PageID=@spageID0
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@smenuid,@RoleID1,'Y')
-----------------------------------------------------------------------------------------------
DECLARE @spageID1 bigint
select @spageID1= PageID from Pages where PageURL ='/ChangePassword/ChangePassword.aspx' 
declare @smenuid1 bigint
select @smenuid1 = MenuID from MenuMaster where PageID=@spageID1 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@smenuid1,@RoleID1,'Y')
-----------------------------------------------------------------------------------------------
DECLARE @spageID2 bigint
select @spageID2= PageID from Pages where PageURL ='/Invoice/InvoiceTracker.aspx' 
declare @smenuid2 bigint
select @smenuid2 = MenuID from MenuMaster where PageID=@spageID2 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@smenuid2,@RoleID1,'Y')
-----------------------------------------------------------------------------------------------
DECLARE @spageID3 bigint
select @spageID3= PageID from Pages where PageURL ='/Reports/ViewReportList.aspx' 
declare @smenuid3 bigint
select @smenuid3 = MenuID from MenuMaster where PageID=@spageID3 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@smenuid3,@RoleID1,'Y')
insert into ReportOrgMapping(ReportID,RoleID,OrgID) values(5,@RoleID1,@orgid)
-----------------------------------------------------------------------------------------------
DECLARE @spageID4 bigint
select @spageID4= PageID from Pages where PageURL ='/Billing/HospitalBillSearch.aspx' 
declare @smenuid4 bigint
select @smenuid4 = MenuID from MenuMaster where PageID=@spageID4 and OrgId=@orgid
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@smenuid4,@RoleID1,'Y')
---------------------------------------------------------------------------------------------------
DECLARE @spageID5 bigint
select @spageID5= PageID from Pages where PageURL ='/Admin/DoctorSchedule.aspx' 
declare @smenuid5 bigint
select @smenuid5=Max(MenuID) from MenuMaster where PageID=@spageID5 and Parentid=7
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@smenuid5,@RoleID1,'Y')
------------------------------------------------------------------------------------------------------
END
 
 END
 GO
 
-- VisitID for Barcode Place Holder
IF EXISTS(SELECT 1 FROM sys.objects o WHERE o.name ='BarcodePlaceHolders' and o.type ='U')
BEGIN
	IF NOT EXISTS (SELECT 1 FROM BarcodePlaceHolders WHERE Code='VisitID')	 
		INSERT INTO BarcodePlaceHolders (Name,Code) VALUES('Visit Number','VisitID')
END
GO

DECLARE @ClientTypeID INT
IF NOT EXISTS(SELECT 1 FROM InvClientType WHERE ClientTypeName='Super Franchisee' AND ClientTypeCode='SPF')
BEGIN
		SELECT @ClientTypeID=MAX(ClientTypeID)+1 FROM InvClientType
		INSERT INTO InvClientType (ClientTypeID,ClientTypeName,IsInternal,ClientTypeCode) VALUES(@ClientTypeID,'Super Franchisee','N','SPF')
END

IF NOT EXISTS(SELECT 1 FROM InvClientType WHERE ClientTypeName='HLM' AND ClientTypeCode='HLM')
BEGIN
		SELECT @ClientTypeID=MAX(ClientTypeID)+1 FROM InvClientType
		INSERT INTO InvClientType (ClientTypeID,ClientTypeName,IsInternal,ClientTypeCode) VALUES(@ClientTypeID,'HLM','N','HLM')
END

IF NOT EXISTS(SELECT 1 FROM InvClientType WHERE ClientTypeName='Insurance' AND ClientTypeCode='INS')
BEGIN
		SELECT @ClientTypeID=MAX(ClientTypeID)+1 FROM InvClientType
		INSERT INTO InvClientType (ClientTypeID,ClientTypeName,IsInternal,ClientTypeCode) VALUES(@ClientTypeID,'Insurance','N','INS')
END

IF NOT EXISTS(SELECT 1 FROM InvClientType WHERE ClientTypeName='Pharma' AND ClientTypeCode='PHM')
BEGIN
		SELECT @ClientTypeID=MAX(ClientTypeID)+1 FROM InvClientType
		INSERT INTO InvClientType (ClientTypeID,ClientTypeName,IsInternal,ClientTypeCode) VALUES(@ClientTypeID,'Pharma','N','PHM')
END
GO
IF NOT EXISTS(SELECT 1 FROM InvSampleStatusmaster WHERE InvSampleStatusDesc='Held for Storage')
BEGIN
		INSERT INTO InvSampleStatusmaster (InvSampleStatusID,InvSampleStatusDesc) VALUES(7,'Held for Storage')
END


/* Insert Action Template for Sending SMS about Client Blocking. This template only for Metropolis. GURUNATH.S 26/Oct/2012 */
/* Declaration Part */
DECLARE @PageID INT 
DECLARE @TemplateTypeID  INT 
DECLARE @Template varchar(1000)
DECLARE @PageContextID INT
DECLARE @RoleID INT
DECLARE @OrgID INT
DECLARE @ActionTypeID INT
DECLARE @TemplateID INT
/* End Declaration */

/* Add PageContext */
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Invoice/ClientMaster.aspx' AND PageName ='Client Master'
IF NOT EXISTS(SELECT 1 FROM PageContext WHERE PageID=@PageID AND ButtonName='btnFinish' AND ButtionValue='Save')
	INSERT INTO PageContext(PageID,ButtonName,ButtionValue) VALUES(@PageID,'btnFinish','Save')

/* Add Action TemplateType */
IF NOT EXISTS(SELECT 1 FROM ActionTemplateType WHERE TemplateType='ClientBlocking')
	INSERT INTO ActionTemplateType(TemplateType) VALUES('ClientBlocking')

/* Add ActionTemplate */
SELECT @TemplateTypeID= TemplateTypeID FROM ActionTemplateType WHERE TemplateType='ClientBlocking'
SET @Template='Dear {Name}. You have been {ClientStatus}  by Administrator from {BlockFrom} to {BlockTo}. Kindly, please contact administrator'
IF NOT EXISTS(SELECT 1 FROM ActionTemplate WHERE TemplateTypeID=@TemplateTypeID AND Template=@Template)
	INSERT INTO ActionTemplate(TemplateTypeID,Template) VALUES(@TemplateTypeID,@Template)
	
/* Add Page Context Action Mapping */
SELECT @PageContextID=PageContextID FROM PageContext WHERE PageID=@PageID
SELECT @RoleID = RoleID FROM Role WHERE RoleName ='Administrator' AND OrgID=67   -------------->>/* Please give corresponding OrgID and RoleName */
SELECT @ActionTypeID= ActionTypeID FROM ActionManagerType WHERE ActionType='Sms'
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE Template=@Template

IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND ActionTypeID=@ActionTypeID AND TemplateID=@TemplateID AND ContextType='CB')
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
                  VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,'CB')
                 

/*---------------------------------------------------------------------------------------------------------------------*/

---------------------------------------------Test Master Page & Menu------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=67

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Admin/LabMaster.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'Lab Master','/Admin/LabMaster.aspx'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/LabMaster.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'Test Master',2,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Admin/LabMaster.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END
---------------------------------------------Test Master Page & Menu------------------------------------------------------

---------------------------------------------Test Master Result Value, Category & Sub Category Meta Type Details------------------------------------------------------
DECLARE @OrgID INT
SET @OrgID=67

IF NOT EXISTS(SELECT 1 FROM MetaType_Common WHERE Code='TESTRESULTVALUE')
BEGIN
	INSERT INTO MetaType_Common (TypeName,Description,Code,OrgID,IsActive,SystemLevel) VALUES('TestResultValue','Investigation Result Value Type','TESTRESULTVALUE',@OrgID,'Y','Y')
END
IF NOT EXISTS(SELECT 1 FROM MetaValue_Common MVC JOIN MetaType_Common MTC ON MVC.MetaTypeId=MTC.MetaTypeId WHERE MTC.Code='TESTRESULTVALUE')
BEGIN
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'Numeric','NU',@OrgID,'Number','Y' FROM MetaType_Common WHERE Code='TESTRESULTVALUE'
	
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'AlphaNumeric','AN',@OrgID,'Alpha Numeric','Y' FROM MetaType_Common WHERE Code='TESTRESULTVALUE'
END
IF NOT EXISTS(SELECT 1 FROM MetaType_Common WHERE Code='TESTSUBCATEGORY')
BEGIN
	INSERT INTO MetaType_Common (TypeName,Description,Code,OrgID,IsActive,SystemLevel) VALUES('TestSubCategory','Investigation Sub Category','TESTSUBCATEGORY',@OrgID,'Y','Y')
END
IF NOT EXISTS(SELECT 1 FROM MetaValue_Common MVC JOIN MetaType_Common MTC ON MVC.MetaTypeId=MTC.MetaTypeId WHERE MTC.Code='TESTSUBCATEGORY')
BEGIN
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'InHouse','INH',@OrgID,'In House','Y' FROM MetaType_Common WHERE Code='TESTSUBCATEGORY'
	
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'OutSource','OUT',@OrgID,'OutSource','Y' FROM MetaType_Common WHERE Code='TESTSUBCATEGORY'
END
IF NOT EXISTS(SELECT 1 FROM MetaType_Common WHERE Code='INVESTIGATION_FEE')
BEGIN
	INSERT INTO MetaType_Common (TypeName,Description,Code,OrgID,IsActive,SystemLevel) VALUES('TestCategory','Investigation Category','INVESTIGATION_FEE',@OrgID,'Y','Y')
END
IF NOT EXISTS(SELECT 1 FROM MetaValue_Common MVC JOIN MetaType_Common MTC ON MVC.MetaTypeId=MTC.MetaTypeId WHERE MTC.Code='INVESTIGATION_FEE')
BEGIN
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'A','A',@OrgID,'A','Y' FROM MetaType_Common WHERE Code='INVESTIGATION_FEE'
	
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'B','B',@OrgID,'B','Y' FROM MetaType_Common WHERE Code='INVESTIGATION_FEE'
END

IF NOT EXISTS(SELECT 1 FROM MetaType_Common WHERE Code='INVESTIGATION_GROUP_FEE')
BEGIN
	INSERT INTO MetaType_Common (TypeName,Description,Code,OrgID,IsActive,SystemLevel) VALUES('GroupCategory','Group Category','INVESTIGATION_GROUP_FEE',@OrgID,'Y','Y')
END
IF NOT EXISTS(SELECT 1 FROM MetaValue_Common MVC JOIN MetaType_Common MTC ON MVC.MetaTypeId=MTC.MetaTypeId WHERE MTC.Code='INVESTIGATION_GROUP_FEE')
BEGIN
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'A','A',@OrgID,'A','Y' FROM MetaType_Common WHERE Code='INVESTIGATION_GROUP_FEE'
	
	INSERT INTO MetaValue_Common (MetaTypeId,Value,Code,OrgID,Description,IsActive)
	SELECT MetaTypeId,'B','B',@OrgID,'B','Y' FROM MetaType_Common WHERE Code='INVESTIGATION_GROUP_FEE'
END
GO
---------------------------------------------Test Master Result Value, Category & Sub Category Meta Type Details------------------------------------------------------

-- Reason Master Insert script

IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=1 AND DisplayText LIKE 'Invoice Cancelled' AND TypeCode LIKE 'INVCA')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(1,'Invoice Cancelled','INVCA')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=2 and DisplayText='Rejected' AND TypeCode='REJ')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(2,'Rejected','REJ')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=2 AND DisplayText='Not Given' AND TypeCode='NOG')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(2,'Not Given','NOG')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=3 AND Reason='Test Request on Hold' AND ReasonCode='TRH')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(3,'Discount','DIS')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=4 AND DisplayText='References' AND TypeCode='INREF')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(4,'References','INREF')
GO

IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=1 AND Reason='Due to total correction' AND ReasonCode='DTC')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(1,'Due to total correction','DTC','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Hemolysis' AND ReasonCode='HEM')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Hemolysis','HEM','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Lipemia' AND ReasonCode='LIP')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Lipemia','LIP','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Insufficient Volume' AND ReasonCode='INSVO')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Insufficient Volume','INSVO','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Inappropriate Container' AND ReasonCode='INACO')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Inappropriate Container','INACO','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Inappropriate Sampling' AND ReasonCode='INASA')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Inappropriate Sampling','INASA','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Inappropriate Label' AND ReasonCode='INALA')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Inappropriate Label','INALA','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Suspected Contamination' AND ReasonCode='SUSCO')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Suspected Contamination','SUSCO','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=2 AND Reason='Inappropriate Patient Preparation' AND ReasonCode='INAPP')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(2,'Inappropriate Patient Preparation','INAPP','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=3 AND Reason='Different Time Schedule' AND ReasonCode='DTS')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(3,'Different Time Schedule','DTS','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=3 AND Reason='Patient Delay' AND ReasonCode='PAD')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(3,'Patient Delay','PAD','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=3 AND Reason='Test Request on Hold' AND ReasonCode='TRH')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)VALUES(3,'Test Request on Hold','TRH','A')
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=4 AND DisplayText='References' AND TypeCode='INREF') AND Reason='Instrument Downtime' AND ReasonCode='DWNTM')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)
	SELECT TypeID,'Instrument Downtime','DWNTM','A' FROM ReasonType WHERE CategoryID=4 AND DisplayText='References' AND TypeCode='INREF'
GO
IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=4 AND DisplayText='References' AND TypeCode='INREF') AND Reason='Kit Short Supply' AND ReasonCode='KITSS')
	BEGIN
		INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status)
		SELECT TypeID,'Kit Short Supply','KITSS','A' FROM ReasonType WHERE CategoryID=4 AND DisplayText='References' AND TypeCode='INREF'
	END
GO
--- for Reason Master menu in Administrator role ---

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=67

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Admin/ReasonMaster.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'Reason Master','/Admin/ReasonMaster.aspx'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/ReasonMaster.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'Reason Master',2,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Admin/ReasonMaster.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END

--- for Reason Master menu in Administrator role ---

GO


 UPDATE Complaint SET IsUserDefined ='N'  WHERE IsUserDefined IS NULL
 
 UPDATE ICDCodes SET IsUserDefined ='N' WHERE IsUserDefined IS NULL
 
 
  GO 

--- for Service Quotation page menu in customer role ---
BEGIN

	DECLARE @PageID BIGINT
	DECLARE @MenuID INT
	DECLARE @RoleID BIGINT
	DECLARE @OrgID INT
	SET @OrgID=67

	SELECT @MenuID=MAX(MenuID) FROM MenuMaster
	SELECT @PageID=MAX(PageID) FROM Pages
	SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='CustomerCare'

	IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Billing/ServiceQuotation.aspx')
	BEGIN
		INSERT INTO Pages(PageID,PageName,PageURL) 
		SELECT @PageID+1,'Service Quotation','/Billing/ServiceQuotation.aspx'
	END

	IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Billing/ServiceQuotation.aspx' AND MM.OrgId=@OrgID)
	BEGIN
		INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
		SELECT @MenuID+1,'Service Quotation',0,@OrgID,@PageID+1
	END

	IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Billing/ServiceQuotation.aspx' AND MM.OrgId=@OrgID)
	BEGIN
		INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
		SELECT @MenuID+1,@RoleID,'Y'
	END

END
--- for Service Quotation page menu in customer role ---

GO

/* To show Bill Search Menu to Customer Care   */
BEGIN
	DECLARE @OrgID INT,@MenuID INT,@PageID BIGINT,@RoleID BIGINT
	SET @OrgID = 67
	SELECT @PageID=PageID FROM Pages WHERE PageURL LIKE '/Billing/HospitalBillSearch.aspx'
	SELECT @RoleID=RoleID FROM Role WHERE RoleName LIKE 'CustomerCare' AND OrgID=@OrgID
	SELECT @MenuID=A.MenuID FROM(SELECT TOP 1 MenuID FROM MenuMaster WHERE OrgId=@OrgID AND PageID=@PageID)A
	IF NOT EXISTS(SELECT 1 FROM RoleMenu WHERE MenuID=@MenuID AND RoleID=@RoleID)
	INSERT INTO RoleMenu (MENUID,RoleID,IsMapped)VALUES(@MenuID,@RoleID,'Y')
END

/* To Assign Actions to Bill Search page */

BEGIN
	INSERT INTO ActionRoleMapping (ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)VALUES(34,2341,294,9,'Y')
END

 IF EXISTS(SELECT TaskActionID from TaskActions WHERE ActionName='EpisodeApprovel') 
 UPDATE TaskActions SET ActionName='ProtocolApprovel',DisplayTextTemplate='Approve Protocol Details for (EpisodeName: {EpisodeName})(ProtocolNo:{EpisodeNo})',Category='Protocol Approvel' where ActionName='EpisodeApprovel' 
GO 


IF NOT EXISTS(SELECT 1 FROM MetaData WHERE Domain='DespatchType' AND Code='Home' AND DisplayText='HomeDelivery')
Begin

insert into MetaData(Domain,Code,DisplayText,LangCode)values('DespatchType','Home','HomeDelivery','en-GB')

END
IF NOT EXISTS(SELECT 1 FROM MetaData WHERE Domain='DespatchType' AND Code='Doctor' AND DisplayText='Doctor/Clinic Delivery')
Begin

insert into MetaData(Domain,Code,DisplayText,LangCode)values('DespatchType','Doctor','Doctor/Clinic Delivery','en-GB')

END


-- Config Script for Metropolis 
DECLARE @ConfigKeyID BIGINT
--Set the orgid to @MinValue
DECLARE @MinValue BIGINT = 67
DECLARE @MaxValue BIGINT = 69
WHILE @MinValue <= @MaxValue
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue)
		BEGIN
			IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='HideIPManageRate')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'HideIPManageRate','Do you want Hide IP Mange Rates','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='HideIPManageRate'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='HideIPManageRate' AND COM.OrgID=@MinValue)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',@MinValue,GETDATE())
				END
		END
	SET @MinValue = @MinValue+1
END
--*******************************---------


GO
IF NOT EXISTS(SELECT 1 FROM [TaskEntityMap] WHERE [MappingType]='InvestigationStatus' AND [TaskActionID]=63 AND [OrgID]=29)
	BEGIN
			insert into TaskEntityMap select 'InvestigationStatus',1,63,29
			insert into TaskEntityMap select 'InvestigationStatus',13,63,29
			insert into TaskEntityMap select 'InvestigationStatus',6,63,29
	END
GO

if not exists(select * from TaskStatus where [StatusName] ='APPROVED')  
INSERT [dbo].[TaskStatus] ([StatusName]) VALUES ('APPROVED')
go
--------------------------------------------- Begin Second Opinion ----------------------------------------------------
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE TaskActionID=67)
BEGIN
	DECLARE @OrgID INT = 67
	INSERT INTO TaskActions (TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,Category,IsShareable,OrgID)
	VALUES(67,'SecondOpinion','~\Investigation\InvestigationApprovel.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}','Opinion on Investigation Result for {PatientName}({PatientNumber})(VisitID:{ExternalVisitID})','Second Opinion','N',@OrgID)
END
GO
IF EXISTS(SELECT 1 FROM TaskActions WHERE TaskActionID=67)
BEGIN
	DECLARE @OrgID INT = 67
	DECLARE @RoleID BIGINT
	SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Doctor'
	IF EXISTS(SELECT 1 FROM Role WHERE OrgID=@OrgID AND RoleName='Doctor')
	BEGIN
		IF NOT EXISTS(SELECT 1 FROM TaskActionOrgMapping WHERE OrgID=@OrgID AND TaskActionID = (SELECT TaskActionID FROM TaskActions WHERE TaskActionID=67))
		BEGIN
			INSERT INTO TaskActionOrgMapping (OrgID,RoleID,TaskActionID) VALUES(@OrgID,@RoleID,67)
		END
	END
END
GO
IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Second Opinion')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'Second Opinion' From InvestigationStatus
END
GO
IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Second Opinion')
BEGIN
	IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Validate')
	BEGIN
		DECLARE @OrgID INT
		SET @OrgID = 67
		
		IF NOT EXISTS(SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Validate')
						AND MappingID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion') AND OrgID=@OrgID)
		BEGIN
			DECLARE @InvStatusID INT
			SELECT @InvStatusID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Validate'
			
			DECLARE @MappingID INT
			SELECT @MappingID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion'			
			
			DECLARE @SeqNo INT
			SELECT @SeqNo = ISNULL(Max(SeqNo),0)+1 From InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Validate') AND OrgID=@OrgID
			
			INSERT INTO InvStatusmapping (InvestigationStatusID,MappingID,OrgID,SeqNo) VALUES(@InvStatusID,@MappingID,@OrgID,@SeqNo)
		END
	END
END
GO
IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Opinion Given')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'Opinion Given' From InvestigationStatus
END
GO
IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Opinion Given')
BEGIN
	IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Second Opinion')
	BEGIN
		DECLARE @OrgID INT
		SET @OrgID = 67
		
		IF NOT EXISTS(SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion')
						AND MappingID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Opinion Given') AND OrgID=@OrgID)
		BEGIN
			DECLARE @InvStatusID INT
			SELECT @InvStatusID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion'
			
			DECLARE @MappingID INT
			SELECT @MappingID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Opinion Given'			
			
			DECLARE @SeqNo INT
			SELECT @SeqNo = ISNULL(Max(SeqNo),0)+1 From InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion') AND OrgID=@OrgID
			
			INSERT INTO InvStatusmapping (InvestigationStatusID,MappingID,OrgID,SeqNo) VALUES(@InvStatusID,@MappingID,@OrgID,@SeqNo)
			INSERT INTO InvStatusmapping (InvestigationStatusID,MappingID,OrgID,SeqNo) VALUES(@InvStatusID,@InvStatusID,@OrgID,@SeqNo+1)
		END
	END
END
GO
DECLARE @TaskActionID BIGINT = 67
DECLARE @MappingType NVARCHAR(100) = 'InvestigationStatus'
IF NOT EXISTS(SELECT 1 FROM TaskEntityMap WHERE TaskActionID=@TaskActionID And MappingType=@MappingType And MappingID in (SELECT MappingID FROM InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion')))
BEGIN
	IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Second Opinion')
	BEGIN
		DECLARE @MappingID INT
		SELECT @MappingID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Second Opinion'
		IF NOT EXISTS(SELECT 1 FROM TaskEntityMap WHERE TaskActionID=@TaskActionID And MappingType=@MappingType AND MappingID=@MappingID)
		BEGIN
			INSERT INTO TaskEntityMap (MappingType,MappingID,TaskActionID) VALUES(@MappingType,@MappingID,@TaskActionID)
		END
	END
END
GO
DECLARE @OrgID INT
SET @OrgID = 67
IF NOT EXISTS(SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Opinion Given') AND OrgID=@OrgID)
BEGIN
	IF EXISTS(SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Validate') AND OrgID=@OrgID)
	BEGIN
		DECLARE @InvStatusID INT
		SELECT @InvStatusID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Opinion Given'
		INSERT INTO InvStatusmapping (InvestigationStatusID,MappingID,OrgID,SeqNo)
		SELECT @InvStatusID,MappingID,@OrgID,SeqNo FROM InvStatusmapping WHERE  InvestigationStatusID = (SELECT InvestigationStatusID FROM InvestigationStatus WHERE Status='Validate') AND OrgID=@OrgID
	END
END
GO
IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Opinion Given')
BEGIN
	DECLARE @TaskActionID BIGINT = 62
	DECLARE @MappingType NVARCHAR(100) = 'InvestigationStatus'
	DECLARE @MappingID INT

	SELECT @MappingID = InvestigationStatusID FROM InvestigationStatus WHERE Status='Opinion Given'

	IF NOT EXISTS(SELECT 1 FROM TaskEntityMap WHERE TaskActionID=@TaskActionID And MappingType=@MappingType AND MappingID=@MappingID)
	BEGIN
		INSERT INTO TaskEntityMap (MappingType,MappingID,TaskActionID) VALUES(@MappingType,@MappingID,@TaskActionID)
	END
END
GO
--------------------------------------------- End Second Opinion ----------------------------------------------------

SET IDENTITY_INSERT ReportGroupMaster ON
IF NOT EXISTS(SELECT 1 FROM ReportGroupMaster WHERE ReportGroupText='Operational Reports')
INSERT INTO ReportGroupMaster(ReportGroupID,ReportGroupText,OrgID,CreatedBy,CreatedAt,ModifiedBy,ModifiedAt)
SELECT 1,'Operational Reports',null,1,GETDATE(),1,GETDATE()
SET IDENTITY_INSERT ReportGroupMaster OFF

--Bulkload for Reasonorgmapping 
DEClare @orgid int=67
truncate table InvReasonOrgMapping 
insert into InvReasonOrgMapping(StatusID,ReasonID,OrgID)
select 0,ReasonID,@orgid from ReasonMaster


--Update MetaMaster 
UPDATE MD SET MD.DisplayText ='Phase '+(SELECT [dbo].[fnConvertIntToRoman](MD.Code))
FROM MetaData MD WHERE Domain ='CTStudyPhase'

IF NOT EXISTS(SELECT 1 FROM BarcodeMainAttributes WHERE Code='LeftVertical')
BEGIN
	INSERT INTO BarcodeMainAttributes(Name,Code) VALUES('Left Vertical','LeftVertical')
END
GO

------GTT WorkOut Start------
IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='Not given')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'Not given' From InvestigationStatus
END

IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='PartialyCollected')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'PartialyCollected' From InvestigationStatus
END

GO
DECLARE @MappingType NVARCHAR(100) = 'InvestigationStatus'
Declare @EnterResultTaskActionID Int
Declare @tmpInvestigationStatusID Int

select @EnterResultTaskActionID=TaskActionID from TaskActions where ActionName='EnterResult'
select @tmpInvestigationStatusID=InvestigationStatusID from InvestigationStatus where Status='PartialyCollected'

IF NOT EXISTS(SELECT 1 FROM TaskEntityMap WHERE TaskActionID=@EnterResultTaskActionID And MappingType=@MappingType And MappingID=@tmpInvestigationStatusID)
BEGIN
	IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='PartialyCollected')
	BEGIN
		INSERT INTO TaskEntityMap (MappingType,MappingID,TaskActionID) VALUES(@MappingType,@tmpInvestigationStatusID,@EnterResultTaskActionID)
	END
END

GO

DECLARE @MappingType NVARCHAR(100) = 'InvestigationStatus'
Declare @CollectSampleTaskActionID Int
Declare @tmpInvestigationStatusID Int

select @CollectSampleTaskActionID=TaskActionID from TaskActions where ActionName='CollectSample'
select @tmpInvestigationStatusID=InvestigationStatusID from InvestigationStatus where Status='PartialyCollected'

IF NOT EXISTS(SELECT 1 FROM TaskEntityMap WHERE TaskActionID=@CollectSampleTaskActionID And MappingType=@MappingType And MappingID=@tmpInvestigationStatusID)
BEGIN
	IF EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='PartialyCollected')
	BEGIN
		INSERT INTO TaskEntityMap (MappingType,MappingID,TaskActionID) VALUES(@MappingType,@tmpInvestigationStatusID,@CollectSampleTaskActionID)
	END
END

IF NOT EXISTS(SELECT 1 FROM InvestigationPattern WHERE DisplayText='GTTContentPattern')
BEGIN
	Insert into InvestigationPattern(PatternID,PatternName,DisplayText)
	select MAX(PatternID)+1,'~/Investigation/GTTContentPattern.ascx','GTTContentPattern' from InvestigationPattern
END
------GTT WorkOut End-----------

------------------------- PAGES MENU insert for MRD View  - BEGIN -----------------------------------

IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageURL = '/Admin/MRDView.aspx')
BEGIN
	Insert Pages (PageID, PageName, PageURL) Select (Select MAX(PageID) + 1 From Pages), 'MRD View', '/Admin/MRDView.aspx'
END
GO
Declare @PageId Int, @ParentId Int, @OrgId Int
Select @OrgId = 1
Select @PageId = PageID from Pages Where PageURL = '/Admin/MRDView.aspx'
Select @ParentId = ParentID from MenuMasterHeader Where HeaderCode = 'MRD'
IF Not EXISTS (Select 1 From Menumaster Where DisplayText = 'MRD Patient Visit View' and OrgId = @OrgID)
BEGIN
	Insert Menumaster (MenuID, DisplayText, OrgId, Parentid, PageID) 
	Select (Select MAX(MenuID) + 1 From Menumaster), 'MRD Patient Visit View', 1, @ParentId, @PageId
END
------------------------- PAGES MENU insert for MRD View  - END -----------------------------------
Go
IF NOT EXISTS(SELECT 1 FROM MasterCategories WHERE CategoryCode='EMER')
BEGIN
	Declare @OrgID Bigint
	Set @OrgID = 1 /* Provide the proper OrgID here */
	INSERT INTO MasterCategories(CategoryName,OrgID,CategoryCode)
	SELECT 'Emergency Patient',@OrgID,'EMER' 
END
GO


------------------------- PAGES MENU insert for Emergency Patient  - BEGIN -----------------------------------
IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageURL = '/Patient/EmergencyPatient.aspx')
BEGIN
	Insert Pages (PageID, PageName, PageURL) Select (Select MAX(PageID) + 1 From Pages), 'Emergency Patient','/Patient/EmergencyPatient.aspx'
END
GO

	Declare @PageId Int, @ParentId Int, @OrgId Int
	Select @OrgId = 1
	Select @PageId = PageID from Pages Where PageURL = '/Patient/EmergencyPatient.aspx'
	Select @ParentId = ParentID from MenuMasterHeader Where HeaderCode = 'OP'
	
IF Not EXISTS (Select 1 From Menumaster Where DisplayText = 'Emergency Patient Registration' and OrgId = @OrgID)
BEGIN
	Insert Menumaster (MenuID, DisplayText, OrgId, Parentid, PageID) 
	Select (Select MAX(MenuID) + 1 From Menumaster), 'Emergency Patient Registration', 1, @ParentId, @PageId
END
------------------------- PAGES MENU insert for Emergency Patient  - END -----------------------------------
GO

IF NOT EXISTS(SELECT 1 FROM ClientAttributes WHERE AttributeName='Is All Are Medical Items')
Begin
insert ClientAttributes select 'Is All Are Medical Items','AMI',null,'Identity'
END

IF NOT EXISTS(SELECT 1 FROM MetaData WHERE Domain='ClaimAmountLogic')
Begin
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('ClaimAmountLogic','1','Billed Amount','en-GB')
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('ClaimAmountLogic','2','Pre-Auth Amount','en-GB')
END 

----------------------------------------------------- Updating new columns in VisitPurposeOrgMapping Table  ---------------------------------------------------------
IF EXISTS (Select * from Sys.columns where name = 'LanguageCode' and object_id = OBJECT_ID('VisitPurposeOrgMapping'))
BEGIN
    -- Print 'Inside...'
	Update VPOM 
	Set VPOM.LanguageCode = 'en-GB', VPOM.VisitpurposeName = VP.VisitpurposeName
	From VisitPurpose VP, VisitPurposeOrgMapping VPOM
	Where VP.VisitPurposeID = VPOM.VisitPurposeID
	And VPOM.LanguageCode IS NULL
END	
----------------------------------------------------- Updating new columns in VisitPurposeOrgMapping Table  --------------------------------------------------------- 

IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageURL = '/Corporate/Assistantphysician.aspx')
BEGIN
	Insert Pages (PageID, PageName, PageURL) Select (Select MAX(PageID) + 1 From Pages), 'Transcriptionist','/Corporate/Assistantphysician.aspx'
END
GO
IF NOT EXISTS(SELECT * FROM Role WHERE RoleName='Transcriptionist')
BEGIN
insert Into Role(RoleID, RoleName,Description,OrgID)
select 15,'Transcriptionist','Transcriptionist',1

END

IF NOT EXISTS (Select * from PageMapping where RoleId in (SELECT RoleID FROM Role WHERE RoleName='Transcriptionist'))
BEGIN
INSERT INTO PageMapping(RoleId,PageID,SeqNo)
SELECT 15,(select PageID from Pages where PageName='Transcriptionist'),1
END

GO
IF NOT EXISTS (select * from TaskActionOrgMapping where TaskActionID=11  and RoleID in (SELECT RoleID FROM Role WHERE RoleName='Transcriptionist') and OrgID=1)
BEGIN
INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)SELECT 11,(SELECT RoleID FROM Role WHERE RoleName='Transcriptionist'),1
END

GO
IF NOT EXISTS(select * from Menumaster where PageID in(select PageID from Pages where PageName='Transcriptionist') and OrgId=1)
BEGIN
INSERT INTO Menumaster(MenuID,DisplayText,Parentid,OrgId,PageID)
SELECT MAX(MenuID)+1,'Home',0,1,(select PageID from Pages where PageName='Transcriptionist') FROM Menumaster
END
GO

IF EXISTS (Select 1 From MenuMaster Where LanguageCode IS NULL)
BEGIN
	UPDATE MenuMaster Set LanguageCode = 'en-GB' Where LanguageCode IS NULL
END


IF NOT EXISTS(select * from DischargeSummarySeq where PlaceHolderID='trPlaceHolder23')
BEGIN
insert Into DischargeSummarySeq(PlaceHolderID,ControlName,HeaderName,OrgID,IsActive,SequenceNo)      
Select 'trPlaceHolder23','~/DischargeSummary/RoomSummary.ascx','Room Summary',1,'Y',0  
END
GO

IF EXISTS (SELECT 1 FROM Pages WHERE PageURL = '/InPatient/RoomBooking.aspx')
BEGIN
	UPDATE Pages SET PageURL='/InPatient/RoomAndBedBooking.aspx' WHERE PageURL = '/InPatient/RoomBooking.aspx' 

END
GO

IF EXISTS (SELECT 1 FROM ActionMaster WHERE QueryString = '../InPatient/RoomBooking.aspx?PID={PatientID}&VID={PatientVisitID}&PNAME={PatientName}&vType=IP&IsCB={CreditValue}')
BEGIN
	UPDATE ActionMaster SET QueryString='../InPatient/RoomAndBedBooking.aspx?PID={PatientID}&VID={PatientVisitID}&PNAME={PatientName}&vType=IP&IsCB={CreditValue}' 
	WHERE QueryString = '../InPatient/RoomBooking.aspx?PID={PatientID}&VID={PatientVisitID}&PNAME={PatientName}&vType=IP&IsCB={CreditValue}' 

END
GO

IF NOT EXISTS (SELECT 1 FROM TaskActions WHERE ActionName='InvestigationCollectPayment')
BEGIN
	INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category,RoleID,IsShareable)
	SELECT 68,'InvestigationCollectPayment','~\Billing\Billing.aspx?vid={PatientVisitID}&pid={PatientID}&ptid={PreviousTaskID}&ftype={FeeType}&bid={BillID}&gUID={UID}',
	'Investigation Collect payment from {PatientName}({PatientNumber})',0,'Payment',0,'N' 
END
GO	





----------------Task Actions for Blood Bank---------------

DECLARE @ActionID int
	IF NOT EXISTS(SELECT ActionCode FROM ActionMaster  WHERE  ActionCode='BloodBank_BloodRequest')
	BEGIN	
		SELECT @ActionID= MAX(ActionID)+1 from ActionMaster
		INSERT INTO ActionMaster(ActionID,ActionName,CreatedAt,QueryString,ActionCode)
                              VALUES(@ActionID,'Blood Request',GETDATE(),'../BloodBank/BloodRequestForm.aspx?PID={PatientID}&VID={PatientVisitID}','BloodBank_BloodRequest')																															
    END   


GO	

--Task ActionMapping For OP ---


DECLARE @RoleID Bigint
DECLARE @PageID Bigint
DECLARE @SearchTypeID int 
DECLARE @ActionID int
DECLARE @OrgID int
SET @SearchTypeID=19-- Today's OP Visit  
SET @OrgID=1
SELECT @ActionID=ActionID FROM ActionMaster WHERE ActionCode='BloodBank_BloodRequest'
SELECT @PageID=PageID FROM Pages WHERE PageURL LIKE '/BloodBank/BloodRequestForm.aspx'
SELECT @RoleID=RoleID FROM Role WHERE RoleName LIKE 'Receptionist' AND OrgID=@OrgID
IF NOT EXISTS(SELECT ActionID FROM ActionRoleMapping WHERE ActionID=@ActionID AND RoleID=@RoleID AND RedirectPageID=@PageID AND IsMapped='Y' AND SearchTypeID=@SearchTypeID)

BEGIN

	INSERT INTO ActionRoleMapping(ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)values(@ActionID,@RoleID,@PageID,@SearchTypeID,'Y')

END

GO




DECLARE @RoleID Bigint
DECLARE @PageID Bigint
DECLARE @SearchTypeID int 
DECLARE @ActionID int
DECLARE @OrgID int
SET @SearchTypeID=12-- Inpatient search 
SET @OrgID=1
SELECT @ActionID=ActionID FROM ActionMaster WHERE ActionCode='BloodBank_BloodRequest'
SELECT @PageID=PageID FROM Pages WHERE PageURL LIKE '/BloodBank/BloodRequestForm.aspx'
SELECT @RoleID=RoleID FROM Role WHERE RoleName LIKE 'Receptionist' AND OrgID=@OrgID
IF NOT EXISTS(SELECT ActionID FROM ActionRoleMapping WHERE ActionID=@ActionID AND RoleID=@RoleID AND RedirectPageID=@PageID AND IsMapped='Y' AND SearchTypeID=@SearchTypeID)

BEGIN

	INSERT INTO ActionRoleMapping(ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)values(@ActionID,@RoleID,@PageID,@SearchTypeID,'Y')

END

GO



   --- Add new role 
    DECLARE @NewRoleID BIGINT    
	DECLARE @orgid bigint
	set @orgid=1
    SELECT @NewRoleID=MAX(roleid) + 1 FROM Role    
    IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='BloodBank Technician')
   BEGIN
    INSERT INTO Role (RoleID,RoleName,Description,OrgID)VALUES(@NewRoleID,'BloodBank Technician','BloodBank Technician',@orgid)
   END
	DECLARE @pageID bigint
	select @pageID= PageID from Pages where PageURL ='/BloodBank/Home.aspx'
	DECLARE @RoleID bigint
	select @RoleID = RoleID from Role where RoleName='BloodBank Technician'
	 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
   BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
   END	
   
   
   -------------------------------
 GO  
 
 
 
IF NOT EXISTS (select * from TaskActionOrgMapping where TaskActionID=70  and RoleID in (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician') and OrgID=1)
BEGIN
INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)SELECT 70,(SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician'),1
END
GO
  
  
  IF NOT EXISTS (select * from TaskActionOrgMapping where TaskActionID=71  and RoleID in (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician') and OrgID=1)
BEGIN
INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)SELECT 71,(SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician'),1
END
GO 

--Billing Task for OP 

IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName='BillingforBlood')
BEGIN
	
	DECLARE @RoleID BIGINT 
	set @RoleID= (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician')
    INSERT INTO TaskActions(TaskActionID ,ActionName ,RedirectURL ,DisplayTextTemplate ,OrgID , Category ,RoleID ,IsShareable)
    VALUES (70,'BillingforBlood','~\Inventory\InvOpBilling.aspx?pid={PatientID}&vid={PatientVisitID}&PhyID={CreatedBy}',
   'Billing for {PatientName}({PatientNumber})',1,'BillingforBlood',@RoleID,'N')
END 


--- END 
GO
--- Billing Task for IP 
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName='IPBillingforBlood')
BEGIN

 DECLARE @RoleID BIGINT 
	set @RoleID= (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician')

    INSERT INTO TaskActions(TaskActionID ,ActionName ,RedirectURL ,DisplayTextTemplate ,OrgID , Category ,RoleID ,IsShareable)
    VALUES (71,'IPBillingforBlood','~\Inventory\InvIPBilling.aspx?PID={PatientID}&VID={PatientVisitID}&Vtype=IP&pod=N',
   'Billing for {PatientName}({PatientNumber})',1,'IPBillingforBlood',@RoleID,'N')
   
   END 
   --------------- END----------------
   
IF NOT EXISTS(SELECT Code FROM BarcodePlaceHolders WHERE Code='VisitCount')
BEGIN
INSERT INTO BarcodePlaceHolders(Name,Code)
SELECT 'VisitCount','VisitCount' 
END

IF EXISTS(SELECT Value FROM BarcodeAttributeMapping WHERE Value=13)
BEGIN
UPDATE BarcodeAttributeMapping SET Value=10 WHERE Value=13 AND Id=1
END

---------- Insert into   MetaDataOrgMapping Table begin -------------------------- 
IF EXISTS(SELECT 1 FROM MetaDataOrgMapping)
BEGIN
	--Truncate Table MetaDataOrgMapping
	Insert MetaDataOrgMapping
	Select MetaDataID, 1, 'en-GB', DisplayText from MetaData 
END 
---------- Insert into   MetaDataOrgMapping Table end -------------------------- 

------------------------Nutrition Department Link starts--------------------------------------------------------

CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization where OrganizationID=1
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
DECLARE @invpageid bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
set @invpageid=(SELECT MAX(pagemapid)+1 from InventoryPageMap)

INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'Nutrition Department','/Admin/sendToNutrition.aspx') 
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
SELECT @MenuID,'Nutrition Department',0,@MinValue,@PageID 
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName='Physician'

END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 
GO
-------------------------Nutrition Department Link Ends-------------------------------------------------------

-------------------------Ward Nutrition Details Link Starts---------------------------------------------------------------------------------------
CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization where OrganizationID=1
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
DECLARE @invpageid bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
set @invpageid=(SELECT MAX(pagemapid)+1 from InventoryPageMap)

INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'Ward Nutrition Details','/Admin/ReceivedInWard.aspx')
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
SELECT @MenuID,'Ward Nutrition Details',0,@MinValue,@PageID 
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName='Physician'

END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 

GO
--------------------------------Ward Nutrition Details Link Ends----------------------------------------------------------------------------------

--------------------------------Central Nutrition Department Link Starts---------------------------------------------------------------------------------------

CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization where OrganizationID=1
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
DECLARE @invpageid bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
set @invpageid=(SELECT MAX(pagemapid)+1 from InventoryPageMap)

INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'Central Nutrition Department','/Admin/CND.aspx')
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
SELECT @MenuID,'Central Nutrition Department',0,@MinValue,@PageID 
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName='Physician'

END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 


------------------------------------------Central Nutrition Department Link Ends-----------------------------------------------------------------------------------------------------------

-------------------Menu and RoleMenu Mapping ---------------------------
GO
BEGIN

	DECLARE @PageID BIGINT
	DECLARE @MenuID INT
	DECLARE @RoleID BIGINT
	DECLARE @OrgID INT
	SET @OrgID=1

	SELECT @MenuID=MAX(MenuID) FROM MenuMaster
	SELECT @PageID=MAX(PageID) FROM Pages
	SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='BloodBank Technician'

	IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/BloodBank/WorkListForBloodComponents.aspx')
	BEGIN
		INSERT INTO Pages(PageID,PageName,PageURL) 
		SELECT @PageID+1,'BloodComponents Details','/BloodBank/WorkListForBloodComponents.aspx'
	END

	IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/BloodBank/WorkListForBloodComponents.aspx' AND MM.OrgId=@OrgID)
	BEGIN
		INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
		SELECT @MenuID+1,'BloodComponents Details',0,@OrgID,@PageID+1
	END

	IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/BloodBank/WorkListForBloodComponents.aspx' AND MM.OrgId=@OrgID)
	BEGIN
		INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
		SELECT @MenuID+1,@RoleID,'Y'
	END

END

----------------------------END----------------------------------------------------------------
-------------------------------Start tag of Task Actions for Blood Collection and Issue Blood--------------------------
GO
    
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName='BloodDonation')
BEGIN
	
	DECLARE @RoleID BIGINT 
	set @RoleID= (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician')
    INSERT INTO TaskActions(TaskActionID ,ActionName ,RedirectURL ,DisplayTextTemplate ,OrgID , Category ,RoleID ,IsShareable)
    VALUES (46,'BloodDonation','~\BloodBank\BloodCollection.aspx?pid={PatientID}&vid={PatientVisitID}&sid={SpecialityID}',
   'Collect Blood from Donor {PatientName}({PatientNumber})',1,'BloodCollection',@RoleID,'N')
END 
GO

IF NOT EXISTS (select * from TaskActionOrgMapping where TaskActionID=46  and RoleID in (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician') and OrgID=1)
BEGIN
INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)SELECT 46,(SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician'),1
END
GO

IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName='BloodRequest')
BEGIN
	
	DECLARE @pRoleID BIGINT 
	set @pRoleID= (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician')
    INSERT INTO TaskActions(TaskActionID ,ActionName ,RedirectURL ,DisplayTextTemplate ,OrgID , Category ,RoleID ,IsShareable)
    VALUES (69,'BloodRequest','~\BloodBank\BloodIssue.aspx?pid={PatientID}&vid={PatientVisitID}&sid={SpecialityID}',
   'Issue Blood for {PatientName}({PatientNumber})',1,'Issue Blood',@pRoleID,'N')
END 
GO
                                                                    
--------------------------Bulk Insert for INVSAMPLEMASTER---------------------------------------------------------------------------------------------------------------------------                                                                  
                                                                     
                                             
DECLARE @OrgID VARCHAR(200)

DECLARE CUR1 CURSOR FOR
SELECT OrganizationID FROM dbo.organization 
ORDER BY OrganizationID

OPEN CUR1
FETCH NEXT FROM CUR1 INTO @OrgID
WHILE @@FETCH_STATUS = 0
BEGIN

DECLARE @SampleCode bigint
DECLARE @SampleDesc	VARCHAR(MAX)
DECLARE @Code	VARCHAR(20)
DECLARE @Active	VARCHAR(20)
--Declare currsor to get the Table and Index information
DECLARE CUR CURSOR FOR
SELECT DISTINCT
D.SampleCode,D.SampleDesc,D.Code,D.Active
FROM InvSampleMaster D
ORDER BY D.SampleCode

OPEN CUR
FETCH NEXT FROM CUR INTO 
@SampleCode,@SampleDesc,@Code,@Active


WHILE @@FETCH_STATUS = 0
BEGIN

if not exists(select * from invsamplemaster  where OrgID=@OrgID and SampleDesc=@SampleDesc)  

insert into invsamplemaster (OrgID,SampleCode,SampleDesc,Code,Active)values(@OrgID,@SampleCode,@SampleDesc,@Code,@Active)

FETCH NEXT FROM CUR INTO 
@SampleCode,@SampleDesc,@Code,@Active

END --CUR Cursor

CLOSE CUR;
DEALLOCATE CUR;

FETCH NEXT FROM CUR1 INTO @OrgID

END --CUR1 Cursor
CLOSE CUR1;
DEALLOCATE CUR1;
---------------------------------End of Bulk Insert for INVSAMPLEMASTER-------------------------------------------------------------------------------------------------------------
GO

IF NOT EXISTS (select * from TaskActionOrgMapping where TaskActionID=69  and RoleID in (SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician') and OrgID=1)
BEGIN
INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)SELECT 69,(SELECT RoleID FROM Role WHERE RoleName='BloodBank Technician'),1
END
GO


-------------------------------End tag of Task Actions for Blood Collection and Issue Blood--------------------------
/*Salutation Org Mapping Script */

Declare @LangCode Varchar(5)
Select @LangCode = 'en-GB'
Insert Salutationorgmapping 
select S.TitleID, S.TitleName, @LangCode, O.OrganizationID, 1, NULL, NULL, NULL from Salutation S cross join Organization O
where Convert(Varchar, O.OrganizationID) + @LangCode NOT IN (select Convert(Varchar, OrgID) + LanguageCode from Salutationorgmapping)

/* Inserts for FeeTypeOrgMapping Table related to Multi-language support begins */
IF EXISTS (SELECT 1 FROM syscolumns WHERE [name] = 'LanguageCode' AND id = OBJECT_ID('FeeTypeOrgMapping'))
Begin
	--Script to update the new columns in FeeTypeOrgMapping with Join from FeeTypeMaster
	Update FTOM Set FTOM.FeetypeDesc = FTM.FeeTypeDesc, FTOM.LanguageCode = 'en-GB' From FeeTypeOrgMapping FTOM, FeeTypeMaster FTM Where FTM.FeeTypeID = FTOM.FeeTypeID 

	--Script to Insert for another Language
	Declare @Lang varchar(5), @OrgID Bigint
	Set @Lang = 'id-ID'
	Set @OrgID = 1 /* Change accordingly */
	Insert FeeTypeOrgMapping Select FeeTypeID, @OrgID, VisitType, FeeTypeDesc, @Lang from FeeTypeOrgMapping
/* Change for FeeTypeOrgMapping Table related to Multi-language support ends */	
END
IF exists(select ClientID from ClientMaster where ClientName='GENERAL')
BEGIN
UPDATE ClientMaster SET ClientCode='GENERAL' WHERE ClientName='GENERAL'
END

GO

IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='PartiallyCompleted')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'PartiallyCompleted' From InvestigationStatus
END

GO
IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='PartiallyValidated')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'PartiallyValidated' From InvestigationStatus
END
GO
IF NOT EXISTS(SELECT 1 FROM InvestigationStatus WHERE Status='PartiallyApproved')
BEGIN
	INSERT INTO InvestigationStatus (InvestigationStatusID,Status) 
	SELECT ISNULL(Max(InvestigationStatusID),0)+1,'PartiallyApproved' From InvestigationStatus
END


/*
Processing Address in Manage location Meta data values..

*/
----------------------------------------------------------------------------------------------------
DEclare @orgid int=68
insert into MetaType_Common(TypeName,Description,Code,OrgID,IsActive,SystemLevel)
select 'Center Type','Center Type','CENT',@orgid,'Y','Y'
Declare @metatypeid bigint=0
select top 1 @metatypeid=MetaTypeId from MetaType_Common where Code='CENT' and TypeName='Center Type'
if @metatypeid >=1
BEGIN
insert into MetaValue_Common(MetaTypeId,Value,Code,Description,IsActive,OrgID)
select  @metatypeid,'PROCESSING CENTER','PCS','PROCESSING CENTER','Y',@orgid
insert into MetaValue_Common(MetaTypeId,Value,Code,Description,IsActive,OrgID)
select  @metatypeid,'COLLECTION CENTER','CCS','COLLECTION CENTER','Y',@orgid
END

GO
----------------------------------------------------------------------------------------------------


-----Laundry Role and Menus Added -------------------------



IF NOT EXISTS(SELECT 1 FROM ProductCategories WHERE CategoryName='Laundry Items')
BEGIN
	INSERT INTO ProductCategories (CategoryName ,OrgID ,OrgAddressID ,ParentCategorieID )
VALUES('Laundry Items',1,1,(SELECT MAX(CategoryID )+1 FROM ProductCategories))
	
END

GO

-------------------

IF NOT EXISTS(SELECT 1 FROM ProductType WHERE TypeName='Laundry Items')
BEGIN
INSERT INTO ProductType (TypeID ,TypeName ,OrgID )
VALUES((SELECT MAX(TypeID )+1 FROM ProductType ),'Laundry Items',1)
END 

GO

-----------END ------------------------
-------------------Insert for Role and Page Mapping----------------

 DECLARE @NewRoleID BIGINT    
	DECLARE @orgid bigint
	set @orgid=1
    SELECT @NewRoleID=MAX(roleid) + 1 FROM Role    
    IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='LaundryService')
   BEGIN
    INSERT INTO Role (RoleID,RoleName,Description,OrgID)VALUES(@NewRoleID,'LaundryService','LaundryService',@orgid)
    END
   
	DECLARE @pageID bigint
	select @pageID= PageID from Pages where PageURL ='/Inventory/Home.aspx'
	DECLARE @RoleID bigint
	select @RoleID = RoleID from Role where RoleName='LaundryService'
	 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
   BEGIN
   INSERT INTO PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
   END
   GO	
---------------------------------END -----------------------------

---Insert for Menumaster -------------

-------------Raise Laundry Items


Declare @PageId Int, @ParentId Int, @OrgId Int
Select @OrgId = 1
Select @PageId = PageID from Pages Where PageURL = '/inventory/RaiseIntend.aspx'
Select @ParentId = ParentID from MenuMasterHeader Where HeaderCode = 'INVENTORY'
IF Not EXISTS (Select 1 From Menumaster Where DisplayText = 'Raise Laundry Items' and OrgId = @OrgID)
BEGIN
	Insert Menumaster (MenuID, DisplayText, OrgId, Parentid, PageID) 
	Select (Select MAX(MenuID) + 1 From Menumaster), 'Raise Laundry Items', 1, @ParentId, @PageId
END

GO

-------------

----Issue Laundry Items---------------

Declare @PageId Int, @ParentId Int, @OrgId Int
Select @OrgId = 1
Select @PageId = PageID from Pages Where PageURL = '/Inventory/StockIssued.aspx'
Select @ParentId = ParentID from MenuMasterHeader Where HeaderCode = 'INVENTORY'
IF Not EXISTS (Select 1 From Menumaster Where DisplayText = 'Issue Laundry Items' and OrgId = @OrgID)
BEGIN
	Insert Menumaster (MenuID, DisplayText, OrgId, Parentid, PageID) 
	Select (Select MAX(MenuID) + 1 From Menumaster), 'Issue Laundry Items', 1, @ParentId, @PageId
END

GO

------------------ 
---------------------Received Laundry Items-------------------
Declare @PageId Int, @ParentId Int, @OrgId Int
Select @OrgId = 1
Select @PageId = PageID from Pages Where PageURL = '/Inventory/Intend.aspx'
Select @ParentId = ParentID from MenuMasterHeader Where HeaderCode = 'INVENTORY'
IF Not EXISTS (Select 1 From Menumaster Where DisplayText = 'Received Laundry Items' and OrgId = @OrgID)
BEGIN
	Insert Menumaster (MenuID, DisplayText, OrgId, Parentid, PageID) 
	Select (Select MAX(MenuID) + 1 From Menumaster), 'Received Laundry Items', 1, @ParentId, @PageId
END

GO
------------------------------------------------END -----------------------

---------------------------------------------------Insert For Locations-----------------------------------------------

DECLARE @OrgID BIGINT
SET @OrgID =1
IF Not EXISTS (Select 1 From Locations Where LocationName = 'Laundry' and OrgId = @OrgID)
BEGIN
	INSERT INTO Locations (LocationID ,LocationName ,LocationTypeID ,OrgID  ,IsActive ,ParentLocationID )
	VALUES((select MAX(LocationID ) + 1 from locations),'Laundry',4,1,'Y',(select MAX(LocationID ) + 1 from locations))
	
END

GO

-----------------------------------------
 ---------------------------------------INSERT FOR LOCATIONUSERMAP------------------------------------------------
 
 DECLARE @OrgID BIGINT
SET @OrgID =1
DECLARE @RoleID BIGINT 
SET @RoleID=(Select 1 from Role where RoleName ='LaundryService'  and OrgID =@OrgID)
DECLARE @LoginID BIGINT
SET @LoginID=(select TOP 1 LoginID  from LoginRole where RoleID =@RoleID)

DECLARE @LocationID INT
SET @LocationID =(Select TOP 1 LocationID  From Locations Where LocationName = 'Laundry' and OrgId = @OrgID)
DECLARE @OrgAddressID INT
SET @OrgAddressID=1
IF Not EXISTS (Select 1 From Locations Where LocationName = 'Laundry' and OrgId = @OrgID)
BEGIN
	INSERT INTO LocationUserMap (LoginID ,LocationID ,OrgAddressID ,OrgID,IsActive)
	values (@LoginID,@LocationID,@OrgAddressID,@OrgID,'Y')
	
	
END

--------------------------------------END -------------------------
GO
DECLARE @OrgID BIGINT
SET @OrgID =1
DECLARE @RoleID BIGINT 
SET @RoleID=(Select TOP 1 RoleID from Role where RoleName ='LaundryService'  and OrgID =@OrgID)
DECLARE @menuID INT
SET @menuID =(Select top 1 MenuID  from Menumaster where DisplayText = 'Raise Laundry Items'  and OrgID =1) 
BEGIN
insert into RoleMenu (RoleID ,IsMapped ,MenuID )values(@RoleID,'Y',@menuID)
END

GO
-------------------------


DECLARE @OrgID BIGINT
SET @OrgID =1
DECLARE @RoleID BIGINT 
SET @RoleID=(Select top 1 RoleID from Role where RoleName ='LaundryService'  and OrgID =@OrgID)
DECLARE @menuID INT
SET @menuID =(Select top 1 MenuID  from Menumaster where DisplayText = 'Issue Laundry Items'  and OrgID =1) 
BEGIN
insert into RoleMenu (RoleID ,IsMapped ,MenuID )values(@RoleID,'Y',@menuID)
END

GO

----END ---------------------

DECLARE @OrgID BIGINT
SET @OrgID =1
DECLARE @RoleID BIGINT 
SET @RoleID=(Select  RoleID from Role where RoleName ='LaundryService'  and OrgID =@OrgID)
SELECT @RoleID
DECLARE @menuID INT
SET @menuID =(Select top 1 MenuID  from Menumaster where DisplayText = 'Received Laundry Items'  and OrgID =1) 
BEGIN
IF Not Exists (Select 1 from RoleMenu where RoleID=@RoleID AND MenuID=@menuID)
begin
INSERT INTO RoleMenu (RoleID ,IsMapped ,MenuID )values(@RoleID,'Y',@menuID)
end
END

GO
-------End -------------------------------------



--------------start---------------------
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName='Amount Approval')
BEGIN
declare @TaskActionID bigint
SELECT @TaskActionID= MAX(TaskActionID)  FROM TaskActions

	INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category)
	SELECT @TaskActionID+1,'Amount Approval','~\Billing\AmountApprovalDetails.aspx?AAD={EpisodeID}',
	'{EpisodeNo} Approve Details for (PatientName: {EpisodeName})',0,'Amount Approvel' 
   
	DECLARE @OrgID INT = 1
	DECLARE @RoleID BIGINT
	SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator'
	IF EXISTS(SELECT 1 FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator')
	BEGIN
		IF NOT EXISTS(SELECT 1 FROM TaskActionOrgMapping WHERE OrgID=@OrgID AND TaskActionID = (SELECT TaskActionID FROM TaskActions WHERE TaskActionID=@TaskActionID+1))
		BEGIN
			INSERT INTO TaskActionOrgMapping (OrgID,RoleID,TaskActionID) VALUES(@OrgID,@RoleID,@TaskActionID+1)
		END
	END
END

-------------End-------------------------

-----------Start-------------------------


IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='AmountDepositDetails_TRF')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal ,ControlType ,ValueType ,ConfigType ) values
 (@GetconfigId,'AmountDepositDetails_TRF','Amount closureDeposit Details','Y','TEXT','String','HOS')
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'E:\\Application\\Billing\\AmountClosure\\',1)
end
--------End-----------------------------

-------InvestigationPattern orgid----------------------------
CREATE TABLE #TempOrgID
(
OrgID int
) 
INSERT INTO #TempOrgID
SELECT OrganizationID from Organization


DECLARE @MinValue int
DECLARE @MaxValue int
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID)
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID)

DECLARE @table table(PatternID bigint,PatternName varchar(200),DisplayText varchar(200))
insert into @table
select  PatternID,PatternName,DisplayText from InvestigationPattern where OrgID is null
truncate table InvestigationPattern

WHILE @MinValue <= @MaxValue
BEGIN

IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue)
BEGIN


	 
	  insert into InvestigationPattern(PatternID,PatternName,DisplayText,OrgID)
	  select PatternID,PatternName,DisplayText,@MinValue from @table-- where PatternID not in (select PatternID from InvestigationPattern where OrgID=@MinValue)
	 

END

SET @MinValue = @MinValue + 1
END
DROP TABLE #TempOrgID
------------------------------END Investigation Pattern------------------------------------------
--select * from InvestigationPattern where orgid=67

 ---BatchWiseWorkList Menu Script-----
 
Declare @pageID int
Declare @MenuID int
Declare @labtechRoleid Bigint=0

select @labtechRoleid=RoleID from Role where RoleName='Lab Technician' and OrgID=0
IF NOT EXISTS(SELECT 1 FROM Pages WHERE PageName='BatchWiseWorkList')
Begin
insert into Pages(PageID,PageName,PageURL,IsShareable)
select Max(PageID)+1,'BatchWiseWorkList','/Investigation/BatchWiseWorkList.aspx','N' from Pages
Select @pageID=Max(PageID) from Pages
End
Else
Begin
Select @pageID=PageID from Pages WHERE PageName='BatchWiseWorkList'
End
IF NOT EXISTS(SELECT 1 FROM MenuMaster WHERE DisplayText='BatchWise WorkList')
Begin
	insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	select MAX(MenuID)+1,'BatchWise WorkList',0,0,@pageID from MenuMaster
	Select @MenuID=MAX(MenuID) from MenuMaster
	if(@labtechRoleid!=0)
	Begin
	insert into RoleMenu(MenuID,RoleID,IsMapped) select @MenuID,@labtechRoleid,'Y'
	End
End
Else
Begin
  Select @MenuID=MenuID from MenuMaster WHERE DisplayText='BatchWise WorkList'
  if(@labtechRoleid!=0)
  Begin
  insert into RoleMenu(MenuID,RoleID,IsMapped) select @MenuID,@labtechRoleid,'Y'
  End
End

--End Of BatchWiseWorkList-------

---------Added data for URNTypes ---------- 

INSERT INTO URNTypes(URNType)VALUES('Internal')
----------------INSERT SCRIPT FOR REPORT TEMPLATES AND NEW PATTERNS-------------
Declare @POrgID int
set @POrgID=67
IF NOT EXISTS( select * from InvestigationPattern where DisplayText='ImagePattern' and OrgID=@POrgID)
BEGIN
insert into InvestigationPattern(PatternID,PatternName,DisplayText,OrgID)
select MAX(PatternID)+1,'~/Investigation/ImageUploadpattern.ascx','ImagePattern',@POrgID from  InvestigationPattern where OrgID=@POrgID
END
IF NOT EXISTS( select * from InvestigationPattern where DisplayText='FishPattern1' and OrgID=@POrgID)
BEGIN
insert into InvestigationPattern(PatternID,PatternName,DisplayText,OrgID)
select MAX(PatternID)+1,'~/Investigation/FishPattern1.ascx','FishPattern1',@POrgID from  InvestigationPattern where OrgID=@POrgID
END

IF NOT EXISTS( select * from InvestigationPattern where DisplayText='ResultFishPattern' and OrgID=@POrgID)
BEGIN
insert into InvestigationPattern(PatternID,PatternName,DisplayText,OrgID)
select MAX(PatternID)+1,'~/Investigation/FishResultPattern.ascx','ResultFishPattern',@POrgID from  InvestigationPattern where OrgID=@POrgID
END

insert into InvReportMaster(TemplateID,ReportTemplateName,IsDefault,OrgID,IsActive,Type,TemplateName,StationaryID)
select MAX(TemplateID)+1,'/Lims_Drop/GeneticsValueReport','N',@POrgID,'A',NULL,NULL,NULL from InvReportMaster where OrgID=@POrgID

insert into InvReportMaster(TemplateID,ReportTemplateName,IsDefault,OrgID,IsActive,Type,TemplateName,StationaryID)
select MAX(TemplateID)+1,'/Lims_Drop/GeneticsFishValuesReport','N',@POrgID,'A',NULL,NULL,NULL from InvReportMaster where OrgID=@POrgID
GO
------------------END PATTERNS SCRIPT---------------------------------

------------Added By Prasanna.S-------------------------
IF NOT EXISTS(SELECT 1 FROM [TaskEntityMap] WHERE [MappingType]='EnterResultStatus'  AND [MappingID]=4 AND [TaskActionID]=63)
	BEGIN
			insert into TaskEntityMap (MappingType,MappingID,TaskActionID) values('EnterResultStatus',4,63)           
	END
GO

IF NOT EXISTS(SELECT 1 FROM [TaskEntityMap] WHERE [MappingType]='EnterResultStatus'  AND [MappingID]=6 AND [TaskActionID]=63)
	BEGIN			
            insert into TaskEntityMap (MappingType,MappingID,TaskActionID) values('EnterResultStatus',6,63)          
	END
GO

IF NOT EXISTS(SELECT 1 FROM [TaskEntityMap] WHERE [MappingType]='EnterResultStatus'  AND [MappingID]=7 AND [TaskActionID]=63)
	BEGIN			
            insert into TaskEntityMap (MappingType,MappingID,TaskActionID) values('EnterResultStatus',7,63)
	END
GO

IF NOT EXISTS(SELECT 1 FROM MetaData WHERE Domain='WorkListSubType')
Begin
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('WorkListSubType','All','All','en-GB')
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('WorkListSubType','Retest','Retest','en-GB')
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('WorkListSubType','STAT','STAT','en-GB')
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('WorkListSubType','VIP','VIP','en-GB')
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('WorkListSubType','Recheck','Recheck','en-GB')
	insert into MetaData(Domain,Code,DisplayText,LangCode)values('WorkListSubType','Reflex','ReflexTest','en-GB')
END 
----------END-----------------------------------

IF NOT EXISTS(SELECT 1 FROM [TaskEntityMap] WHERE [MappingType]='InvestigationStatus'  AND [MappingID]=11 AND [TaskActionID]=63)
	BEGIN			
            insert into TaskEntityMap (MappingType,MappingID,TaskActionID) values('InvestigationStatus',11,63)
	END
GO

IF NOT EXISTS(SELECT 1 FROM [TaskEntityMap] WHERE [MappingType]='InvestigationStatus'  AND [MappingID]=11 AND [TaskActionID]=22)
	BEGIN			
            insert into TaskEntityMap (MappingType,MappingID,TaskActionID) values('InvestigationStatus',11,22)
	END
GO
---------- Random Password for Patient Registration--------------- Added By Sathish-----------------------------------------

if exists (select 1 from ActionTemplate where Template='<div style="font-family:Verdana;font-size:12;"><p>Dear Sir/Madam,</p>  <p>Your username has been successfully created. Your username is {PatientNumber} and Password is abc@123</p>  <div><br><br>Sincerely,<br><strong><br>{OrgName}</strong></div></div>')
BEGIN
Update ActionTemplate set 
Template='<div style="font-family:Verdana;font-size:12;"><p>Dear Sir/Madam,</p>  <p>Your username has been successfully created. Your username is {PatientNumber} and Password is {Password}</p>  <div><br><br>Sincerely,<br><strong><br>{OrgName}</strong></div></div>' 
where Template='<div style="font-family:Verdana;font-size:12;"><p>Dear Sir/Madam,</p>  <p>Your username has been successfully created. Your username is {PatientNumber} and Password is abc@123</p>  <div><br><br>Sincerely,<br><strong><br>{OrgName}</strong></div></div>' 
END
------------------------------------------------------------------END--------------------------------------------------------------
IF NOT EXISTS(SELECT 1 FROM BarcodePlaceHolders WHERE Code='TestStatus')
BEGIN
INSERT INTO BarcodePlaceHolders(Name,Code) VALUES('Test Status','TestStatus')
END
IF NOT EXISTS(SELECT 1 FROM BarcodePlaceHolders WHERE Code='BarcodeNumber')
BEGIN
INSERT INTO BarcodePlaceHolders(Name,Code) VALUES('Barcode Number','BarcodeNumber')
END
-----------------------------------------

  ----- New MIS DAILY TRANSACTION-------------

 DECLARE @RoleID BIGINT
 DECLARE @PageID BIGINT
 SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
 SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

 IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Daily Transaction Reports')
 BEGIN
 INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
 VALUES(@PageID,'Daily Transaction Reports','/ReportsLims/DailyTransactionLims.aspx','N')
 END
 
 DECLARE @ReportID BIGINT
 DECLARE @PagID BIGINT
 SELECT @PagID = MAX(PAGEID)+ 1 FROM Pages
 SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'Daily Transaction Reports',
 '/ReportsLims/DailyTransactionLims.aspx','../ReportsLims/DailyTransactionLims.aspx'
 ,5,1,'2013-09-03 14:47:06.660',@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Daily Transaction Reports'
 
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,69,'Y')


-----------------------------------Config for CodingScheme----------Sathish---------10/09/2013-------------------------------------------
IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='CodingScheme')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal ,ControlType ,ValueType ,ConfigType ) values
 (@GetconfigId,'CodingScheme','Do you want to Show the CodingSchemes ?','Y','','','') 
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',67)
end
----------------------------------------------------------------------------------End----------------------------------------------------------------------------

-----------------------------pagecontext insert Script Added by prabakar for quick approvel auto email service --------CREAETEAT - 10/09/2013

select @PagID=PageID from pages where PageURL='/Investigation/InvestigationQuickApprovel.aspx'
IF NOT EXISTS(SELECT 1 FROM PageContext WHERE PageID=@PagID and ButtonName='btnApprove')
BEGIN
INSERT INTO PageContext(PageID,ButtonName,ButtionValue) VALUES(546,'btnApprove','Approve')
END

-----------------------------End-------------------------------------

------pagecontext insert Script Added by prabakar for Resend Report option in Dispatch controller--------CREAETEAT - 10/09/2013

select @PagID=PageID from pages where PageURL='/Investigation/InvestigationReport.aspx'
IF NOT EXISTS(SELECT 1 FROM PageContext WHERE PageID=@PagID and ButtonName='btnGo')
BEGIN
INSERT INTO PageContext(PageID,ButtionValue,ButtonName) VALUES(@PagID,'Go','btnGo')
END
DECLARE @ActionID int
IF NOT EXISTS(SELECT 1 FROM ActionMaster WHERE ActionCode='Resend_Report')
BEGIN
SELECT @ActionID= MAX(ActionID)+1 from ActionMaster
INSERT INTO ActionMaster(ActionID,ActionName,ActionCode,IsShareable) VALUES(@ActionID,'Resend Report','Resend_Report','N')
END
IF NOT EXISTS(SELECT 1 FROM ActionMaster WHERE ActionCode='Show_PDF')
BEGIN
SELECT @ActionID= MAX(ActionID)+1 from ActionMaster
INSERT INTO ActionMaster(ActionID,ActionName,ActionCode,IsShareable) VALUES(@ActionID,'Show PDF','Show_PDF','N')
END


-----------------------------End-------------------------------------  

------------------------New Action For OutSourced Test---------Added By Sathish.E----------------------12/09/2013
GO
DECLARE @ActionID int
	IF NOT EXISTS(SELECT ActionCode FROM ActionMaster  WHERE  ActionCode='Send_Outsource_Details')
	BEGIN	
		SELECT @ActionID= MAX(ActionID)+1 from ActionMaster
		INSERT INTO ActionMaster(ActionID,ActionName,ActionCode,IsShareable)
                              VALUES(@ActionID,'Send Outsource Details','Send_Outsource_Details','N')																															
    END 
    GO  
   ------------------
   DECLARE @RoleID Bigint
DECLARE @PageID Bigint
DECLARE @SearchTypeID int 
DECLARE @ActionID int
DECLARE @OrgID int
SET @SearchTypeID=42 
SET @OrgID=67
SELECT @ActionID=  ActionID FROM ActionMaster WHERE ActionCode='Send_Outsource_Details'
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Lab/PendingSampleCollection.aspx'
SELECT @RoleID=  RoleID FROM Role WHERE RoleName LIKE 'Accession' AND OrgID=@OrgID
IF NOT EXISTS(SELECT ActionID FROM ActionRoleMapping WHERE ActionID=@ActionID AND RoleID=@RoleID AND RedirectPageID=@PageID AND IsMapped='Y' AND SearchTypeID=@SearchTypeID)

BEGIN

	INSERT INTO ActionRoleMapping(ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)values(@ActionID,@RoleID,@PageID,@SearchTypeID,'Y')

END

GO
    
   ------------------------------------End------------------------------------------------------------------------------------------------------ 
  
 DECLARE @RoleID BIGINT
 DECLARE @PageID BIGINT
 SELECT @RoleID=RoleID FROM ROLE WHERE Description like '%Adminis%'
 SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

 IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='RefPhysicianSearch')
 BEGIN
 INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
 VALUES(@PageID,'RefPhysicianSearch','/ReportsLims/RefPhysicianSearch.aspx','N')
 END
 
 DECLARE @ReportID BIGINT
 DECLARE @PagID BIGINT
 SELECT @PagID = MAX(PAGEID)+ 1 FROM Pages
 SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'RefPhysicianSearch',
 '/ReportsLims/RefPhysicianSearch.aspx','../ReportsLims/RefPhysicianSearch.aspx'
 ,5,1,'2013-09-03 14:47:06.660',@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='RefPhysicianSearch'
 
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
------------------------------------------------------------------------------------------------------

------Script added for application url holder------

DECLARE @ConfigkeyID int
SELECT @ConfigkeyID = MAX(ConfigkeyID) From ConfigKeyMaster 
IF NOT EXISTS(Select * from ConfigKeyMaster where ConfigKey='ApplicationURL') 
BEGIN
INSERT INTO ConfigKeyMaster(ConfigkeyID,ConfigKey,DisplayText,IsInternal)
VALUES(@ConfigkeyID,'ApplicationURL','Application path','Y')
END
----------------------------------------------------------------------

------Script added for External visit Id watermark in textbox------

DECLARE @ConfigkeyID int
SELECT @ConfigkeyID = MAX(ConfigkeyID) From ConfigKeyMaster 
IF NOT EXISTS(Select * from ConfigKeyMaster where ConfigKey='ExternalVisitIdWaterMark') 
BEGIN
INSERT INTO ConfigKeyMaster(ConfigkeyID,ConfigKey,DisplayText,IsInternal)
VALUES(@ConfigkeyID,'ExternalVisitIdWaterMark','Do you need to add water mark for test box?','Y')
END
----------------------------------------

----------- Task Description FOR TASK GRID-------------------------

DECLARE @EnterResult int
DECLARE @ReceiveSample int

SELECT @EnterResult = TAskactionid From TaskActions where ActionName='EnterResult'
SELECT @ReceiveSample = TAskactionid From TaskActions where ActionName='ReceiveSample'
IF NOT EXISTS(SELECT DisplayTextTemplate FROM TaskActions Where TaskActionID=@EnterResult)
BEGIN
Update TaskActions set DisplayTextTemplate='Enter Result For {PatientName}(PatientNo:{PatientNumber})(VisitNumber:{VisitNumber})'
Where TaskActionID=@EnterResult
END
IF NOT EXISTS(SELECT DisplayTextTemplate FROM TaskActions Where TaskActionID=@ReceiveSample)
BEGIN
update TaskActions set DisplayTextTemplate='Receive Sample for {PatientName}(PatientNo:{PatientNumber})(VisitNumber:{VisitNumber})'
, Category='ReceiveSample'
Where TaskActionID=@ReceiveSample
END

/****************************Added by prabakar for update templatename for ActionTemplate Table and the feature is Auto Email Service ***************19/09/2013*/
IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {Name},</p><p>Your investigation e-report is now being sent to you as a pdf document.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{LocationName}</strong></div></div>')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='ReptEmail_P' WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {Name},</p><p>Your investigation e-report is now being sent to you as a pdf document.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{LocationName}</strong></div></div>'
	END
	
	IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {Name},Your Test Result-')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='ValueSms_P' WHERE Template='Dear {Name},Your Test Result-'
	END
	

	IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {ClientName},</p><p>Your client {Name}''s lab report is ready and dispatched as requested. Kindly view attachment for details.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{LocationName}</strong></div></div>')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='ReptEmail_C' WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear {ClientName},</p><p>Your client {Name}''s lab report is ready and dispatched as requested. Kindly view attachment for details.</p><div><br><br>Sincerely,<br><strong><br>{OrgName}<br/>{LocationName}</strong></div></div>'
	END

IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {ClientName},Your Patient Name:{Name} Test Result-')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='ValueSms_C' WHERE Template='Dear {ClientName},Your Patient Name:{Name} Test Result-'
	END
	

IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear Sir/Madam,</p>  <p>Your username has been successfully created.   Please click on the following link to view your report http://115.112.134.132/LimsTest_1.13/ .  Your username is {PatientNumber} and Password is abc@123</p>  <div><br><br>Sincerely,<br><strong><br>{OrgName}</strong></div></div>')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='REmail_P' WHERE Template='<div style="font-family:Verdana;font-size:12;"><p>Dear Sir/Madam,</p>  <p>Your username has been successfully created.   Please click on the following link to view your report http://115.112.134.132/LimsTest_1.13/ .  Your username is {PatientNumber} and Password is abc@123</p>  <div><br><br>Sincerely,<br><strong><br>{OrgName}</strong></div></div>'
	END

IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {Name}, Your test request has been registered successfully at {MsgedDate}. Thank you')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='RSMS_P' WHERE Template='Dear {Name}, Your test request has been registered successfully at {MsgedDate}. Thank you'
	END
	IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {ClientName}, Your client {Name} has been registered for health investigations on {MsgedDate} with Metropolis Healthcare Pvt Ltd. Thank you Metropolis Healthcare Pvt Ltd')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='RSMS_C' WHERE Template='Dear {ClientName}, Your client {Name} has been registered for health investigations on {MsgedDate} with Metropolis Healthcare Pvt Ltd. Thank you Metropolis Healthcare Pvt Ltd'
	END
IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='Dear {Name}, Your Invoice report is ready. Pls have them collected at your convinience.')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='INV_SMS' WHERE Template='Dear {Name}, Your Invoice report is ready. Pls have them collected at your convinience.'
	END

IF EXISTS(SELECT 1 FROM ActionTemplate WHERE Template='DEAR CUSTOMER, YOUR INVOICE NO.IS {InvoiceNumber} AND BILL AMOUNT IS {Netvalue} IS DUE FOR PAYMENT')
	BEGIN
		UPDATE ActionTemplate SET TemplateName='INV_Email' WHERE Template='DEAR CUSTOMER, YOUR INVOICE NO.IS {InvoiceNumber} AND BILL AMOUNT IS {Netvalue} IS DUE FOR PAYMENT'
	END



/****************************************************End By prabakar***************************************************************************************/



/*******************************************************ADDED BY PRABAKAR FOR AUTO EMAIL SERVICE***************19/09/2013******/
IF EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ContextType in ('CP','P') AND  RoleID in (select RoleID from Role where RoleName in ('Lab Technician','Doctor','Junior Doctor')))
	BEGIN
		update  PageContextActionMapping set AdditionalContext='Report' where ContextType in ('CP','P') AND  RoleID in (select RoleID from Role where RoleName in ('Lab Technician','Doctor','Junior Doctor'))
	END

IF EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ContextType in ('CP','P') AND RoleID in (select RoleID from Role where RoleName in ('DEO B2B','LabReception')))
	BEGIN
		update  PageContextActionMapping set AdditionalContext='Notify' where ContextType in ('CP','P') AND RoleID in (select RoleID from Role where RoleName in ('DEO B2B','LabReception'))
	END
	
	IF EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ContextType in ('INV') AND RoleID in (select RoleID from Role where RoleName in ('Credit Controller')))
	BEGIN
		update  PageContextActionMapping set AdditionalContext='Invoice'  where ContextType in ('INV') AND RoleID in (select RoleID from Role where RoleName in ('Credit Controller'))

	END

IF exists(SELECT 1 from ClientAttributes where AttributeCode='BSMS')
BEGIN
UPDATE ClientAttributes set AttributeCode='REMAIL',AttributeName='Registration Email' where AttributeCode='BSMS'
END
/***********************************************************************END BY PRABAKAR********************************************************************/

declare @InvestigationStatusID int
select @InvestigationStatusID=InvestigationStatusID from InvestigationStatus where Status ='Retest' and ISNULL(Orgid,'67')=67 
IF exists(select 1 from InvestigationStatus where Status ='Retest' and ISNULL(Orgid,'67')=67 )
BEGIN
UPDATE InvestigationStatus set DisplayText='Recollect' where InvestigationStatusID=@InvestigationStatusID and ISNULL(Orgid,'67')=67
END

select @InvestigationStatusID=InvestigationStatusID from InvestigationStatus where Status ='Recheck' and ISNULL(Orgid,'67')=67  
IF exists(select 1 from InvestigationStatus where Status ='Recheck' and ISNULL(Orgid,'67')=67 )
BEGIN
UPDATE InvestigationStatus set DisplayText='Rerun' where InvestigationStatusID=@InvestigationStatusID and ISNULL(Orgid,'67')=67
END



/************************************Sankar.s**********************************************/

UPDATE InvOrgGroup SET ValidationText='
if(id.split(''~'')[2]==718)
{   
var InvID=id.split(''~'')[0];
IF(InvID==2005 || InvID==2006 || InvID==2007 || InvID==2008 || InvID==4055)
{
var neu = parseInt([2005]);  
var lym = parseInt([2006]);
var eos = parseInt([2007]);  
var bas = parseInt([2008]); 
var mon = parseInt([4055]);
var TotDc = neu + lym + eos + bas + mon ;
var HdnDCcheck = document.getElementById(''
hdnDCcheck'');      
if (neu != '''' && lym != '''' && eos != '''' && bas != '''' && mon != '''') 
 {if (TotDc < 100) {HdnDCcheck.value=confirm(''Differential Leukocyte Count value less than 100, is it OK ?'');  
   if(HdnDCcheck.value == "false"){document.getElementById(id).value='''';document.getElementById(id).focus();}}  
   
      if (TotDc > 100)     {HdnDCcheck.value=confirm(''Differential Leukocyte Count value greater than 100, is it OK ?'');   
       if(HdnDCcheck.value == "false"){document.getElementById(id).value='''';document.getElementById(id).focus();}}}}}'
       WHERE OrgGroupID=718 AND OrgID=67
   
   /*******************************END********************************************************/    
   
   
/**ADDED BY PRABAKAR FOR GIVE the option as Notify sms,Email and Report sms,Email in labQuick billing,Client billing and dispatch controller****25/09/2013******/
   
IF NOT EXISTS(SELECT * FROM ActionManagerType where [ActionType]='Email' AND ActionCode='REMAIL')  
  INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay],[ActionCode],[Type] ) VALUES (N'Email', N'Y','REMAIL','Notify')
GO
IF NOT EXISTS(SELECT * FROM ActionManagerType where [ActionType]='Sms' AND ActionCode='RSMS')  
  INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay],[ActionCode],[Type] ) VALUES (N'Sms', N'Y','RSMS','Notify')
GO
IF NOT EXISTS(SELECT * FROM ActionManagerType where [ActionType]='Email' AND ActionCode='IEMAIL')  
 INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay],[ActionCode],[Type] ) VALUES (N'Email', N'Y','IEMAIL','Client')
GO
IF NOT EXISTS(SELECT * FROM ActionManagerType where [ActionType]='Sms' AND ActionCode='ISMS')  
 INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay],[ActionCode],[Type] ) VALUES (N'Sms', N'Y','ISMS','Client')
GO
IF NOT EXISTS(SELECT * FROM ActionManagerType where [ActionType]='Courier' AND ActionCode='Courier')  
 INSERT [dbo].[ActionManagerType] ([ActionType], [IsDisplay],[ActionCode],[Type] ) VALUES (N'Courier', N'Y','Courier','Client')
GO

IF EXISTS(SELECT 1 from ActionManagerType where ActionType='Email' and ActionCode !='REPEMAIL')
BEGIN
UPDATE ActionManagerType SET ActionCode='REPEMAIL',Type='DisM' WHERE ActionType='Email' AND ActionCode NOT IN ('REMAIL','IEMAIL')
END

IF EXISTS(SELECT 1 from ActionManagerType where ActionType='Sms' and ActionCode !='REPSMS')
BEGIN
UPDATE ActionManagerType SET ActionCode='REPSMS',Type='DisM' WHERE ActionType='Sms' AND ActionCode NOT IN ('RSMS','ISMS')
END

IF EXISTS(SELECT 1 from ActionManagerType where ActionType='Rcourier')
BEGIN
UPDATE ActionManagerType SET Type='DisM' WHERE ActionType='Rcourier' 
END

--***********************************************END**************************


--***********************************************Santhosh**************************
IF EXISTS(SELECT 1 from InvGroupMapMaster)
BEGIN
update InvGroupMapMaster set Active='Y' where Active is null
END

/*******************************END********************************************************/    




------Script added for config based week default search------

DECLARE @ConfigkeyID int
SELECT @ConfigkeyID = MAX(ConfigkeyID) From ConfigKeyMaster 
IF NOT EXISTS(Select * from ConfigKeyMaster where ConfigKey='SetWeekAsDefaultSearch') 
BEGIN
INSERT INTO ConfigKeyMaster(ConfigkeyID,ConfigKey,DisplayText,IsInternal)
VALUES(@ConfigkeyID,'ReportDefaultSearchCriteria','Do You need to set week as default search','Y')
END
----------------------------------------

----------------------------------------------ActionManagetype-----------------------------------------------------------------------

/****** Object:  Table [dbo].[ActionManagerType]    Script Date: 09/26/2013 10:44:44 ******/
SET IDENTITY_INSERT [dbo].[ActionManagerType] ON
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (1, N'Email', N'Y', N'REPEMAIL', N'DisM')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (2, N'RedirectURL', N'N', NULL, NULL)
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (3, N'Sms', N'Y', N'REPSMS', N'DisM')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (4, N'Rcourier', N'Y', NULL, N'DisM')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (5, N'Hand Delivery', N'N', NULL, NULL)
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (6, N'Online', N'N', NULL, NULL)
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (7, N'Sms/Email', N'N', NULL, NULL)
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (8, N'Postal', N'N', NULL, NULL)
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (9, N'Pdf', N'N', NULL, NULL)
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (10, N'Email', N'Y', N'REMAIL', N'Notify')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (11, N'Sms', N'Y', N'RSMS', N'Notify')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (12, N'Email', N'Y', N'IEMAIL', N'Client')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (14, N'Sms', N'Y', N'ISMS', N'Client')
INSERT [dbo].[ActionManagerType] ([ActionTypeID], [ActionType], [IsDisplay], [ActionCode], [Type]) VALUES (15, N'Courier', N'Y', N'Courier', N'Client')
SET IDENTITY_INSERT [dbo].[ActionManagerType] OFF


--select * from ActionManagerType

--truncate table ActionManagerType

---------------------------------------------------------------------------------------------------------------------------------------------------------
IF NOT EXISTS (SELECT 1 FROM MetaData WHERE Domain='CoPaymentType' and code='Percentage')
BEGIN  
insert into MetaData (Domain,Code,DisplayText,LangCode)
 select	'CoPaymentType','Percentage','Percentage','en-GB'
END  

IF NOT EXISTS (SELECT 1 FROM MetaData WHERE Domain='CoPaymentType' and code='Percentage')
BEGIN  
insert into MetaData (Domain,Code,DisplayText,LangCode)
 select	'CoPaymentType','Value','Value','en-GB'
END   
 	 
IF NOT EXISTS (SELECT 1 FROM ClientAttributes WHERE AttributeName='Co-Payment' and AttributeCode='IsCoPay')
BEGIN  
Insert into ClientAttributes( AttributeName,AttributeCode	,OrgID	,AttributesType	)
Select 'Co-Payment','IsCoPay',Null,'Commercial'
END  

----------Add New Gender-----



 IF NOT EXISTS (select Domain,LangCode from MetaData where domain='Gender' AND Code='N' and LangCode='en-GB')
	 INSERT INTO [dbo].[MetaData]
	 VALUES('Gender','N','NA', 'en-GB') 
  GO
  DECLARE @Metadata INT
  DECLARE @OrgID INT
  SET @OrgID=67
  SELECT @Metadata=(SELECT metadataid from metadata where domain='Gender' and displaytext='NA')
  INSERT INTO [dbo].[MetaDataOrgMapping]
	 VALUES(@Metadata,@OrgID,'en-GB','NA') 
	 
----

CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'LocalityMaster','/Admin/LocalityMaster.aspx') 
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) 
SELECT @MenuID,'Locality Master',2,@MinValue,@PageID,'en-GB'
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName='Administrator' 
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID



/** Client Master Read Only Mode Insert Script **/
DECLARE @PageID BIGINT
SELECT @PageID=MAX(PageID) FROM Pages
IF NOT EXISTS(SELECT *FROM Pages WHERE PageURL='/Invoice/ClientMaster.aspx?View=y')
BEGIN
INSERT INTO Pages(PageID,PageName,pageURL)
VALUES(@PageID+1,'Client Master','/Invoice/ClientMaster.aspx?View=y')
PRINT 'Pages Inserted'
END
go 
--------------
DECLARE @OrgID INT=67
DECLARE @PageID BIGINT
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Invoice/ClientMaster.aspx?View=y' 
 
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster
IF NOT EXISTS(SELECT *FROM MenuMaster WHERE DisplayText='Client Master' AND PageID=@PageID)
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,ParentID,OrgID,PageID,LanguageCode)
VALUES(@MenuID+1,'Client Master','2',@OrgID,@PageID,'en-GB')
PRINT 'Menu Inserted'
END
go 
---------------

DECLARE @OrgID INT=67
DECLARE @PageID BIGINT
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Invoice/ClientMaster.aspx?View=y' 
 
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster WHERE  DisplayText='Client Master' AND PageID=@PageID
 
DECLARE @RoleID BIGINT
SELECT @RoleID=RoleID FROM Role where Description='Client CustomerCare' and OrgID=@OrgID
IF NOT EXISTS(SELECT * FROM RoleMenu WHERE MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,roleID,IsMapped)
VALUES(@MenuID,@RoleID,'Y')
PRINT 'Role Menu Inserted'
END
go  
-------------
/** Test Master Insert Script **/
DECLARE @PageID BIGINT
SELECT @PageID=MAX(PageID) FROM Pages
IF NOT EXISTS(SELECT *FROM Pages WHERE PageURL='/Admin/LabMaster.aspx?View=Y')
BEGIN
INSERT INTO Pages(PageID,PageName,pageURL)
VALUES(@PageID+1,'Test Master','/Admin/LabMaster.aspx?View=Y')
PRINT 'Pages Inserted'
END
go 
--------------

DECLARE @PageID BIGINT
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Admin/LabMaster.aspx?View=Y' 
 
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster
IF NOT EXISTS(SELECT *FROM MenuMaster WHERE DisplayText='Test Master' AND PageID=@PageID)
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,ParentID,OrgID,PageID,LanguageCode)
VALUES(@MenuID+1,'Test Master','2','67',@PageID,'en-GB')
PRINT 'Menu Inserted'
END
go 
---------------

DECLARE @PageID BIGINT
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Admin/LabMaster.aspx?View=Y' 
 
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster WHERE  DisplayText='Test Master' AND PageID=@PageID
 
DECLARE @RoleID BIGINT
SELECT @RoleID=RoleID FROM Role where Description='Jr.Scientific Officer Lab' and OrgID=67
IF NOT EXISTS(SELECT * FROM RoleMenu WHERE MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,roleID,IsMapped)
VALUES(@MenuID,@RoleID,'Y')
PRINT 'Role Menu Inserted'
END
 go 
 
-------------
---Separate identity for veterinary samples----

IF NOT EXISTS(SELECT *FROM MetaData WHERE Code='V' AND DisplayText='Veterinary')
BEGIN
INSERT INTO MetaData(Domain,Code,DisplayText,LangCode)
VALUES('Gender','V','Veterinary','en-GB')
PRINT 'New Code inserted'
END
go 
----------------

DECLARE @MetadataID INT
SELECT @MetadataID = MetadataID FROM MetaData WHERE Code='V' AND DisplayText='Veterinary' 
IF NOT EXISTS(SELECT *FROM MetaDataOrgMapping WHERE MetadataID=@MetadataID and DisplayText='Veterinary')
BEGIN
INSERT INTO MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
VALUES(@MetadataID,'67','en-GB','Veterinary')
PRINT 'New row inserted'
END


--Added by Bhupathy

CREATE TABLE #temp
(
OrgId int
)
insert into #temp
Select Distinct OrganizationID from ORganization

DECLARE @site_value INT;
SET @site_value = 67;
Declare @id int;
Set @id = (Select MAX(OrgId) from #temp)
 --'MobileNo','N','Y','hdnMobileNo','txtMobileNumber',@site_value
WHILE @site_value <= @id
  BEGIN
  if not exists ( Select 1 from RegistrationRepush where OrgId=@site_value and AttributeName='MobileNo' and IsDeflag='N' and IsRepush='Y' and FieldId='hdnMobileNo' and ControlId='txtMobileNumber')
  begin
	 insert into RegistrationRepush
     Select 'MobileNo','N','Y','hdnMobileNo','txtMobileNumber',@site_value
  end
   if not exists ( Select 1 from RegistrationRepush where OrgId=@site_value and AttributeName='PhoneNo' and IsDeflag='N' and IsRepush='Y' and FieldId='hdnPhoneNo' and ControlId='txtPhone')
  begin
	 insert into RegistrationRepush
     Select 'PhoneNo','N','Y','hdnPhoneNo','txtPhone',@site_value
  end
   if not exists ( Select 1 from RegistrationRepush where OrgId=@site_value and AttributeName='PatientAddress' and IsDeflag='N' and IsRepush='Y' and FieldId='hdnPatientAddress' and ControlId='txtAddress')
  begin
     insert into RegistrationRepush
     Select 'PatientAddress','N','Y','hdnPatientAddress','txtAddress',@site_value
  end
     SET @site_value = @site_value + 1;
  END;
PRINT 'Done WHILE LOOP';
Drop table #temp
GO

insert into PageContextActionMapping 
SELECT 1,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('LabReception')
insert into PageContextActionMapping 
SELECT 1,R.roleid,22,30,'CP','Report','','Y'  from Role R where RoleName in ('LabReception')
insert into PageContextActionMapping 
SELECT 1,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('LabReception') 
insert into PageContextActionMapping 
SELECT 1,R.roleid,23,31,'CP','Report','','Y'  from Role R where RoleName in ('LabReception')

insert into PageContextActionMapping 
SELECT 11,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('Doctor')
insert into PageContextActionMapping 
SELECT 11,R.roleid,22,30,'CP','Report','','Y'  from Role R where RoleName in ('Doctor')
insert into PageContextActionMapping 
SELECT 11,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('Doctor') 
insert into PageContextActionMapping 
SELECT 11,R.roleid,23,31,'CP','Report','','Y'  from Role R where RoleName in ('Doctor')

insert into PageContextActionMapping 
SELECT 22,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('Doctor')
insert into PageContextActionMapping 
SELECT 22,R.roleid,22,30,'CP','Report','','Y'  from Role R where RoleName in ('Doctor')
insert into PageContextActionMapping 
SELECT 22,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('Doctor') 
insert into PageContextActionMapping 
SELECT 22,R.roleid,23,31,'CP','Report','','Y'  from Role R where RoleName in ('Doctor')

insert into PageContextActionMapping 
SELECT 11,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('Junior Doctor')
insert into PageContextActionMapping 
SELECT 11,R.roleid,22,30,'CP','Report','','Y'  from Role R where RoleName in ('Junior Doctor')
insert into PageContextActionMapping 
SELECT 11,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('Junior Doctor') 
insert into PageContextActionMapping 
SELECT 11,R.roleid,23,31,'CP','Report','','Y'  from Role R where RoleName in ('Junior Doctor')

insert into PageContextActionMapping 
SELECT 22,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('Junior Doctor')
insert into PageContextActionMapping 
SELECT 22,R.roleid,22,30,'CP','Report','','Y'  from Role R where RoleName in ('Junior Doctor')
insert into PageContextActionMapping 
SELECT 22,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('Junior Doctor') 
insert into PageContextActionMapping 
SELECT 22,R.roleid,23,31,'CP','Report','','Y'  from Role R where RoleName in ('Junior Doctor')

insert into PageContextActionMapping 
SELECT 9,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('Doctor')
insert into PageContextActionMapping 
SELECT 9,R.roleid,22,30,'CP','Report','','Y' from Role R where RoleName in ('Doctor')
insert into PageContextActionMapping 
SELECT 9,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('Doctor') 
insert into PageContextActionMapping 
SELECT 9,R.roleid,23,31,'CP','Report','','Y' from Role R where RoleName in ('Doctor')

insert into PageContextActionMapping 
SELECT 9,R.roleid,22,29,'P','Report','','Y'  from Role R where RoleName in ('Junior Doctor')
insert into PageContextActionMapping 
SELECT 9,R.roleid,22,30,'CP','Report','','Y'  from Role R where RoleName in ('Junior Doctor')
insert into PageContextActionMapping 
SELECT 9,R.roleid,23,31,'P','Report','','Y'  from Role R where RoleName in ('Junior Doctor') 
insert into PageContextActionMapping 
SELECT 9,R.roleid,23,31,'CP','Report','','Y'  from Role R where RoleName in ('Junior Doctor')



insert into ActionManagerType values('ConfidPdf','Y','ConfidPdf','PDF')
insert into ActionManagerType values('ConfidRoundbPdf','Y','ConfidPdf','PDF')

insert into ActionTemplate values(1,'\REPORT\{OrgID}\ConfidPdf\{pdfDate}\','','P_ConfidReport_pdf','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf')
insert into ActionTemplate values(1,'\REPORT\{OrgID}\ConfidPdf\{pdfDate}\','','CP_ConfidReport_pdf','Report-{VisitNumber}_{Name}_{ClientCode}_{Date}_{Time}.pdf')
insert into ActionTemplate values(1,'\REPORT\{OrgID}\ConfidRoundbpdf\{pdfDate}\','','ConfidReport_ROUNDBPDF','Report-{VisitNumber}_{Name}_{ClientCode}_{Date}_{Time}.pdf')

Insert into CommunicationConfig values(0,'Email','IsConfidRoundbPdfActive','Y','Y','','','','',1)
Insert into CommunicationConfig values(0,'Email','IsConfidPdfActive','Y','Y','','','','',1)

 ---- Created by K.Bharathidhasan

CREATE TABLE #temp
(
OrgId int
)

insert into #temp

Select Distinct OrganizationID from ORganization

DECLARE @site_value INT;
SET @site_value = 67;
Declare @id int;

Set @id = (Select MAX(OrgId) from #temp)

 --'MobileNo','N','Y','hdnMobileNo','txtMobileNumber',@site_value

WHILE @site_value <= @id

BEGIN

--declare @pageid bigint
--select @pageid=  PageID from Pages where PageURL='/Lab/InvestigationOrgChange.aspx'


IF EXISTS(SELECT 1 FROM Role WHERE RoleName='Junior Doctor' and OrgID=@site_value)
 BEGIN
 IF NOT EXISTS (SELECT 1 FROM RoleMenu WHERE RoleID=(select RoleID from Role where RoleName='Junior Doctor' and OrgID=@site_value) AND MenuID=(select Top 1 MenuID from MenuMaster where DisplayText = 'InvStatusChange' and PageID=(select PageID from Pages where PageURL='/Lab/InvestigationOrgChange.aspx') ))
 BEGIN
 --select 'JD'
INSERT INTO RoleMenu(MenuID,RoleID,CreatedBy,CreatedAt,ModifiedBy,ModifiedAt,LevelCode,IsMapped)
 SELECT (select Top 1 MenuID from MenuMaster where DisplayText = 'InvStatusChange' and PageID=(select PageID from Pages where PageURL='/Lab/InvestigationOrgChange.aspx')  and OrgId=@site_value ),
 (SELECT RoleId FROM Role WHERE RoleName='Junior Doctor' and OrgID=@site_value), Null, Null, Null, Null, Null,'Y'
  END
 END
 
 
-- declare @pageid bigint
--select @pageid=  PageID from Pages where PageURL='/Lab/InvestigationOrgChange.aspx'


IF EXISTS(SELECT 1 FROM Role WHERE RoleName='Doctor' and OrgID=@site_value)
 BEGIN
 IF NOT EXISTS (SELECT 1 FROM RoleMenu WHERE RoleID=(select RoleID from Role where RoleName='Doctor' and OrgID=@site_value) AND MenuID=(select Top 1 MenuID from MenuMaster where DisplayText = 'InvStatusChange' and PageID=(select PageID from Pages where PageURL='/Lab/InvestigationOrgChange.aspx')))
 BEGIN
 --select 'SD'
 INSERT INTO RoleMenu(MenuID,RoleID,CreatedBy,CreatedAt,ModifiedBy,ModifiedAt,LevelCode,IsMapped)
 SELECT (select Top 1 MenuID from MenuMaster where DisplayText = 'InvStatusChange' and PageID=(select PageID from Pages where PageURL='/Lab/InvestigationOrgChange.aspx')  and OrgId=@site_value ),
 (SELECT RoleId FROM Role WHERE RoleName='Doctor' and OrgID=@site_value), Null, Null, Null, Null, Null,'Y'
  END
 END
 
 
     SET @site_value = @site_value + 1;
  END;
PRINT 'Done WHILE LOOP';
Drop table #temp
GO


	IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageName='Bill Audit Detail' AND PageURL='/Billing/BillDetailsSearch.aspx')
	BEGIN
		INSERT INTO Pages(PageID,PageName,PageURL)
		SELECT MAX(PageID)+1,'Bill Audit Detail','/Billing/BillDetailsSearch.aspx','N' FROM Pages
	END
	
	
DECLARE @PageID BIGINT
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Billing/BillDetailsSearch.aspx' 
 
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster
IF NOT EXISTS(SELECT * FROM MenuMaster WHERE DisplayText='Bill Audit Detail' AND PageID=@PageID)
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,ParentID,OrgID,PageID,LanguageCode)
VALUES(@MenuID+1,'Bill Audit Detail','0','67',@PageID,'en-GB')
PRINT 'Menu Inserted'
END
go 

DECLARE @PageID BIGINT
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Billing/BillDetailsSearch.aspx' 
 
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster WHERE  DisplayText='Bill Audit Detail' AND PageID=@PageID
 
DECLARE @RoleID BIGINT
SELECT @RoleID=RoleID FROM Role where Description='Credit Controller' and OrgID=67
IF NOT EXISTS(SELECT * FROM RoleMenu WHERE MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,roleID,IsMapped)
VALUES(@MenuID,@RoleID,'Y')

PRINT 'Role Menu Inserted'
END
 go 
 
 IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='IsSlabDiscount')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal ,ControlType ,ValueType ,ConfigType ) values
 (@GetconfigId,'IsSlabDiscount','IsSlabDiscount','Y',Null,Null,Null)
end

IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster WHERE OrgID=70  and ConfigKeyID IN (SELECT ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='IsSlabDiscount'))
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid) from ConfigKeyMaster  WHERE ConfigKey='IsSlabDiscount'
select @GetconfigId
  insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',70)
end
 

If not exists (select 1 from InvestigationStatus where Status='Yet to Transfer')
Begin
Insert into InvestigationStatus (InvestigationStatusID,Status,Reason,DisplayText)
Select MAX(InvestigationStatusID)+1,'Yet to Transfer','Yet to Transfer Reason','Yet to Transfer' from InvestigationStatus
End

IF NOT EXISTS(SELECT * FROM [TaskEntityMap] WHERE [MappingType]='InvestigationStatus' AND [MappingID]=35 AND [TaskActionID]=22)
	INSERT [dbo].[TaskEntityMap] ([MappingType], [MappingID], [TaskActionID]) VALUES (N'InvestigationStatus', 35, 22)
GO


IF Exists (Select 1 from MetaType_Common where Code='CENT' and TypeName='Center Type')
Declare @metatypeid bigint=0
select top 1 @metatypeid=MetaTypeId from MetaType_Common where Code='CENT' and TypeName='Center Type'
Begin
 if not exists (select 1 from MetaValue_Common where Value = 'EXTENDED PROCESSING CENTER' and Code ='EPC')
  Begin
   Declare @OrgId bigint =67
   insert into MetaValue_Common(MetaTypeId,Value,Code,Description,IsActive,OrgID)
   select  @metatypeid,'EXTENDED PROCESSING CENTER','EPC','EXTENDED PROCESSING CENTER','Y',@OrgId
  End
End



-------Recheck for Registeredvisit---createdby K.Bharathidhasan....--------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=67

SELECT @MenuID=ISNULL(MAX(MenuID),0) FROM MenuMaster
SELECT @PageID=ISNULL(MAX(PageID),0) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Accession'

IF NOT EXISTS(SELECT 1 FROM Pages WHERE PageURL='/Reception/RecheckRegisteredVisits.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'Recheck Registered Visit Details','/Reception/RecheckRegisteredVisits.aspx'
END

IF NOT EXISTS(SELECT 1 FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Reception/RecheckRegisteredVisits.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'Recheck Registered Visit Details',0,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT 1 FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Reception/RecheckRegisteredVisits.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END


---------------------------------------k.Bharathidhasan---------------------notification mapping--------



DECLARE @PagID BIGINT
 
select @PagID=  PageID from pages  (NOLOCK) where PageURL='/Reception/RecheckRegisteredVisits.aspx'
IF NOT EXISTS(SELECT 1 FROM PageContext (NOLOCK) WHERE PageID=@PagID and ButtonName='btnEdit')
BEGIN
INSERT INTO PageContext(PageID,ButtonName,ButtionValue) VALUES(@PagID,'btnEdit','Update and Verify')
END

Declare @PageContextId as int
set @PageContextId=(Select PageContextId from PageContext where PageId=574 and  ButtonName='btnEdit')
insert into PageContextActionMapping
Select @PageContextId,2355,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment from PageContextActionMapping
 where PageContextID=1 and RoleID=1856 and AdditionalContext!='Notify_NO'

------------------*****-----------------------



 IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=1 AND DisplayText LIKE 'Audit Reason' AND TypeCode LIKE 'AURES')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(1,'Audit Reason','AURES')
GO


IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES') AND Reason='Reason 1' AND ReasonCode='AR1')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'Reason 1','AR1','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES'
GO

IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES') AND Reason='Reason 2' AND ReasonCode='AR2')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'Reason 2','AR2','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES'
GO

IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES') AND Reason='Reason 3' AND ReasonCode='AR3')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'Reason 3','AR3','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES'
GO

IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES') AND Reason='Reason 4' AND ReasonCode='AR4')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'Reason 4','AR4','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='AURES'
GO



 INSERT INTO InvReasonOrgMapping
             (StatusID,
              ReasonID,
              OrgID)
 SELECT 0,
        ReasonID,
        67
 FROM   ReasonMaster RM
        INNER JOIN ReasonType RT
                ON RM.ReasonTypeID = RT.TypeID
 WHERE  RT.TypeCode = 'AURES' 
 
 IF NOT EXISTS(SELECT 1 FROM ActionManagerType WHERE ActionType='ClientBlindParentPdf')
Begin
insert into ActionManagerType
Select 'ClientBlindParentPdf','Y','ClientBlindParentPdf','PDF'
End

IF NOT EXISTS(SELECT 1 FROM ActionManagerType WHERE ActionType='ClientBlindParentRoundbPdf')
Begin
insert into ActionManagerType
Select 'ClientBlindParentRoundbPdf','Y','ClientBlindParentRoundbPdf','PDF' 
End

IF NOT EXISTS(SELECT 1 FROM ActionManagerType WHERE ActionType='ClientBlindChildPdf')
Begin
insert into ActionManagerType
Select 'ClientBlindChildPdf','Y','ClientBlindChildPdf','PDF'
End

IF NOT EXISTS(SELECT 1 FROM ActionManagerType WHERE ActionType='ClientBlindChildRoundbPdf')
Begin
insert into ActionManagerType
Select 'ClientBlindChildRoundbPdf','Y','ClientBlindChildRoundbPdf','PDF'
End

IF NOT EXISTS(SELECT 1 FROM CommunicationConfig WHERE Name='IsClientBlindParentPdfActive')
Begin
Insert into CommunicationConfig values(0,'Email','IsClientBlindParentPdfActive','Y','Y','','','','',2)
End

IF NOT EXISTS(SELECT 1 FROM CommunicationConfig WHERE Name='IsClientBlindParentRoundbPdfActive')
Begin
Insert into CommunicationConfig values(0,'Email','IsClientBlindParentRoundbPdfActive','Y','Y','','','','',2)
End

IF NOT EXISTS(SELECT 1 FROM CommunicationConfig WHERE Name='IsClientBlindChildPdfActive')
Begin
Insert into CommunicationConfig values(0,'Email','IsClientBlindChildPdfActive','Y','Y','','','','',2)
End

IF NOT EXISTS(SELECT 1 FROM CommunicationConfig WHERE Name='IsClientBlindChildRoundbPdfActive')
Begin
Insert into CommunicationConfig values(0,'Email','IsClientBlindChildRoundbPdfActive','Y','Y','','','','',2)
End



 IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=1 AND DisplayText LIKE 'Audit Reason' AND TypeCode LIKE 'CM')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(1,'Audit Reason','CM')
GO


IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='CM') AND Reason='ClientMaster Updation' AND ReasonCode='CM1')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'ClientMaster Updation','CM1','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='CM'
GO

 IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=1 AND DisplayText LIKE 'Audit Reason' AND TypeCode LIKE 'RM')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(1,'Audit Reason','RM')
GO


IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='RM') AND Reason='ClientMaster Updation' AND ReasonCode='RM1')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'RateMaster Updation','RM1','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='RM'
GO


 IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=1 AND DisplayText LIKE 'Audit Reason' AND TypeCode LIKE 'TM')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(1,'Audit Reason','TM')
GO


IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='TM') AND Reason='TestMaster Updation' AND ReasonCode='TM1')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'TestMaster Updation','TM1','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='TM'
GO


 IF NOT EXISTS(SELECT 1 FROM ReasonType WHERE CategoryID=1 AND DisplayText LIKE 'Audit Reason' AND TypeCode LIKE 'CMR')
	INSERT INTO ReasonType(CategoryID,DisplayText,TypeCode)VALUES(1,'Audit Reason','CMR')
GO


IF NOT EXISTS(SELECT 1 FROM ReasonMaster WHERE ReasonTypeID=(SELECT TypeID FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='CMR') AND Reason='ClientRatemaster Updation' AND ReasonCode='CMR1')
	INSERT INTO ReasonMaster(ReasonTypeID,Reason,ReasonCode,Status,OrgID)
	SELECT TypeID,'ClientRatemaster Updation','CMR1','A',67 FROM ReasonType WHERE CategoryID=1 AND DisplayText='Audit Reason' AND TypeCode='CMR'
GO






 INSERT INTO InvReasonOrgMapping
             (StatusID,
              ReasonID,
              OrgID)
 SELECT 0,
        ReasonID,
        67
 FROM   ReasonMaster RM
        INNER JOIN ReasonType RT
                ON RM.ReasonTypeID = RT.TypeID
 WHERE  RT.TypeCode = 'CM'

  INSERT INTO InvReasonOrgMapping
             (StatusID,
              ReasonID,
              OrgID)
 SELECT 0,
        ReasonID,
        67
 FROM   ReasonMaster RM
        INNER JOIN ReasonType RT
                ON RM.ReasonTypeID = RT.TypeID
 WHERE  RT.TypeCode = 'CMR'


 INSERT INTO InvReasonOrgMapping
             (StatusID,
              ReasonID,
              OrgID)
 SELECT 0,
        ReasonID,
        67
 FROM   ReasonMaster RM
        INNER JOIN ReasonType RT
                ON RM.ReasonTypeID = RT.TypeID
 WHERE  RT.TypeCode = 'TM'


 INSERT INTO InvReasonOrgMapping
             (StatusID,
              ReasonID,
              OrgID)
 SELECT 0,
        ReasonID,
        67
 FROM   ReasonMaster RM
        INNER JOIN ReasonType RT
                ON RM.ReasonTypeID = RT.TypeID
 WHERE  RT.TypeCode = 'RM'


 ----------Added by Thamilselvan.R for Generating the Health Coupon SSRS Report..
 if not exists (select 1 from INVREPORTMASTER where TemplateName = 'BillReceiptB2CHC')
 BEGIN
  INSERT INTO INVREPORTMASTER(TemplateID,ReportTemplateName,IsDefault,OrgID,IsActive,Type,TemplateName,StationaryID,
 IsSeperatePrint,TemplateSeq,ImageGroupID)
 VALUES((SELECT MAX(TEMPLATEID)+1 FROM INVREPORTMASTER),'/LIMS_LIVE_Latest/BillReportB2CHealthCoupon' ,'N',
			70,'A','BillReceipt','BillReceiptB2CHC',0,'N',NULL,NULL)
 END
 -----------------

------------------------------------Vignesh.E------------------------------------------------------------------
 insert into MasterCategories(
             CategoryName,
OrgID,
CategoryCode) values('HelathCardNo',68,'HCNO')




insert into IDPatternMaster(CategoryID,Pattern,
OrgID,
IsReset,
CreatedDate,
ResetNumber,
LastGeneratedNumber,
ResetOption)
Values(
394,'{ORGCENTRECODE}{YY}{LOC}{Number}',68,'N',getdaTE(),0,131401000151,NULL
)



  insert into patientcreditslabmapping(RangeFrom,
RangeTo,
PointsPercent,
PointsValue,
OrgId,
CreatedBy,
CreatedAt,
ModifiedBy,
ModifiedAt,
IsActive,
AmountValue) values(
 1.00,    100000.00,    10.00,    10.00,    68,    3366,getdate(),    NULL,    NULL,    NULL,    10.00)


------------------------------------------------End-------------------------------------------------------------------------

CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'TransferSampleCollection','/Lab/TransferSampleCollection.aspx?Flag=Y') 
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) 
SELECT @MenuID,'Userdriven SampleTransfer',0,@MinValue,@PageID,'en-GB'
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName='Accession' 
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 

-----------------------------------------------------


-----------------add by sudhakar for MLNO base--------------
 IF NOT EXISTS(SELECT 1 FROM MasterCategories WHERE  categoryname='MLNumber' and categorycode='MLNO')
	BEGIN
		INSERT INTO dbo.MasterCategories (dbo.MasterCategories.CategoryName, dbo.MasterCategories.OrgID, dbo.MasterCategories.CategoryCode)
		VALUES('MLNumber', 67,'MLNO')
	 END

IF NOT EXISTS(SELECT 1 FROM IDPATTERNMASTER WHERE CategoryID = (select CategoryId from MasterCategories where categoryname='MLNumber' and categorycode = 'MLNO'))
	BEGIN		
		INSERT INTO IDPATTERNMASTER (CategoryID,Pattern,OrgID,IsReset,CreatedDate,ResetNumber,LastGeneratedNumber,ResetOption,ResetBy,IsPatternAutoGenerated,OrgAddressID)
			VALUES((select CategoryId from MasterCategories where categoryname='MLNumber' and categorycode = 'MLNO'),'{ML}{HCODE}{Number}{/}{YY}',67,'N',GETDATE(),0,NULL,NULL,1,NULL,NULL)
	END
	

---------------------------------------------------
--------------Added by Vijayalakshmi.M for Device Error Flag-----------
if not exists (select 1 from DeviceErrorFlag where ErrorCode =1 and Symbol ='>' and ErrorDescription ='PANIC value over (upper) Technical Limit')
begin
insert into DeviceErrorFlag (InstrumentID ,DeviceCode ,ErrorCategory ,ErrorCode ,ErrorDescription,OrgID ,OrgAddressID ,Symbol )
values (48,53,'WARNING',1,'PANIC value over (upper) Technical Limit',70,158,'>')
end

if not exists (select 1 from DeviceErrorFlag where ErrorCode =2 and Symbol ='<' and ErrorDescription ='PANIC value over (lower) Technical Limit')
begin
insert into DeviceErrorFlag (InstrumentID ,DeviceCode ,ErrorCategory ,ErrorCode ,ErrorDescription,OrgID ,OrgAddressID ,Symbol )
values (48,53,'WARNING',2,'PANIC value over (lower) Technical Limit',70,158,'<')
end

if not exists (select 1 from DeviceErrorFlag where ErrorCode =3 and ErrorDescription ='Test Error Flag')
begin
insert into DeviceErrorFlag (InstrumentID ,DeviceCode ,ErrorCategory ,ErrorCode ,ErrorDescription,OrgID ,OrgAddressID ,Symbol )
values (48,53,'WARNING',3,'Test Error Flag',70,158,'')
end
---------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='BillsfortheDayTestWiseMonthlyReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'BillsfortheDayTestWiseMonthlyReport','/Reports/BillsfortheDayTestWiseMonthlyReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BillsfortheDayTestWiseMonthlyReport.aspx' 
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'BillsfortheDayTestWiseMonthlyReport',
'/Reports/BillsfortheDayTestWiseMonthlyReport.aspx','../Reports/BillsfortheDayTestWiseMonthlyReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='BillsfortheDayTestWiseMonthlyReport'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='BillsfortheDayClientWiseMonthlyReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'BillsfortheDayClientWiseMonthlyReport','/Reports/BillsfortheDayClientWiseMonthlyReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BillsfortheDayClientWiseMonthlyReport.aspx'

INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'BillsfortheDayClientWiseMonthlyReport',
'/Reports/BillsfortheDayClientWiseMonthlyReport.aspx','../Reports/BillsfortheDayClientWiseMonthlyReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='BillsfortheDayClientWiseMonthlyReport'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Cancel Bill Report')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Cancel Bill Report','/Reports/CancelledBillReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/CancelledBillReport.aspx' 
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'Cancel Bill Report',
'/Reports/CancelledBillReport.aspx','../Reports/CancelledBillReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Cancel Bill Report'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='TodaysBillreport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'TodaysBillreport','/Reports/BillsforthedayReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BillsforthedayReport.aspx'  
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'TodaysBillreport',
'/Reports/BillsforthedayReport.aspx','../Reports/BillsforthedayReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='TodaysBillreport'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='PendingsamplesReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'PendingsamplesReport','/Reports/PendingsamplesReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/PendingsamplesReport.aspx'   
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'PendingsamplesReport',
'/Reports/PendingsamplesReport.aspx','../Reports/PendingsamplesReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='PendingsamplesReport'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Weekly Mean TAT Summary')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Weekly Mean TAT Summary','/Reports/MeanTATSummaryReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/MeanTATSummaryReport.aspx'  
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'Weekly Mean TAT Summary',
'/Reports/MeanTATSummaryReport.aspx','../Reports/MeanTATSummaryReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Weekly Mean TAT Summary'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Period Wise Mean TAT')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Period Wise Mean TAT','/Reports/PeriodWiseMeanTATReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/PeriodWiseMeanTATReport.aspx'  
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'Period Wise Mean TAT',
'/Reports/PeriodWiseMeanTATReport.aspx','../Reports/PeriodWiseMeanTATReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Period Wise Mean TAT'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------

DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='InvestigationStatusDeptWiseReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'InvestigationStatusDeptWiseReport','/Reports/InvestigatonStatusDeptWiseReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/InvestigatonStatusDeptWiseReport.aspx' 
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'InvestigationStatusDeptWiseReport',
'/Reports/InvestigatonStatusDeptWiseReport.aspx','../Reports/InvestigatonStatusDeptWiseReport.aspx'
,5,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='InvestigationStatusDeptWiseReport'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,67,'Y')
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')
-----------------------------------------------------
--DECLARE @PageID BIGINT
--DECLARE @MenuID INT
--DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=67

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Admin/RoundManagement.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'Round Management','/Admin/RoundManagement.aspx'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/RoundManagement.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'Round Management',2,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Admin/RoundManagement.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END

---------------------------------------------Karkuzhali-------------------------------------------------------------
---Coupon Test Master(Coupon Barcode Length)--
DECLARE @CONFIGKEYID BIGINT
DECLARE @ORGID INT
SET @ORGID = 67
IF (SELECT MAX(CONFIGKEYID) FROM CONFIGKEYMASTER) IS NULL
BEGIN
SET @CONFIGKEYID = 0
END
ELSE
SELECT @CONFIGKEYID = MAX(CONFIGKEYID) FROM CONFIGKEYMASTER

IF NOT EXISTS(SELECT CONFIGKEYID FROM CONFIGKEYMASTER WHERE CONFIGKEY='CouponBarcodeLength')
BEGIN
INSERT INTO CONFIGKEYMASTER (CONFIGKEYID,CONFIGKEY,DISPLAYTEXT,ISINTERNAL)
SELECT @CONFIGKEYID+1,'CouponBarcodeLength','CouponBarcodeLength','N'
END
IF NOT EXISTS(SELECT CKM.CONFIGKEYID FROM CONFIGORGMASTER COM JOIN CONFIGKEYMASTER CKM ON CKM.CONFIGKEYID=COM.CONFIGKEYID 
WHERE CKM.CONFIGKEY='CouponBarcodeLength' AND COM.ORGID=@ORGID)
BEGIN
SELECT @CONFIGKEYID = CONFIGKEYID FROM CONFIGKEYMASTER WHERE CONFIGKEY='CouponBarcodeLength'

IF(@ORGID=70)
BEGIN
INSERT INTO CONFIGORGMASTER (CONFIGKEYID,CONFIGVALUE,ORGID)
SELECT @CONFIGKEYID,8,@ORGID
END
ELSE
BEGIN
INSERT INTO CONFIGORGMASTER (CONFIGKEYID,CONFIGVALUE,ORGID)
SELECT @CONFIGKEYID,16,@ORGID
END
END

---System Feedback--
DECLARE @CONFIGKEYID BIGINT
DECLARE @ORGID INT
SET @ORGID = 67
IF (SELECT MAX(CONFIGKEYID) FROM CONFIGKEYMASTER) IS NULL
BEGIN
SET @CONFIGKEYID = 0
END
ELSE
SELECT @CONFIGKEYID = MAX(CONFIGKEYID) FROM CONFIGKEYMASTER

IF NOT EXISTS(SELECT CONFIGKEYID FROM CONFIGKEYMASTER WHERE CONFIGKEY='NeedSystemFeedback')
BEGIN
INSERT INTO CONFIGKEYMASTER (CONFIGKEYID,CONFIGKEY,DISPLAYTEXT,ISINTERNAL)
SELECT @CONFIGKEYID+1,'NeedSystemFeedback','System Feedback','N'
END
IF NOT EXISTS(SELECT CKM.CONFIGKEYID FROM CONFIGORGMASTER COM JOIN CONFIGKEYMASTER CKM ON CKM.CONFIGKEYID=COM.CONFIGKEYID 
WHERE CKM.CONFIGKEY='NeedSystemFeedback' AND COM.ORGID=@ORGID)
BEGIN
SELECT @CONFIGKEYID = CONFIGKEYID FROM CONFIGKEYMASTER WHERE CONFIGKEY='NeedSystemFeedback'

IF(@ORGID=70)
BEGIN
INSERT INTO CONFIGORGMASTER (CONFIGKEYID,CONFIGVALUE,ORGID)
SELECT @CONFIGKEYID,'Y',@ORGID
END
ELSE
BEGIN
INSERT INTO CONFIGORGMASTER (CONFIGKEYID,CONFIGVALUE,ORGID)
SELECT @CONFIGKEYID,'Y',@ORGID
END
END

----Blood group Card-----
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%' and orgid=70
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Blood group Card')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Blood group Card','/Reports/BloodgroupCard.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BloodgroupCard.aspx' 
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'Blood group Card','/Reports/BloodgroupCard.aspx','../Reports/BloodgroupCard.aspx'
,4,1,GETDATE(),@PageID)

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Blood group Card'

Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,70,'Y')

----Coupon Test Master--
CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
insert into Pages (pageid,PageName,PageURL,IsShareable)values(@pageid,'Coupon Test Master','/Admin/CouponTestMaster.aspx','Y')
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) 
SELECT @MenuID,'Coupon Test Master',2,@MinValue,@PageID,'en-GB'
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName='Administrator' 
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 
-----------------------------------------------End----------------------------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='BillsfortheDayTestWiseMonthlyReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'BillsfortheDayTestWiseMonthlyReport','/Reports/BillsfortheDayTestWiseMonthlyReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BillsfortheDayTestWiseMonthlyReport.aspx' 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'BillsfortheDayTestWiseMonthlyReport',
 '/Reports/BillsfortheDayTestWiseMonthlyReport.aspx','../Reports/BillsfortheDayTestWiseMonthlyReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='BillsfortheDayTestWiseMonthlyReport'
 IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
 IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 ----------------------------------------------------
DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='BillsfortheDayClientWiseMonthlyReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'BillsfortheDayClientWiseMonthlyReport','/Reports/BillsfortheDayClientWiseMonthlyReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BillsfortheDayClientWiseMonthlyReport.aspx'
 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'BillsfortheDayClientWiseMonthlyReport',
 '/Reports/BillsfortheDayClientWiseMonthlyReport.aspx','../Reports/BillsfortheDayClientWiseMonthlyReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='BillsfortheDayClientWiseMonthlyReport'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 -----------------------------------------------------
 DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Cancel Bill Report')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Cancel Bill Report','/Reports/CancelledBillReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/CancelledBillReport.aspx' 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'Cancel Bill Report',
 '/Reports/CancelledBillReport.aspx','../Reports/CancelledBillReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Cancel Bill Report'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 -----------------------------------------------------
 DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='TodaysBillreport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'TodaysBillreport','/Reports/BillsforthedayReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/BillsforthedayReport.aspx'  
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'TodaysBillreport',
 '/Reports/BillsforthedayReport.aspx','../Reports/BillsforthedayReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='TodaysBillreport'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 -----------------------------------------------------
 DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='PendingsamplesReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'PendingsamplesReport','/Reports/PendingsamplesReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/PendingsamplesReport.aspx'   
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'PendingsamplesReport',
 '/Reports/PendingsamplesReport.aspx','../Reports/PendingsamplesReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='PendingsamplesReport'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 -----------------------------------------------------
 DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Weekly Mean TAT Summary')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Weekly Mean TAT Summary','/Reports/MeanTATSummaryReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/MeanTATSummaryReport.aspx'  
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'Weekly Mean TAT Summary',
 '/Reports/MeanTATSummaryReport.aspx','../Reports/MeanTATSummaryReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Weekly Mean TAT Summary'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 -----------------------------------------------------
 DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Period Wise Mean TAT')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Period Wise Mean TAT','/Reports/PeriodWiseMeanTATReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/PeriodWiseMeanTATReport.aspx'  
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'Period Wise Mean TAT',
 '/Reports/PeriodWiseMeanTATReport.aspx','../Reports/PeriodWiseMeanTATReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Period Wise Mean TAT'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
-----------------------------------------------------
 
 DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='InvestigationStatusDeptWiseReport')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'InvestigationStatusDeptWiseReport','/Reports/InvestigatonStatusDeptWiseReport.aspx','N')
END
 
DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/InvestigatonStatusDeptWiseReport.aspx' 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'InvestigationStatusDeptWiseReport',
 '/Reports/InvestigatonStatusDeptWiseReport.aspx','../Reports/InvestigatonStatusDeptWiseReport.aspx'
 ,5,1,GETDATE(),@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='InvestigationStatusDeptWiseReport'
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=67)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,67,'Y')
 End
  IF Not exists(select 1 from ReportOrgMapping where ReportID=@ReporID and RoleID=@RoleID and OrgID=70)
 Begin
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,70,'Y')
 End
 -----------------------------------------------------
-------------------------------------------------------------------Karkuzhali-----------------------------------------------------------
---Data for SystemFeedBackType table
IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='Suggestion')
insert into SystemFeedBackType(TypeID,Type,isactive)values (1,'Suggestion','Y')
GO
IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='Error')
insert into SystemFeedBackType(TypeID,Type,isactive)values (2,'Error','Y')
GO
IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='FeedBack')
insert into SystemFeedBackType(TypeID,Type,isactive)values (3,'FeedBack','Y')
GO

IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='Usecase Problem')
insert into SystemFeedBackType(TypeID,Type,isactive)values (4,'Usecase Problem','Y')
GO

IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='Design/Browser Issue')
insert into SystemFeedBackType(TypeID,Type,isactive)values (5,'Design/Browser Issue','Y')
GO

IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='Compliment/Praise')
insert into SystemFeedBackType(TypeID,Type,isactive)values (6,'Compliment/Praise','Y')
GO

IF NOT EXISTS(SELECT * FROM [SystemFeedBackType] WHERE [Type]='Query')
insert into SystemFeedBackType(TypeID,Type,isactive)values (7,'Query','Y')
GO
-------------------------------------------------------------------End-----------------------------------------------------------------------
--------------------------Added by Vijayalakshmi.M--------------------

Declare @configkeyID bigint
Declare @configkeyID1 bigint
Declare @Orgid bigint
Declare @menuID bigint
Declare @MenuID1 bigint
set @Orgid =70
select @configkeyID=configkeyid from ConfigKeyMaster where ConfigKey ='ExternalVisitSearch'
update ConfigOrgMaster  set ConfigValue='Y' where ConfigKeyID =@configkeyID and OrgID =@Orgid 

select @configkeyID1=configkeyid from ConfigKeyMaster where ConfigKey ='ExternalVisitIdWaterMark'
update ConfigOrgMaster  set ConfigValue='Y' where ConfigKeyID =@configkeyID1 and OrgID =@Orgid 

select @menuID =menuid from MenuMaster where DisplayText ='Userdriven SampleTransfer' and OrgId =@Orgid 
update MenuMaster set DisplayText ='Sample Transfer' where DisplayText ='Userdriven SampleTransfer' and orgid =@Orgid and menuid=@menuID 
delete MenuMaster where DisplayText ='Sample Transfer' and OrgId =@Orgid and PageID =543
------------------------------End--------------------------------------
----------------------------Added by Vijayalakshmi.M-------------------
declare @OrgID bigint
Set @OrgID =70
declare @MetatypeID bigint

If Not exists(select 1 from MetaType_Common where Description ='TESTSUBCATEGORY' and Code ='INH' and OrgID =@OrgID )
begin
Insert into MetaType_Common (TypeName ,Description ,Code ,OrgID ,IsActive ,SystemLevel )
values('TESTSUBCATEGORY','TESTSUBCATEGORY','TESTSUBCATEGORY',@OrgID,'Y','Y')
end

select @MetatypeID =metatypeid from MetaType_Common where OrgID =@OrgID and Code ='TESTSUBCATEGORY'
 
If Not exists (select 1 from MetaValue_Common where Value ='InHouse' and OrgID =@OrgID )
begin
Insert into MetaValue_Common (MetaTypeId ,Value ,Code,OrgID ,Description ,IsActive )
values (@MetatypeID ,'InHouse','INH',@OrgID ,'InHouse','Y')
end

If Not exists (select 1 from MetaValue_Common where Value ='OutSource' and OrgID =@OrgID )
begin
Insert into MetaValue_Common (MetaTypeId ,Value ,Code,OrgID ,Description ,IsActive )
values (@MetatypeID ,'OutSource','OUT',@OrgID ,'OutSource','Y')
end

----------------------------End ------------------------------------------
declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =70
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='SetDefaultSearch')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
values(@ConfigKeyId+1,'SetDefaultSearch','Hide Fields in InvestigationResult Task','Y')
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='SetDefaultSearch'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
values(@SConfigKeyID ,'Y',@Orgid)
end


/***************************Added By Arivalagan**********************************/

BEGIN

DECLARE @PageID BIGINT
DECLARE @OrgID INT
DECLARE @PageURL VARCHAR(100)
DECLARE @MenuDisplayText VARCHAR(100)
DECLARE @RolDescription VARCHAR(100)

Set @PageURL='/Admin/RoundManagement.aspx'
Set @MenuDisplayText='Round Management'
Set @RolDescription='Administrator'
SET @OrgID=70

SELECT @PageID=MAX(PageID) FROM Pages
IF NOT EXISTS(SELECT *FROM Pages WHERE PageURL=@PageURL)
BEGIN
INSERT INTO Pages(PageID,PageName,pageURL,IsShareable)
SELECT @PageID+1,@MenuDisplayText,@PageURL,'Y'
SELECT 'Pages Inserted'
END
ELSE
BEGIN 
SELECT 'Pages Exists'
END 

SELECT @PageID=PageID FROM Pages WHERE PageURL=@PageURL
DECLARE @MenuID INT
SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @MenuID
IF NOT EXISTS(SELECT *FROM MenuMaster WHERE DisplayText=@MenuDisplayText AND PageID=@PageID)
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,ParentID,OrgID,PageID,LanguageCode)
SELECT @MenuID+1,@MenuDisplayText,'2',@OrgID,@PageID,'en-GB'
select 'Menu Inserted'
END
Else
Begin
select 'Menu Exist'
End
SELECT @PageID=PageID FROM Pages WHERE PageURL=@PageURL
SELECT @MenuID=MAX(MenuID) FROM MenuMaster WHERE  DisplayText=@MenuDisplayText AND PageID=@PageID
--SELECT @MenuID 
DECLARE @RoleID BIGINT
SELECT @RoleID=RoleID FROM Role where Description like '%'+@RolDescription+'%' and OrgID=@OrgID
--select @RoleID
IF NOT EXISTS(SELECT * FROM RoleMenu WHERE MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,roleID,IsMapped)
Select @MenuID,@RoleID,'Y'
Select 'Role Menu Inserted'
END
Else
Begin
Select 'Role Menu Exist'
End 
go 


END
/***************************End Modified By Arivalagan**********************************/
If Not exists(select 1 from sys.columns sc inner join sys.sysobjects SO (nolock) on sc.object_id = so.id where so.name = 'PatternMapping' And sc.name = 'status') BEGIN Alter Table [PatternMapping] Add [status]  varchar(5) END
GO
-------------------------------------------------------------------------------------------------------------------------------------------------------
/----------------Added by Vijayalakshmi.M-----------------------/
Declare @OrgID bigint
Declare @RoleID bigint
select @RoleID =MAX(roleID)from Role
set @OrgID =70 
If Not exists(select 1 from Role where RoleName ='Patient' and OrgID =@OrgID )
begin
insert into role (RoleID ,RoleName ,Description ,OrgID )
select @RoleID +1,'Patient','Patient',@OrgID 
End

Declare @OrgID bigint
Declare @RoleID bigint
select @RoleID =MAX(roleID)from Role
set @OrgID =70 
If Not exists(select 1 from Role where RoleName ='TMCUsers' and OrgID =@OrgID )
begin
insert into role (RoleID ,RoleName ,Description ,OrgID )
select @RoleID +1,'TMCUsers','Portal Users',@OrgID 
End

Declare @OrgID bigint
Declare @RoleID bigint
select @RoleID =MAX(roleID)from Role
set @OrgID =70 
If Not exists(select 1 from Role where RoleName ='ReferringPhysician' and OrgID =@OrgID )
begin
insert into role (RoleID ,RoleName ,Description ,OrgID )
select @RoleID +1,'ReferringPhysician','ReferringPhysician',@OrgID 
End


/-------------------------End---------------------------------/
/-------------------Vijayalakshmi.M---------------------------/
 Declare @OrgID bigint
 Declare @MetaTypeID bigint
 set @OrgID =70
 select @MetaTypeID=MetaTypeID from MetaType_Common where Code ='TESTSUBCATEGORY' and OrgID =@OrgID 

 If Not Exists(select 1 from MetaValue_Common where Value ='COLLECTION CENTER' and MetaTypeId =@MetaTypeID )
 begin 
 insert into MetaValue_Common (MetaTypeId ,Value,Code ,OrgID ,Description ,IsActive )
 select @MetaTypeID,'COLLECTION CENTER','CPT',@OrgID ,'COLLECTION POINT','Y'
 union all
 select @MetaTypeID,'COLLECTION CENTER','CPT',67 ,'COLLECTION POINT','Y'
 end
 
 

 If Not exists (select 1 from ReasonMaster where Reason ='Incorrect Invoice' and ReasonCode ='WB')
 begin
 insert into ReasonMaster (ReasonTypeID ,Reason,ReasonCode ,Status ,CreatedAt )
 select 1,'Incorrect Invoice','WB','A',GETDATE ()
 end
 If Not exists (select 1 from ReasonMaster where Reason ='Wrong demographics selected' and ReasonCode ='WD')
 begin
 insert into ReasonMaster (ReasonTypeID ,Reason,ReasonCode ,Status ,CreatedAt )
 select 1,'Wrong demographics selected','WD','A',GETDATE ()
 end
 
 Declare @OrgID bigint
 Declare @ReasonID bigint
 Set @OrgID =70
 Select @ReasonID =ReasonID from ReasonMaster where Reason ='Incorrect Invoice' and ReasonCode ='WB'
 If Not Exists (select 1 from InvReasonOrgMapping where ReasonID =@ReasonID )
 Begin
 insert into InvReasonOrgMapping (StatusID ,ReasonID  ,OrgID )
 select 0,@ReasonID,@OrgID
 End
 Select @ReasonID =ReasonID from ReasonMaster where Reason ='Wrong demographics selected' and ReasonCode ='WD'
 If Not Exists (select 1 from InvReasonOrgMapping where ReasonID =@ReasonID )
 Begin
 insert into InvReasonOrgMapping (StatusID ,ReasonID  ,OrgID )
 select 0,@ReasonID,@OrgID
 End
 
 
 declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =70
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='NeedInvoiceCycle')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'NeedInvoiceCycle','NeedInvoiceCycle','Y'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='NeedInvoiceCycle'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'N',@Orgid
union all
Select @SConfigKeyID ,'Y',67
End
/-----------------End-----------------------------------------/
/-------------------Karthik.P-------------------------------------------------------------------------------------------------------------/
if not exists(select 1 from Pages where PageName='InvApproval')
Begin
	insert into Pages (PageID,PageName,PageURL,IsShareable)
	select MAX(PageID+1),'InvApproval','/Investigation/InvApproval.aspx','N' from pages
End


Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btnSave1' and ButtionValue='Save')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue)values (@pageid,'btnSave1','Save')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btnSaveToDispatch1' and ButtionValue='Save And Home')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'btnSaveToDispatch1','Save And Home')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btnSave' and ButtionValue='Save')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'btnSave','Save')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btnSaveToDispatch' and ButtionValue='Save And Home')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'btnSaveToDispatch','Save And Home')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btnSaveConfirm' and ButtionValue='Yes')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'btnSaveConfirm','Yes')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='Save' and ButtionValue='Save')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'Save','Save')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btsaveandnext' and ButtionValue='Save And Next')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'btsaveandnext','Save And Next')
End

if not exists(select 1 from PageContext where PageID=@pageid and ButtonName='btnbtmsavennext' and ButtionValue='Save And Next')
Begin
	insert into PageContext(PageID,ButtonName,ButtionValue) values(@pageid,'btnbtmsavennext','Save And Next')
End
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 8
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btnSave1' and ButtionValue='Save'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 9
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btnSaveToDispatch1' and ButtionValue='Save And Home'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 10
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btnSave' and ButtionValue='Save'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End


Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 11
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btnSaveToDispatch' and ButtionValue='Save And Home'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 12
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btnSaveConfirm' and ButtionValue='Yes'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 18
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='Save' and ButtionValue='Save'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 58
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btsaveandnext' and ButtionValue='Save And Next'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

Declare @pageid int
select @pageid=PageID from Pages where PageName='InvApproval'
Declare @PageContextId bigint = 59
Declare @NewPageContextId bigint
select  @NewPageContextId= PageContextID from PageContext where PageID=@pageid and ButtonName='btnbtmsavennext' and ButtionValue='Save And Next'
if not exists (select 1 from PageContextActionMapping where PageContextID=@NewPageContextId)
Begin
	insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
	select @NewPageContextId,2771,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment 
	from PageContextActionMapping where PageContextID = @PageContextId and RoleID=2342
End

/-----------------End---------------------------------------------------------------------------------------------------------------------/
---------------------------------------------------------------Karkuzhali-----------------------------------------------------------
CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'Investigation Create/Update','/InvestigationBulkData/InvCreateUpdate.aspx') 
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) 
SELECT @MenuID,'Investigation Create/Update',2,@MinValue,@PageID,'en-GB'
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped) 
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName like '%Administrator%' 
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID

----------------------------------------------------------------End----------------------------------------------------------------

--------------------------Karthick Serum---------------------------------------------------------------

insert into MetaData (Domain,Code,DisplayText,LangCode)values('InvoiceType','Orginal','Orginal','en-GB')
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)values(383,82,'en-GB','Orginal')

--------------------------Karthick Serum---------------------------------------------------------------
--------------------------Vijayalakshmi.M -------------------------------------------------------------
Declare @OrgID bigint
Declare @TypeID bigint
Declare @pReasonID bigint
set @OrgID=69

IF not Exists(select 1 from ReasonType where TypeCode ='TM' and DisplayText ='Audit Reason')
begin
insert into reasontype(CategoryID ,DisplayText ,TypeCode )
select 1,'Audit Reason','TM'
end


select @TypeID= TypeID from ReasonType where TypeCode ='TM'
If not exists (select 1 from ReasonMaster where ReasonTypeID =@TypeID and OrgID =@OrgID )
begin
insert into ReasonMaster (ReasonTypeID ,Reason ,ReasonCode ,Status ,OrgID )
values(@TypeID,'TestMaster Updation','TM1','A',@OrgID)
end

select @pReasonID=reasonID from ReasonMaster   where Reason ='TestMaster Updation' and OrgID =@OrgID and ReasonCode ='TM1'
IF not exists (select 1 from InvReasonOrgMapping where ReasonID =@pReasonID  )
begin
insert into InvReasonOrgMapping (StatusID ,ReasonID ,OrgID )
select 0,@pReasonID,@OrgID
end

Declare @OrgID bigint
 Declare @PageID bigint
 set @OrgID =69
 If Not Exists (select 1 from BatchIDMaster where OrgAddID =144 and OrgID =69)
 begin
 insert into BatchIDMaster(OrgID ,BatchNumber ,OrgAddID ,Format ,CreatedAt )
 select 69,1,144,'BAT',GETDATE ()
 end

 select @PageID =PageID from Pages where PageURL ='/Lab/TransferSampleCollection.aspx' and PageName ='Sample Transfer'
 If Exists (select 1 from Pages where PageID =@PageID )
 begin
 update Pages set PageURL = '/Lab/TransferSampleCollection.aspx?Flag=Y' where PageID =543
 end
 -------------------------Added by Vijayalakshmi.M-------------------------------------------------------------
 declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =70
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='CreateTaskValidation')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
values(@ConfigKeyId+1,'CreateTaskValidation','Create Task based on group or visit level status','Y')
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='CreateTaskValidation'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
values(@SConfigKeyID ,'VISIT',@Orgid)
end
--------------------------------------------------------------------------------------------------------------
Declare @InvStatusID bigint
Declare @InvStatusID1 bigint
Declare @InvStatusID2 bigint
Declare @InvStatusID3 bigint
Declare @TaskActionID bigint

select @InvStatusID =investigationstatusid from InvestigationStatus where Status ='Completed'
select @InvStatusID1 =investigationstatusid from InvestigationStatus where Status ='Approve'
select @InvStatusID2 =investigationstatusid from InvestigationStatus where Status ='PartiallyCompleted'
select @InvStatusID3 =investigationstatusid from InvestigationStatus where Status ='Cancel'
set @TaskActionID =62

If Not Exists (select 1 from TaskEntityMap where MappingID in (@InvStatusID1,@InvStatusID2,@InvStatusID3)and TaskActionID  =@TaskActionID)
begin
insert into TaskEntityMap (MappingType,MappingID ,TaskActionID ,IsPrimary )
select 'InvestigationStatus',@InvStatusID1,@TaskActionID,'Y'
UNION ALL
select 'InvestigationStatus',@InvStatusID2,@TaskActionID,'Y'
UNION ALL
select 'InvestigationStatus',@InvStatusID3,@TaskActionID,'Y'
END
If Not Exists (select 1 from TaskEntityMap where MappingID=@InvStatusID and TaskActionID  =@TaskActionID and IsPrimary ='Y')
begin
update TaskEntityMap set IsPrimary ='Y' where TaskActionID =@TaskActionID and MappingID =@InvStatusID
End

If Not Exists (select 1 from DispatchRuleMapping where clientid=1)
begin
insert into DispatchRuleMapping (ClientId ,RuleId ,SqlText )
select 1,'1,2,3,4','Declare @tmpStatus1 table  (status varchar(100))                    DECLARE @Sts INT                  IF EXISTS(SELECT INS.Status from InvestigationStatus INS  inner join TaskEntityMap TM ON                                            TM.MappingID=INS.InvestigationStatusID AND TM.TaskActionID=@TaskActionID  AND TM.OrgID=@orgid)                                          BEGIN                              INSERT INTO @tmpStatus1                         SELECT DISTINCT s.Status from InvestigationStatus s                         INNER JOIN TaskEntityMap TM ON S.InvestigationStatusID= TM.MappingID                                      WHERE TM.TaskActionID=@TaskActionID AND isnull(TM.IsPrimary,''N'')=''Y'' AND TM.OrgID=@orgid                                                              END                                        ELSE                                          BEGIN                                        INSERT INTO @tmpStatus1                           SELECT DISTINCT s.STATUS FROM InvestigationStatus s                         INNER JOIN TaskEntityMap TM ON S.InvestigationStatusID= TM.MappingID                                      WHERE TM.TaskActionID=@TaskActionID AND isnull(TM.IsPrimary,''N'')=''Y''                        END                   INSERT INTO @tmpStatus1 (STATUS)               SELECT ''ReflexTest'' union select ''Cancel'' union select ''Rejected''        union select ''Not given''       SELECT @Sts = COUNT(*) FROM OrderedInvestigations o INNER JOIN @tmpStatus1 p ON o.STATUS = p.STATUS    WHERE o.VisitID=@visitid and O.OrgID=@orgid                        SELECT OI.VisitID,OI.LabNo FROM OrderedInvestigations OI (NOLOCK) WHERE  OI.VisitID =@visitid  and OI.OrgID=@orgid and                                                     OI.Type in (''GRP'',''PKG'',''INV'') GROUP BY OI.VisitID,OI.LabNo    HAVING @Sts = (SELECT COUNT(*) FROM OrderedInvestigations o WHERE o.VisitID=@visitid and O.OrgID=@orgid )'
END
------------------------------Vijayalakshmi.M ------------------------------------------------------------------
------------------------------Vijayalakshmi.M-------------------------------------------------------------------
 declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =69
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='ConvReferenceRange')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'ConvReferenceRange','Do You want to show the ConvReferenceRange in TestMaster?','Y'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='ConvReferenceRange'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'Y',@Orgid
union all
Select @SConfigKeyID ,'Y',68
union all
Select @SConfigKeyID ,'Y',70
End
-----------------------------------------------------------------------------------------------------------------


--------------------------Karthick ---------------------------------------------------------------

declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =86
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='Remarks_Billing')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'Remarks_Billing','Do you want to display the remarks','N'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='Remarks_Billing'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'Y',@Orgid
end
--------------------------Karthick---------------------------------------------------------------
declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =86
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='DiscountEditCashClient')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'DiscountEditCashClient','Do you want to Cash Client','N'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='DiscountEditCashClient'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'Y',@Orgid
end

--------------------------Karthick---------------------------------------------------------------
-------------------------------------Karkuzhali---------------------------------------------------
CREATE
TABLE #TempOrgID 
(
OrgID 
int 
)
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
DECLARE @MenuID bigint 
DECLARE @PageID bigint 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
set @PageID=(SELECT MAX(pageid)+1 FROM Pages) 
INSERT INTO Pages (PageID,PageName,PageURL)VALUES(@PageID,'Manage Referral Policy','/Admin/ManageReferralPolicy.aspx') 
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
BEGIN
INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) 
SELECT @MenuID,'Manage Referral Policy',2,@MinValue,@PageID,'en-GB'
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped)
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@MinValue AND RoleName like '%Administrator%'
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID



-------------------------------------End----------------------------------------------------------
--------------------------Karthick ---------------------------------------------------------------

declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =86
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='SpecimenCount')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'SpecimenCount','NeedSpecimenCount','N'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='SpecimenCount'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'Y',@Orgid
end
--------------------------Karthick---------------------------------------------------------------


--------------------------ADDED  BT Thillai  kapil.T -------
IF  EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedSavePreviewbtn')
BEGIN
declare @GetconfigId2 int

select @GetconfigId2=configkeyid from ConfigKeyMaster   where  ConfigKey='NeedSavePreviewbtn'

insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId2,'Y',85)
end


-------------------------End---------------------------------
--------------------Vijayalakshmi.M--------------------------------------------------------------
Declare @OrgId bigint
Set @OrgId =69
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/GeneralPattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 58,'~/Investigation/GeneralPattern.ascx','GeneralPattern',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/Tablepatternautopopulate.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 59,'~/Investigation/Tablepatternautopopulate.ascx','Tablepattern',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/RichTextPattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 60,'~/Investigation/RichTextPattern.ascx','TextPattern',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/PDFUploadpattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 61,'~/Investigation/PDFUploadpattern.ascx','PDFUploadPattern',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/HistoImageDescriptionPattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 62,'~/Investigation/HistoImageDescriptionPattern.ascx','HistoDescription',69
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/ImageDescriptionPattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 63,'~/Investigation/ImageDescriptionPattern.ascx','ImageDescription',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/HistoPathologyPatternQuantum.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 64,'~/Investigation/HistoPathologyPatternQuantum.ascx','HistoQuantum',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/ImageUploadpattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 45,'~/Investigation/ImageUploadpattern.ascx','ImagePattern',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/FishPattern1.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 46,'~/Investigation/FishPattern1.ascx','FishPattern1',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/FishResultPattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 47,'~/Investigation/FishResultPattern.ascx','ResultFishPattern',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/FishResultPattern1.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 48,'~/Investigation/FishResultPattern1.ascx','ResultFishPattern1',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/FishPattern2.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 49,'~/Investigation/FishPattern2.ascx','FishPattern2',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/MultiAddControl.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 50,'~/Investigation/MultiAddControl.ascx','MultiAddControl',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/HBVDRUG.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 51,'~/Investigation/HBVDRUG.ascx','HBVDRUG',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/BRCAPattern.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 52,'~/Investigation/BRCAPattern.ascx','BRCA',@OrgId
end
IF not Exists (select Patternname from InvestigationPattern where PatternName ='~/Investigation/BRCAPattern1.ascx')
Begin
insert into investigationpattern (PatternID ,PatternName ,DisplayText ,OrgID )
select 53,'~/Investigation/BRCAPattern1.ascx','BRCA1',@OrgId
end
----------------------------------------------------------------------------------------------------------
 declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =69
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='IsReceived/Collected')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'IsReceived/Collected','Is Needed Sample Status Received/Collected?','Y'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='IsReceived/Collected'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'Y',@Orgid
end
-----------------------------------------------------------------------------------------------------------

--------------------------Karthick ---------------------------------------------------------------

declare @SConfigKeyID varchar(30)
declare @orgid bigint
set @orgid =86
declare @ConfigKeyId bigint
SELECT @ConfigKeyId=MAX(ConfigKeyID ) FROM ConfigKeyMaster

If not exists(select 1 from ConfigKeyMaster where ConfigKey='Barcode_Alphabets')
begin
insert into ConfigKeyMaster (configkeyid,ConfigKey ,DisplayText ,IsInternal )
Select @ConfigKeyId+1,'Barcode_Alphabets','Need Barcode Alphabets?','N'
end

select @SConfigKeyID=configkeyid from ConfigkeyMaster where configkey='Barcode_Alphabets'

If not exists(select 1 from ConfigOrgMaster where ConfigKeyID =@SConfigKeyID and OrgID =@Orgid )
begin
insert into ConfigOrgMaster(configkeyid,configvalue,orgid)
Select @SConfigKeyID ,'Y',@Orgid
end
--------------------------Karthick---------------------------------------------------------------

-------------------------Deployablity  team changes--------------------------------------------
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 

WHILE @MinValue <= @MaxValue 
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
	BEGIN
	DECLARE @MetaDataID1 bigint
	DECLARE @MetaDataID2 bigint
	DECLARE @MetaDataID3 bigint
--Normal Type					
		 IF EXISTS (select * from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Normal' and DisplayText='Normal')
		BEGIN
					select @MetaDataID1=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Normal' and DisplayText='Normal'
					IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Normal' )
					BEGIN
						INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID1,@MinValue,'en-GB','Normal')
					END
		END
--Normal Type						
--Special Type				
		 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Special' and DisplayText='Special')
				 BEGIN
					select @MetaDataID2=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Special' and DisplayText='Special'
					IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID2 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Special' )
					BEGIN
						INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID2,@MinValue,'en-GB','Special')
					END
		END
--Special Type				
--Vendor Type				
		 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Vendor' and DisplayText='Vendor')
				 BEGIN
					select @MetaDataID3=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Vendor' and DisplayText='Vendor'
					IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID3 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Vendor' )
					BEGIN
						INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID3,@MinValue,'en-GB','Vendor')
					END
		END
--Vendor Type		
		
--Vendor SubType
				--declare @Orgid bigint
				Declare @ParentID1 Bigint
				Declare @MetaDataID4 Bigint
				Declare @MetaDataID5 Bigint
				Declare @MetaDataID6 Bigint
				--select @Orgid=OrganizationID from Organization where OrgDisplayName = 'Metropolis Vidyavihar'

				Select @ParentID1=MetaDataID from MetaData Where Domain='Vendor Type' and LangCode='en-GB' AND Code='Vendor'
				IF  EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Vendor')
				 BEGIN
						 IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID1)
						 BEGIN
							 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
							 VALUES ('Vendor Type','Agreement','Agreement','en-GB',@ParentID1)
						 END
						 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID1)
						 BEGIN
							select @MetaDataID4=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID1
							IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID4 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Agreement' )
							BEGIN
								INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID4,@MinValue,'en-GB','Agreement')
							END
						 END
					 
						 IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID1)
						 BEGIN
							 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
							 VALUES ('Vendor Type','Rate Policy','Rate Policy','en-GB',@ParentID1)
						 END
						 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID1)
						 BEGIN
							select @MetaDataID5=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID1
							IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID5 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Rate Policy' )
							BEGIN
								INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID5,@MinValue,'en-GB','Rate Policy')
							END
						 END
						 
						IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID1)
						 BEGIN
							 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
							 VALUES ('Vendor Type','Tender','Tender','en-GB',@ParentID1)
						 END
						 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID1)
						 BEGIN
							select @MetaDataID6=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID1
							IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID6 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Tender' )
							BEGIN
								INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID6,@MinValue,'en-GB','Tender')
							END
						 END
				END		  
--Vendor SubType
--Normal SubType
			--declare @Orgid bigint
			Declare @ParentID2 Bigint
			Declare @MetaDataID7 Bigint
			Declare @MetaDataID8 Bigint
			Declare @MetaDataID9 Bigint
			--select @Orgid=OrganizationID from Organization where OrgDisplayName = 'Metropolis Vidyavihar'

			Select @ParentID2=MetaDataID from MetaData Where Domain='Vendor Type' and LangCode='en-GB' AND Code='Normal'
			IF  EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Normal')
			 BEGIN
					 IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID2)
					 BEGIN
						 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
						 VALUES ('Vendor Type','Agreement','Agreement','en-GB',@ParentID2)
					 END
					 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID2)
					 BEGIN
						select @MetaDataID7=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID2
						IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID7 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Agreement' )
						BEGIN
							INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID7,@MinValue,'en-GB','Agreement')
						END
					 END
				 
					 IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID2)
					 BEGIN
						 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
						 VALUES ('Vendor Type','Rate Policy','Rate Policy','en-GB',@ParentID2)
					 END
					 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID2)
					 BEGIN
						select @MetaDataID8=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID2
						IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID8 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Rate Policy' )
						BEGIN
							INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID8,@MinValue,'en-GB','Rate Policy')
						END
					 END
					 
					IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID2)
					 BEGIN
						 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
						 VALUES ('Vendor Type','Tender','Tender','en-GB',@ParentID2)
					 END
					 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID2)
					 BEGIN
						select @MetaDataID9=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID2
						IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID9 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Tender' )
						BEGIN
							INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID9,@MinValue,'en-GB','Tender')
						END
					 END
			END		  
--Normal SubType
--Special SubType
			--declare @Orgid bigint
			Declare @ParentID3 Bigint
			Declare @MetaDataID10 Bigint
			Declare @MetaDataID11 Bigint
			Declare @MetaDataID12 Bigint
			--select @Orgid=OrganizationID from Organization where OrgDisplayName = 'Metropolis Vidyavihar'
			Select @ParentID3=MetaDataID from MetaData Where Domain='Vendor Type' and LangCode='en-GB' AND Code='Special'
			IF  EXISTS (select * from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Special')
			 BEGIN
					 IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID3)
					 BEGIN
						 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
						 VALUES ('Vendor Type','Agreement','Agreement','en-GB',@ParentID3)
					 END
					 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID3)
					 BEGIN
						select @MetaDataID10=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Agreement' and ParentID=@ParentID3
						IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID10 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Agreement' )
						BEGIN
							INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID10,@MinValue,'en-GB','Agreement')
						END
					 END
				 
					 IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID3)
					 BEGIN
						 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
						 VALUES ('Vendor Type','Rate Policy','Rate Policy','en-GB',@ParentID3)
					 END
					 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID3)
					 BEGIN
						select @MetaDataID11=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Rate Policy' and ParentID=@ParentID3
						IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID11 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Rate Policy' )
						BEGIN
							INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID11,@MinValue,'en-GB','Rate Policy')
						END
					 END
					 
					IF NOT EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID3)
					 BEGIN
						 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
						 VALUES ('Vendor Type','Tender','Tender','en-GB',@ParentID3)
					 END
					 IF EXISTS (select 1 from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID3)
					 BEGIN
						select @MetaDataID12=MetaDataID from MetaData where Domain='Vendor Type' and LangCode='en-GB' AND Code='Tender' and ParentID=@ParentID3
						IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID12 and OrgID=@MinValue and LangCode='en-GB' and DisplayText='Tender' )
						BEGIN
							INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values (@MetaDataID12,@MinValue,'en-GB','Tender')
						END
					 END
			END	  
--Special SubType
		
	END
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID

-------------------------End------------------------------------------------------------------
----added  by   Thillai  kapil.T
DECLARE @ConfigKeyID BIGINT
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=82)
		BEGIN
			IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='hyphenvalidation')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'hyphenvalidation','hyphenvalidation','Y','')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='hyphenvalidation'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='hyphenvalidation' AND COM.OrgID=82)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',82,GETDATE())
				END
		END
END


DECLARE @ConfigKeyID BIGINT
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=86)
		BEGIN
			IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='communicationTAB_hide')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'communicationTAB_hide','communicationTAB_hide','Y','')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='communicationTAB_hide'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='communicationTAB_hide' AND COM.OrgID=86)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',86,GETDATE())
				END
		END
END
----End



IF not Exists (select CountryName from Country c where c.CountryName ='Others')
Begin
INSERT INTO dbo.Country
    (
        dbo.Country.CountryName,dbo.Country.CreatedBy, dbo.Country.CreatedAt, dbo.Country.ModifiedBy, dbo.Country.ModifiedAt,
        dbo.Country.Nationality,        dbo.Country.NationalityID,        --SNo - this column value is auto-generated
        dbo.Country.CountryID,        dbo.Country.IsDefault,        dbo.Country.ISDCode,        dbo.Country.CountryCode,dbo.Country.PhoneNo_Length
    )
    VALUES
    (
        N'Others', -- CountryName - nvarchar
        NULL, -- CreatedBy - bigint
        GETDATE(), -- CreatedAt - datetime
        NULL, -- ModifiedBy - bigint
        GETDATE(), -- ModifiedAt - datetime
        'Others', -- Nationality - varchar
        (SELECT max(CountryID)+1 FROM Country), -- NationalityID - smallint
        -- SNo - int
        (SELECT max(CountryID)+1 FROM Country), -- CountryID - smallint
        NULL, -- IsDefault - char
        NULL, -- ISDCode - int
        NULL, -- CountryCode - int
        NULL -- PhoneNo_Length - int
    )
end




declare @pageid int
declare @menuid int

declare @roleid int
declare @orgid int
set @orgid=67



select @pageid=max(pageid)+1 from pages 

IF NOT EXISTS (SELECT * FROM Pages WHERE PageName='Master Bulk Upload')
BEGIN
INSERT INTO pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)

SELECT @pageid,'Master Bulk Upload','/Deployability/InvCreateUpdate.aspx',GETDATE(), 169
END


 DECLARE @OrgCount INT 
 
       DECLARE @OrgRow INT  
 DECLARE @porgs TABLE                                     
        (                                    
           rowid      INT IDENTITY(1, 1),                                     
           orgid        INT                                     
                                           
        )           
           INSERT INTO @porgs                                     
                  (orgid)    
                  select OrganizationID from Organization                                
                  
  SELECT @OrgCount = COUNT(*)              
      FROM   @porgs      
      
       SET @OrgRow = 1                                     
        WHILE ( @OrgRow <= @OrgCount )                                     
        BEGIN                               
                        
                          SELECT @orgid = orgid                           
            FROM   @porgs                                     
            WHERE  rowid = @OrgRow        
              
                        select @roleid=RoleID from Role where RoleName like '%Administrator%'and OrgID=@orgid

if(@roleid is not null)
begin

IF NOT EXISTS (SELECT * FROM MenuMaster WHERE DisplayText='Master Bulk Upload' AND OrgId=@orgid)
BEGIN
select @menuid=max(MenuID)+1 from MenuMaster 
INSERT INTO MenuMaster(DisplayText,CreatedBy,CreatedAt,Parentid,OrgId,PageID,LanguageCode,MenuID)
SELECT 'Master Bulk Upload',169,GETDATE(),0,@orgid,@pageid,'en-GB',@menuid

INSERT INTO rolemenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @menuid,@roleid,GETDATE(),169,'Y' 

END

 end  
   IF NOT EXISTS (SELECT * FROM CodingSchemeOrgMapping WHERE OrgID=@orgid)
              BEGIN
                   insert into CodingSchemeOrgMapping(CodeTypeID,RootOrgID,ParentOrgID,OrgID,IsPrimary)select 1,70,70,@orgid ,'Y'
END

                       
               SET @OrgRow = @OrgRow + 1;      
               
                     END 
                     
                     
        ----added  by   Thillai  kapil.T
DECLARE @ConfigKeyID BIGINT
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=86)
		BEGIN
			IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='oldapproval_hide')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'oldapproval_hide','oldapproval_hide','Y','')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='oldapproval_hide'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='oldapproval_hide' AND COM.OrgID=86)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',86,GETDATE())
				END
		END
END


----End
---------------------------------------Nicholas------------------------------------------------------------------------------
if not exists(select * from theme  where themename='Orange Dark' and themeUrl='/Themes/OD/style.css')  
insert into theme (themename, themeUrl) values ('Orange Dark','/Themes/OD/style.css')
go
if not exists(select * from theme  where themename='Blue Light' and themeUrl='/Themes/BL/style.css')  
insert into theme (themename, themeUrl) values ('Blue Light','/Themes/BL/style.css')
go
if not exists(select * from theme  where themename='Green Light' and themeUrl='/Themes/GL/style.css')  
insert into theme (themename, themeUrl) values ('Green Light','/Themes/GL/style.css')
go
-----------------------------------------END-------------------------------------------------------------------------------
declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=69
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end  

 
------------------------------Karkuzhali----------------------------------
DECLARE @PageID bigint 
DECLARE @MenuID bigint 
Declare @OrgID int
Select @OrgID =81
IF EXISTS(SELECT PageID FROM Pages WHERE PageURL like '%/Billing/PatientDueDetails.aspx%') 
BEGIN
set @PageID=(SELECT PageID FROM Pages WHERE PageURL like '%/Billing/PatientDueDetails.aspx%')
IF EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID and OrgId=@OrgID)
BEGIN 
Set @MenuID=(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID and OrgId=@OrgID)
IF NOT EXISTS(SELECT MenuID FROM RoleMenu WHERE MenuID=@MenuID)
BEGIN 
INSERT INTO RoleMenu (MenuID,RoleID,IsMapped)
SELECT @MenuID,RoleID,'Y' FROM Role WHERE OrgID=@OrgID AND RoleName like '%Administrator%'
END
END
END

------------------------------End------------------------------------------ 
------------------------------ClientMaster Start------------------------------------------ 
GO
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 

WHILE @MinValue <= @MaxValue 
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
	BEGIN
			DECLARE @PageID BIGINT
			DECLARE @MenuID INT
			DECLARE @RoleID BIGINT

			SELECT @MenuID=MAX(MenuID) FROM MenuMaster
			SELECT @PageID=MAX(PageID) FROM Pages
			SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@MinValue and RoleName='Credit Controller'

			IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Invoice/ClientManagement.aspx')
			BEGIN
				INSERT INTO Pages(PageID,PageName,PageURL) 
				SELECT @PageID+1,'Client Management','/Invoice/ClientManagement.aspx'
			END
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Invoice/ClientManagement.aspx' AND MM.OrgId=@MinValue)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID+1,'Client Management',2,@MinValue,@PageID+1
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Invoice/ClientManagement.aspx' AND MM.OrgId=@MinValue)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID+1,@RoleID,'Y'
			END
END
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID  

GO
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 

WHILE @MinValue <= @MaxValue 
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
	BEGIN
			DECLARE @PageID BIGINT
			DECLARE @MenuID INT
			DECLARE @RoleID BIGINT

			SELECT @MenuID=MAX(MenuID) FROM MenuMaster
			SELECT @PageID=MAX(PageID) FROM Pages
			SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@MinValue and RoleName='Credit Controller'

			IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Deployability/ServiceExclusivity.aspx')
			BEGIN
				INSERT INTO Pages(PageID,PageName,PageURL) 
				SELECT @PageID+1,'Service Exclusivity','/Deployability/ServiceExclusivity.aspx'
			END
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Deployability/ServiceExclusivity.aspx' AND MM.OrgId=@MinValue)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID+1,'Service Exclusivity',2,@MinValue,@PageID+1
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Deployability/ServiceExclusivity.aspx' AND MM.OrgId=@MinValue)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID+1,@RoleID,'Y'
			END
END
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID  


GO
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT OrganizationID from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 

WHILE @MinValue <= @MaxValue 
BEGIN
	IF EXISTS(SELECT OrganizationID FROM Organization WHERE OrganizationID=@MinValue) 
	BEGIN
			DECLARE @PageID BIGINT
			DECLARE @MenuID INT
			DECLARE @RoleID BIGINT

			SELECT @MenuID=MAX(MenuID) FROM MenuMaster
			SELECT @PageID=MAX(PageID) FROM Pages
			SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@MinValue and RoleName='Administrator'

			IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Deployability/CopyingMaster.aspx')
			BEGIN
				INSERT INTO Pages(PageID,PageName,PageURL) 
				SELECT @PageID+1,'Copying Org to Org','/Deployability/CopyingMaster.aspx'
			END
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Deployability/CopyingMaster.aspx' AND MM.OrgId=@MinValue)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID+1,'Copying Org to Org',2,@MinValue,@PageID+1
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Deployability/CopyingMaster.aspx' AND MM.OrgId=@MinValue)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID+1,@RoleID,'Y'
			END
END
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID  
GO 
------------------------------End------------------------------------------ 
     
                     
                

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=67
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=68
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=70
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=71
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=72
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=72
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=73
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=74
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=75
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=76
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=77
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=78
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=79
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=80
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=81
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=82
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=83
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=84
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=85
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=86
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=87
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=88
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=89
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=90
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=91
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=92
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=93
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=94
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=95
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=96
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=97
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=98
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=99
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=100
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=101
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=102
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=103
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=104
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=105
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=106
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
declare @metadataid2 BIGINT
declare @metadataid3 BIGINT
set @orgid=107
select  @metadataid= MetaDataID from MetaData where DisplayText='All' and Domain='Preference' and Code='All'
select  @metadataid1= MetaDataID from MetaData where DisplayText='STAT' and Domain='Preference'and Code='STAT'
select  @metadataid2= MetaDataID from MetaData where DisplayText='Retest' and Domain='TestType' and Code='Retest'
select  @metadataid3= MetaDataID from MetaData where DisplayText='Reflexwithnewsample' and Domain='TestType'and Code='Reflexwithnewsample'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='All' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','All')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='STAT' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','STAT')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Reflexwithnewsample' and MetadataID=@MetaDataID3 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid3,@orgid,'en-GB','Reflexwithnewsample')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Recollect' and MetadataID=@MetaDataID2 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid2,@orgid,'en-GB','Recollect')
end 



IF NOT EXISTS (select 1 from MetaData where DisplayText='Draft' and Code='Draft' )
begin
insert into MetaData (Domain,Code,DisplayText,LangCode,ParentID)
values('InvoiceType','Draft','Draft','en-GB',0)
end
IF NOT EXISTS (select 1 from MetaData where DisplayText='Orginal' and Code='Orginal')
begin
insert into MetaData (Domain,Code,DisplayText,LangCode,ParentID)
values('InvoiceType','Orginal','Orginal','en-GB',0)
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=67
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=68
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=69
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=70
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=71
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end



declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=72
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=73
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=74
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=75
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=76
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=77
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=78
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=79
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=80
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=81
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=82
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=83
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=84
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=85
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=86
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=87
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=88
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=89
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=90
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=91
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=92
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=93
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=94
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=95
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=96
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=97
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=98
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=99
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=100
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end


declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=101
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=102
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=103
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=104
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=105
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=106
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end

declare @orgid BIGINT
declare @metadataid BIGINT
declare @metadataid1 BIGINT
set @orgid=107
select  @metadataid= MetaDataID from MetaData where DisplayText='Orginal' and Domain='InvoiceType' and Code='Orginal'
select  @metadataid1= MetaDataID from MetaData where DisplayText='Draft' and Domain='InvoiceType'and Code='Draft'

IF NOT EXISTS (select 1 from MetaDataOrgMapping where DisplayText='Orginal' and MetadataID=@metadataid and OrgID=@OrgID )
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid,@orgid,'en-GB','Orginal')
end
if not exists (select 1 from MetaDataOrgMapping where DisplayText='Draft' and MetadataID=@metadataid1 and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText)
values(@metadataid1,@orgid,'en-GB','Draft')
end
----------------1st Advance Payment------------------
GO
IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageName='RollingAdvanceClientDetails')
BEGIN
INSERT into Pages(PageID,PageName,PageURL) values((select MAX(PageID) from Pages)+1,'RollingAdvanceClientDetails','/Reports/RollingAdvanceClientDetails.aspx')
END
GO
Declare @PageID bigint
select @PageID = PageID from Pages where PageName='RollingAdvanceClientDetails'

IF NOT EXISTS(SELECT ReportID FROM ReportMaster WHERE ReportDisplayText='Rolling Advance Client Summary')
BEGIN
INSERT INTO ReportMaster (ReportID
,ReportDisplayText
,ReportPath
,RedirectURL
,ReportGroupID
,CreatedBy
,CreatedAt
,PageID
)
SELECT MAX(ReportId)+1,'Rolling Advance Client Summary','','../Reports/RollingAdvanceClientDetails.aspx',5,1,GETDATE(),@PageID
 from ReportMaster
END
GO
DECLARE @ReportId bigint
SELECT @ReportId = ReportId from ReportMaster where ReportDisplayText='Rolling Advance Client Summary'
DECLARE @RoleID BIGINT
SELECT @RoleID=RoleID from Role where RoleName='Credit Controller' and OrgID=76

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,76,'Y'


----------------------------------------------------
--------------2nd Advance Payment-----------
DECLARE @orgid bigint

DECLARE @ReportId bigint
DECLARE @RoleID BIGINT

set @orgid=76

SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='Rolling Advance Client Summary'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Sr Credit Controller' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END
----------------------------------------------------------------------------------------------

SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='Rolling Advance Client Summary'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Credit Controller' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END
-------------------------------------------------------------------------------------------------------

SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='Rolling Advance Client Summary'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Administrator' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END

----------------------------------------------------------------------------------------------


SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='AdvanceCollectionRefund'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Sr Credit Controller' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END
-----------------------------------------------------------------------------------------------


SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='AdvanceCollectionRefund'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Credit Controller' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END
------------------------------------------------------------------------------------------

SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='AdvanceCollectionRefund'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Administrator' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN

INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END
-------------------------------------------------------------------------------------------


SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='AdvanceClientPatient'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Sr Credit Controller' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN
INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END
-------------------------------------------------------------------------------------------

SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='AdvanceClientPatient'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Credit Controller' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN
INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END

--------------------------------------------------------------------------------------------


SELECT @ReportId = ReportId from ReportMaster WITH(NOLOCK) where ReportDisplayText='AdvanceClientPatient'
SELECT @RoleID=RoleID from Role WITH(NOLOCK) where RoleName='Administrator' and OrgID=@OrgID

IF NOT EXISTS(SELECT ReportID FROM ReportOrgMapping WITH(NOLOCK) WHERE ReportID=@ReportId and RoleID=@RoleID and OrgID=@OrgID)
BEGIN
INSERT INTO ReportOrgMapping 
(
ReportID
,RoleID
,OrgID
,IsMapped
)
SELECT @ReportId,@RoleID,@OrgID,'Y'
END

--------------------------------------------


IF NOT EXISTS (select 1 from DispatchRuleMaster where RuleId=1 and RuleType='Batch' )
begin
insert into DispatchRuleMaster (RuleType)
values( N'Batch')
end



IF NOT EXISTS (select 1 from DispatchRuleMaster where RuleId=2 and RuleType='Routine' )
begin
insert into DispatchRuleMaster (RuleType)
values( N'Routine')
end


IF NOT EXISTS (select 1 from DispatchRuleMaster where RuleId=3 and RuleType='STAT' )
begin
insert into DispatchRuleMaster (RuleType)
values( N'STAT')
end


IF NOT EXISTS (select 1 from DispatchRuleMaster where RuleId=4 and RuleType='OutSource')
begin
insert into DispatchRuleMaster (RuleType)
values(N'OutSource')
end


----- Insert scirpt for  Home Collection Cancelled Reports added by Thillai kapil.T
if  not exists (select 1 from Pages      where  PageName ='Home Collection Cancelled Reports3')
Begin
declare @pageid int
                  select  @pageid=MAX(PageID) +1   from Pages 
                  insert into Pages values (@pageid,'Home Collection Cancelled Reports','/Reports/HomecollectionCancelledReport.aspx',
                  null,null,null,null,null,'N')

  if not exists(select 1 from ReportMaster where ReportDisplayText ='Home Collection Cancelled Reports3')
  Begin
      declare @reportid int
          select  @reportid=MAX(reportid) +1   from ReportMaster  --where ReportDisplayText ='Home Collection Cancelled Reports'
          
          insert into ReportMaster values (@reportid,'Home Collection Cancelled Reports','../Reports/HomecollectionCancelledReport.aspx',
          '../Reports/HomecollectionCancelledReport.aspx',1,1,GETDATE(),null,null,@pageid,0)  
  
  
        if not exists(select 1 from ReportOrgMapping  where reportid=@reportid and OrgID=99)
      Begin
         declare  @roleid int
           select   @roleid= roleid  from role where      OrgID =99 and  RoleName ='Administrator'
 
             insert into  ReportOrgMapping(reportid,roleid,orgid)  values (@reportid,@roleid,99)
      End
  
End
End

-----------------------------ENd--------------------------------
-----------------Karkuzhali----------------------------------------------------------------------
Declare @OrgID bigint
Declare @RoleID bigint
select @RoleID =MAX(roleID)from Role
set @OrgID =69
If Not exists(select 1 from Role where RoleName ='Portal User' and OrgID =@OrgID )
begin
insert into role (RoleID ,RoleName ,Description ,OrgID )
select @RoleID +1,'Portal User','Portal Users',@OrgID 
End

-------------------------------------End---------------------------------------------------------
-----------------------Deployability Team Changes--------------------------------------------------
CREATE TABLE #TempOrgID (OrgID int)
INSERT INTO #TempOrgID
SELECT OrgID from Organization
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
SET @PageID=(SELECT MAX(pageid)+1 FROM Pages)

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Deployability/ManageMedicalHistory.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID,'Manage MedicalHistory','/Deployability/ManageMedicalHistory.aspx'
END
WHILE @MinValue <= @MaxValue 
BEGIN
SELECT @RoleID=RoleID FROM Role WHERE RoleName='Administrator' AND OrgID=@MinValue
IF EXISTS(SELECT OrgID FROM Organization WHERE OrgID=@MinValue) 
BEGIN
	IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Deployability/ManageMedicalHistory.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
		SELECT @MenuID,'Manage MedicalHistory',2,@MinValue,@PageID
	END
	IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Deployability/ManageMedicalHistory.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
		SELECT @MenuID,@RoleID,'Y'
	END
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 
GO



CREATE TABLE #TempOrgID (OrgID int)
INSERT INTO #TempOrgID
SELECT OrgID from Organization
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
SET @PageID=(SELECT MAX(pageid)+1 FROM Pages)

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Deployability/Interdependency.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID,'Manage InterDependence','/Deployability/Interdependency.aspx'
END
WHILE @MinValue <= @MaxValue 
BEGIN
SELECT @RoleID=RoleID FROM Role WHERE RoleName='Administrator' AND OrgID=@MinValue
IF EXISTS(SELECT OrgID FROM Organization WHERE OrgID=@MinValue) 
BEGIN
	IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Deployability/Interdependency.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
		SELECT @MenuID,'Manage InterDependence',2,@MinValue,@PageID
	END
	IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Deployability/Interdependency.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
		SELECT @MenuID,@RoleID,'Y'
	END
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 
GO

CREATE TABLE #TempOrgID (OrgID int)
INSERT INTO #TempOrgID
SELECT OrgID from Organization
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
SET @PageID=(SELECT MAX(pageid)+1 FROM Pages)

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Deployability/ManagePrinter.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID,'Manage Printer','/Deployability/ManagePrinter.aspx'
END
WHILE @MinValue <= @MaxValue 
BEGIN
SELECT @RoleID=RoleID FROM Role WHERE RoleName='Administrator' AND OrgID=@MinValue
IF EXISTS(SELECT OrgID FROM Organization WHERE OrgID=@MinValue) 
BEGIN
	IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Deployability/ManagePrinter.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
		SELECT @MenuID,'Manage Printer',2,@MinValue,@PageID
	END
	IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Deployability/ManagePrinter.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
		SELECT @MenuID,@RoleID,'Y'
	END
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 
GO
-----------------------------------------------------------End----------------------------------------------------


/***************************************************Ledger and Invoice Starts***************************************************************/
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/CreditDebitApproval.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Credit Debit Approval','/Ledger/CreditDebitApproval.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/CreditDebitApproval.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/CreditDebitApproval.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Credit Debit Approval',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/CreditDebitApproval.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/CreditDebitApproval.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
--------------------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/CreditDebitStatus.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'CreditDebit Status','/Ledger/CreditDebitStatus.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/CreditDebitStatus.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/CreditDebitStatus.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'CreditDebit Status',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/CreditDebitStatus.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/CreditDebitStatus.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END

--------------------------------------------------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ClientCreditDebit.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'CreditDebitEntry','/Ledger/ClientCreditDebit.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ClientCreditDebit.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ClientCreditDebit.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'CreditDebitEntry',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ClientCreditDebit.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ClientCreditDebit.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
-------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/CreditDebitRecommend.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'CreditDebitRecommend','/Ledger/CreditDebitRecommend.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/CreditDebitRecommend.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/CreditDebitRecommend.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'CreditDebitRecommend',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/CreditDebitRecommend.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/CreditDebitRecommend.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
-------------------------------------------------------------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ClientOutstandingPayment.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'My OutStanding','/Ledger/ClientOutstandingPayment.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ClientOutstandingPayment.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ClientOutstandingPayment.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'My OutStanding',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ClientOutstandingPayment.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ClientOutstandingPayment.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
------------------------------------------------------------------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ReceiptRecommend.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'ReceiptRecommend','/Ledger/ReceiptRecommend.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ReceiptRecommend.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ReceiptRecommend.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'ReceiptRecommend',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ReceiptRecommend.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ReceiptRecommend.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
---------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ClientMonthClosing.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'TSP MonthClosing','/Ledger/ClientMonthClosing.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ClientMonthClosing.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ClientMonthClosing.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'TSP MonthClosing',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ClientMonthClosing.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ClientMonthClosing.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ClientOutstanding.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'TSP Outstanding','/Ledger/ClientOutstanding.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ClientOutstanding.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ClientOutstanding.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'TSP Outstanding',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ClientOutstanding.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ClientOutstanding.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END

---------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ReceiptStatus.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'TSP Receipt Status','/Ledger/ReceiptStatus.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ReceiptStatus.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ReceiptStatus.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'TSP Receipt Status',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ReceiptStatus.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ReceiptStatus.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
----------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/AdvancePaymentApproval.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Advance Approval','/Ledger/AdvancePaymentApproval.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/AdvancePaymentApproval.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/AdvancePaymentApproval.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Advance Approval',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/AdvancePaymentApproval.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/AdvancePaymentApproval.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
---------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/InvoiceAdvancePayment.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Advance Payment','/Ledger/InvoiceAdvancePayment.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/InvoiceAdvancePayment.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/InvoiceAdvancePayment.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Advance Payment',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/InvoiceAdvancePayment.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/InvoiceAdvancePayment.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END

-------------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/AdvancePaymentRecommend.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Advance Recommendation','/Ledger/AdvancePaymentRecommend.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/AdvancePaymentRecommend.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/AdvancePaymentRecommend.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Advance Recommendation',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/AdvancePaymentRecommend.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/AdvancePaymentRecommend.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
----------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/InvoiceLedgerClientOutStanding.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Invoice OutStanding','/Ledger/InvoiceLedgerClientOutStanding.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/InvoiceLedgerClientOutStanding.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/InvoiceLedgerClientOutStanding.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Invoice OutStanding',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/InvoiceLedgerClientOutStanding.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/InvoiceLedgerClientOutStanding.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
-----------------------------------------------------------------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/InvoicePayment.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Invoice Payment','/Ledger/InvoicePayment.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/InvoicePayment.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/InvoicePayment.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Invoice Payment',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/InvoicePayment.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/InvoicePayment.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END
--------------------------------------------------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/InvoiceLedgerClosing.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Ledger Closing','/Ledger/InvoiceLedgerClosing.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/InvoiceLedgerClosing.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/InvoiceLedgerClosing.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Ledger Closing',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/InvoiceLedgerClosing.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/InvoiceLedgerClosing.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END

---------------------------------------------------------------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=109

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Credit Controller'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Ledger/ReceiptApproval.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Receipt Approval','/Ledger/ReceiptApproval.aspx'
  set @PageID=@PageID+1;
END
else
Begin
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Ledger/ReceiptApproval.aspx'
 --select @PageID as PageId,'else'
End

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Ledger/ReceiptApproval.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Receipt Approval',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
Begin
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Ledger/ReceiptApproval.aspx' AND MM.OrgId=@OrgID;
    --select @MenuID as MenuId,'else'
End

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Ledger/ReceiptApproval.aspx' AND MM.OrgId=@OrgID and RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
END


/***************************************************Ledger and Invoice Ends***************************************************************/


--------------------PMS--------------------------
 SET IDENTITY_INSERT [dbo].[PMSCategories] ON
INSERT [dbo].[PMSCategories] ([ID], [Name], [SeqNumber], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (1, N'Support Management', 1, 1, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSCategories] ([ID], [Name], [SeqNumber], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (2, N'Pro-Active Management', 2, 1, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSCategories] ([ID], [Name], [SeqNumber], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (3, N'Master Maintenance', 3, 1, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSCategories] ([ID], [Name], [SeqNumber], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (4, N'Report Management (MIS)', 4, 1, NULL, NULL, NULL, NULL)
SET IDENTITY_INSERT [dbo].[PMSCategories] OFF

 SET IDENTITY_INSERT [dbo].[PMSFolders] ON
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (1, N'Workflow Tasks', 1, N'Create or close workflow (Sample collection, Validation & Approval) related tasks', 1, 1, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (2, N'TAT Audit', 2, N'Audit tat related activites', 1, 1, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (3, N'Sample Transfer', 1, N'Manage sample transfer related activites', 2, 0, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (4, N'Visit Audit', 2, N'Audit visit related activites', 2, 0, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (5, N'Org to Org Movement', 3, N'Move data from one org to another org', 1, 1, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (6, N'Accession Reports', 4, N'This will provide accession related MIS reports', 1, 0, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (7, N'Notifications', 1, N'Manage notification related activites', 3, 1, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (9, N'Analyzer Audit', 2, N'Audit analyzer related activites', 3, 0, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (12, N'Transaction Amendment', 1, N'Cancel visit, force close long pending visits', 5, 1, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (10, N'Notifications Audit', 2, N'Audit notification related activites', 4, 0, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (11, N'Workflow Task Audit', 2, N'Audit workflow task related activites', 5, 0, 67, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSFolders] ([ID], [Name], [ParentID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (13, N'TAT', 3, N'Add TAT for given test', 2, 1, 67, NULL, NULL, NULL, NULL)
SET IDENTITY_INSERT [dbo].[PMSFolders] OFF


SET IDENTITY_INSERT [dbo].[PMSProcedureParameterQueries] ON

INSERT [dbo].[PMSProcedureParameterQueries] ([ID], [QueryName], [Query], [DisplayType], [QueryType], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [InputType]) VALUES (1, NULL, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, N'txt')
INSERT [dbo].[PMSProcedureParameterQueries] ([ID], [QueryName], [Query], [DisplayType], [QueryType], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [InputType]) VALUES (2, N'Ppmsgetorganization', N'Ppmsgetorganization', NULL, N'SP', 1, NULL, NULL, NULL, NULL, N'ddl')
INSERT [dbo].[PMSProcedureParameterQueries] ([ID], [QueryName], [Query], [DisplayType], [QueryType], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [InputType]) VALUES (3, NULL, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, N'date')
INSERT [dbo].[PMSProcedureParameterQueries] ([ID], [QueryName], [Query], [DisplayType], [QueryType], [IsActive], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [InputType]) VALUES (4, N'PpmsgetAllLocations', N'PpmsgetAllLocations', NULL, N'SP', 1, NULL, NULL, NULL, NULL, N'ddl')
SET IDENTITY_INSERT [dbo].[PMSProcedureParameterQueries] OFF

SET IDENTITY_INSERT [dbo].[PMSProcedureParameters] ON
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (1, N'Ppmscancelbillforvisit', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 4, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (2, N'Ppmscancelbillforvisit', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 4, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (3, N'Ppmsinsertapprovaltask', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 5, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (4, N'Ppmsinsertapprovaltask', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 5, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (5, N'Ppmsinsertcollectsampletask', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 6, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (6, N'Ppmsinsertcollectsampletask', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 6, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (7, N'PpmsinsertapprovetaskfromValidate', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 7, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (8, N'PpmsinsertapprovetaskfromValidate', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 7, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (9, N'Ppmsregeneratebill', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 8, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (10, N'Ppmsregeneratebill', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 8, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (11, N'Ppmsregeneratereport', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 9, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (12, N'Ppmsregeneratereport', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 9, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (13, N'Ppmsrepushreceiptforclient', N'pClientCode', N'Client Code', NULL, NULL, NULL, NULL, NULL, 10, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (14, N'Ppmsrepushreceiptforclient', N'pFromDate', N'From Date', NULL, NULL, NULL, NULL, NULL, 10, 3, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (15, N'Ppmsrepushreceiptforclient', N'pToDate', N'To Date', NULL, NULL, NULL, NULL, NULL, 10, 3, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (16, N'Ppmsrepushreceiptforclient', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 10, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (17, N'Ppmsrepushreportforclient', N'pClientCode', N'Client Code', NULL, NULL, NULL, NULL, NULL, 11, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (18, N'Ppmsrepushreportforclient', N'pFromDate', N'From Date', NULL, NULL, NULL, NULL, NULL, 11, 3, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (19, N'Ppmsrepushreportforclient', N'pToDate', N'To Date', NULL, NULL, NULL, NULL, NULL, 11, 3, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (20, N'Ppmsrepushreportforclient', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 11, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (29, N'Ppmsinsertnewtcode', N'pTCode', N'Test Code', NULL, NULL, NULL, NULL, NULL, 14, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (30, N'Ppmsinsertnewtcode', N'pFromOrgID', N'From Organization', NULL, NULL, NULL, NULL, NULL, 14, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (31, N'Ppmsinsertnewtcode', N'pToOrgID', N'To Organization', NULL, NULL, NULL, NULL, NULL, 14, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (21, N'Ppmsaddreflexforvisit', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 12, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (22, N'Ppmsaddreflexforvisit', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 12, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (23, N'Ppmsaddreflexforvisit', N'pReflexCode', N'Reflex Tcode', NULL, NULL, NULL, NULL, NULL, 12, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (24, N'Ppmsupdateprocessinglocationforvisit', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 13, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (25, N'Ppmsupdateprocessinglocationforvisit', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 13, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (26, N'Ppmsupdateprocessinglocationforvisit', N'pTestCode', N'Test Code', NULL, NULL, NULL, NULL, NULL, 13, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (27, N'Ppmsupdateprocessinglocationforvisit', N'pFromLocationID', N'From Location', NULL, NULL, NULL, NULL, NULL, 13, 4, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (28, N'Ppmsupdateprocessinglocationforvisit', N'pToLocationID', N'To Location', NULL, NULL, NULL, NULL, NULL, 13, 4, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (35, N'pPMSGetWithoutTATDetails', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 15, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (36, N'pPMSInsertTATDetails', N'pTcode', N'TCODE', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (37, N'pPMSInsertTATDetails', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 16, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (38, N'pPMSInsertTATDetails', N'pTATDAYS', N'Test Processing Days (DAILY - 1,2,3,4,5,6 WEEKLY - 1 or 2 or 3 or 4 or 5 or 6)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (39, N'pPMSInsertTATDetails', N'pProcessingHRS', N'Test Processing Time (Hours)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (40, N'pPMSInsertTATDetails', N'pLabStart', N'Lab Start Time (Hours)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (41, N'pPMSInsertTATDetails', N'pLabEnd', N'Lab End Time (Hours)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (42, N'pPMSInsertTATDetails', N'pReportTime', N'Early Reporting Time (Hours)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (43, N'pPMSInsertTATDetails', N'pRBType', N'Processing Type (R - Routine B - Batch)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (44, N'pPMSInsertTATDetails', N'pSchedule', N'Test Schedule (DAILY, WEEKLY)', NULL, NULL, NULL, NULL, NULL, 16, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (45, N'pPMSCopyTATBetweenOrgs', N'pCodeName', N'TCODE', NULL, NULL, NULL, NULL, NULL, 17, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (46, N'pPMSCopyTATBetweenOrgs', N'pFromOrgID', N'From Organization', NULL, NULL, NULL, NULL, NULL, 17, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (47, N'pPMSCopyTATBetweenOrgs', N'pToOrgID', N'To Organization', NULL, NULL, NULL, NULL, NULL, 17, 2, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (48, N'Ppmsinsertvalidatetask', N'pVisitNumber', N'Visit Number', NULL, NULL, NULL, NULL, NULL, 18, 1, 0)
INSERT [dbo].[PMSProcedureParameters] ([ID], [ProcedureName], [ParamName], [DisplayName], [DefaultValue], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt], [ProcedureID], [ParamQueryID], [Optional]) VALUES (49, N'Ppmsinsertvalidatetask', N'pOrgID', N'Organization', NULL, NULL, NULL, NULL, NULL, 18, 2, 0)
SET IDENTITY_INSERT [dbo].[PMSProcedureParameters] OFF


SET IDENTITY_INSERT [dbo].[PMSProcedures] ON
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (12, N'Add Reflex for Visit', N'Ppmsaddreflexforvisit', 8, N'This will Add Reflex Code for a Visit', 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (4, N'Visit Cancellation', N'Ppmscancelbillforvisit', 12, N'This will cancel the visit & amount will be Refunded', 1, 1, NULL, 13534, CAST(0x0000A4ED0131A0BE AS DateTime), NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (5, N'Approve Task Creation(From Completed)', N'Ppmsinsertapprovaltask', 1, N'This will Create a Approve Task for a Visit', 3, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (6, N'CollectSample Task Creation', N'Ppmsinsertcollectsampletask', 1, N'This will Create a CollectSample Task for a Visit', 4, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (7, N'Approve Task Creation(From Validate)', N'PpmsinsertapprovetaskfromValidate', 1, N'This will Create a Approve Task for a Visit', 5, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (8, N'Regenerate Bill', N'Ppmsregeneratebill', 7, N'This will Regenerate the Bill for a Visit', 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (9, N'Regenerate Report', N'Ppmsregeneratereport', 7, N'This will Regenerate the Report for a Visit', 2, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (14, N'Copy Tcode from One Org to Another Org', N'Ppmsinsertnewtcode', 5, N'This will Copy a Tcode from one Org to another Org', 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (13, N'Change Processing Location of Given Test', N'Ppmsupdateprocessinglocationforvisit', 3, N'This will Update the given ProcessingLocation for a Visit', 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (15, N'Tests Without TAT Configuration', N'pPMSGetWithoutTATDetails', 2, N'This will provide details of tests which don''t have TAT', 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (16, N'Add TAT for given test', N'pPMSInsertTATDetails', 13, N'This will add TAT for given test', 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (17, N'Copy TAT from one org to another org', N'pPMSCopyTATBetweenOrgs', 5, N'This will copy TAT from one org to another org', 2, 1, NULL, NULL, NULL, NULL, NULL)
INSERT [dbo].[PMSProcedures] ([ID], [Name], [ProcedureName], [FolderID], [Description], [SeqNumber], [IsActive], [OrgID], [CreatedBy], [CreatedAt], [ModifiedBy], [ModifiedAt]) VALUES (18, N'ValidateTask Creation', N'Ppmsinsertvalidatetask', 1, N'This will Create a Validate Task for a Visit', 5, 1, NULL, NULL, NULL, NULL, NULL)
SET IDENTITY_INSERT [dbo].[PMSProcedures] OFF

--------------PMS END-----------------


---------------------------------------Ledger Narration Starts-------------------------------------------------------------
 SET IDENTITY_INSERT [dbo].[CreditDebitNarration] ON
 INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (1, N'Bank Charges', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (2, N'Cheque Updation Reversal ', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (3, N'Cheque Dishonor Penalties', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (4, N'Credit Limit Non-Adherence Penalty', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (5, N'Data Handling Charges', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (6, N'Internal Debits', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (7, N'Lead Mismanagement Recovery', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (8, N'Material Expenses', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (9, N'Non Compliance Debits', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (10, N'Out Lab Billing', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (11, N'Reversible Compliance Debits', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (12, N'Training Debits', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (13, N'TDS Deduction', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (14, N'Wellness Reversible Debits', N'D', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (16, N'Air Cargo Reimbursement', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (17, N'Camp Credits', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (18, N'Excess Billing', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (19, N'Refunds – Cancelled', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (20, N'USB Credits', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (21, N'Billing Error', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (22, N'Training Credits', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (23, N'TDS Credits', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (24, N'Excess EMD Debits', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (25, N'Reversible Compliance Credit', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (26, N'Wellness Reversible Credit', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (27, N'DSA Incentives', N'C', N'Active')

INSERT [dbo].[CreditDebitNarration] ([Id], [Narration], [Type], [Status]) VALUES (28, N'DSA Advance for Prepaid', N'C', N'Active')
SET IDENTITY_INSERT [dbo].[CreditDebitNarration] OFF

---------------------------------------Ledger Narration Ends-------------------------------------------------------------
---------------------------------------------------------Waters----------------------------------------------------------
CREATE TABLE #TempOrgID (OrgID int)
INSERT INTO #TempOrgID
SELECT OrgID from Organization
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster) 
SET @PageID=(SELECT MAX(pageid)+1 FROM Pages)

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Waters/QuotationMaster.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID,'Quotation Master','/Waters/QuotationMaster.aspx'
END
WHILE @MinValue <= @MaxValue 
BEGIN
SELECT @RoleID=RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@MinValue
IF EXISTS(SELECT OrgID FROM Organization WHERE OrgID=@MinValue) 
BEGIN
	IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Waters/QuotationMaster.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
		SELECT @MenuID,'Quotation Master',0,@MinValue,@PageID
	END
	IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Waters/QuotationMaster.aspx' AND MM.OrgId=@MinValue)
	BEGIN
		INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
		SELECT @MenuID,@RoleID,'Y'
	END
END
SET @MinValue = @MinValue + 1 
SET @MenuID = @MenuID + 1 
END
drop table #TempOrgID 
GO

/*************Slide Barcode Insert added By Arivalagan.kk**************/


IF NOT EXISTS (SELECT 1 FROM dbo.BarcodeCategories bc WHERE bc.Code='SlideBarcode')
BEGIN
INSERT INTO dbo.BarcodeCategories
(
    --Id - this column value is auto-generated
    dbo.BarcodeCategories.Name,
    dbo.BarcodeCategories.Code
)
VALUES
(
    -- Id - bigint
    N'Slide Barcode', -- Name - nvarchar
    N'SlideBarcode' -- Code - nvarchar
)
END
IF NOT EXISTS (SELECT 1 FROM dbo.BarcodePlaceHolders bph WHERE bph.Name ='Stain Type' AND  bph.Name ='Slide Prepared Date')
BEGIN
INSERT INTO dbo.BarcodePlaceHolders
(
    --Id - this column value is auto-generated
    dbo.BarcodePlaceHolders.Name,
    dbo.BarcodePlaceHolders.Code
)
SELECT -- Id - bigint
    N'Stain Type', -- Name - nvarchar
    N'TestStatus' -- Code - nvarchar
UNION ALL
SELECT -- Id - bigint
    N'Slide Prepared Date', -- Name - nvarchar
    N'CollectedDateTime' -- Code - nvarchar
END
IF NOT EXISTS (SELECT 1 FROM dbo.ActionMaster am WHERE am.ActionCode='Print_SlideBarcode_SampleSearch')
BEGIN
INSERT INTO dbo.ActionMaster
(
    dbo.ActionMaster.ActionID,
    dbo.ActionMaster.ActionName,
    dbo.ActionMaster.QueryString,
    dbo.ActionMaster.ActionCode,
    dbo.ActionMaster.IsShareable,
    dbo.ActionMaster.LanguageCode
)
VALUES
(
    (SELECT MAX(am.ActionID)+1 FROM dbo.ActionMaster am), -- ActionID - int
    N'Print Slide Barcode', -- ActionName - nvarchar
    N'../Admin/PrintBarcode.aspx?visitId={PatientVisitID}&sampleId={SampleID}&guId={GuId}&orgId={OrgID}&LID={LoginID}&ILocationID={LocID}&IsReprint={PrintAgain}&categoryCode={CategoryCode}&Ispopup=Y', -- QueryString - nvarchar
    N'Print_SlideBarcode_SampleSearch', -- ActionCode - nvarchar
    N'N', -- IsShareable - nchar
    N'en-GB' -- LanguageCode - nvarchar
)

INSERT INTO dbo.ActionRoleMapping
(
    ActionID,
    RoleID,
    RedirectPageID,
    SearchTypeID,
    IsMapped
    --ID - this column value is auto-generated
)
VALUES
(
    (SELECT MAX(am.ActionID) FROM dbo.ActionMaster am), -- ActionID - int
    3494, -- RoleID - bigint
    465, -- RedirectPageID - bigint
    42, -- SearchTypeID - int
    N'Y' -- IsMapped - nchar
      -- ID - bigint
)

END
/*************Slide Barcode Insert**************/


-----------------Menu scripts for ChangeCollectSampleDate 77 org--------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=77

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Change Collect Sample Date','/Admin/ChangeCollectSampleDate.aspx'
  set @PageID=@PageID+1;
END
else
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx'

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Change Collect Sample Date',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID;


IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID and rm.RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
 
 END
 ------------------------------------------


 
-----------------Menu scripts for ChangeCollectSampleDate 80 org--------------------


SET @OrgID=80

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Change Collect Sample Date','/Admin/ChangeCollectSampleDate.aspx'
  set @PageID=@PageID+1;
END
else
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx'

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Change Collect Sample Date',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID;


IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID and rm.RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
 
 END
 ------------------------------------------

 
-----------------Menu scripts for ChangeCollectSampleDate 159 org--------------------


SET @OrgID=159

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Change Collect Sample Date','/Admin/ChangeCollectSampleDate.aspx'
  set @PageID=@PageID+1;
END
else
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx'

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Change Collect Sample Date',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID;


IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID and rm.RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
 
 END
 ------------------------------------------

 
-----------------Menu scripts for ChangeCollectSampleDate 162 org --------------------


SET @OrgID=162

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Change Collect Sample Date','/Admin/ChangeCollectSampleDate.aspx'
  set @PageID=@PageID+1;
END
else
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx'

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Change Collect Sample Date',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID;


IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID and rm.RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
 
 END
 ------------------------------------------

 
-----------------Menu scripts for ChangeCollectSampleDate 161 org--------------------


SET @OrgID=161

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
  SELECT @PageID+1,'Change Collect Sample Date','/Admin/ChangeCollectSampleDate.aspx'
  set @PageID=@PageID+1;
END
else
 SELECT @PageID=PageID FROM Pages WHERE PageURL ='/Admin/ChangeCollectSampleDate.aspx'

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID)
BEGIN
 INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
 SELECT @MenuID+1,'Change Collect Sample Date',0,@OrgID,@PageID
 set @MenuID=@MenuID+1;
END
else
 SELECT @MenuID=MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID;


IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID 
WHERE P.PageURL='/Admin/ChangeCollectSampleDate.aspx' AND MM.OrgId=@OrgID and rm.RoleID=@RoleID)
BEGIN
 INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
 SELECT @MenuID,@RoleID,'Y'
 
 END
 ------------------Create New Role for Director------------------------


 
	set @orgid=77
  IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Director' and OrgID=@orgid)
  BEGIN
 
   INSERT INTO Role (RoleID,RoleName,Description,OrgID)
	select max(roleid)+1,'Director','Director',@orgid from role
	 
  END


  Set @RoleID=(select roleID from role where rolename='Director' and orgID=@orgid)
  select @pageID= PageID from Pages where PageURL ='/Phlebotomist/Home.aspx'
 


	select @RoleID = RoleID from Role where RoleName='Director'
 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
 BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
  
  END	
   

 IF NOT EXISTS (select 1 from TaskActionOrgMapping where TaskActionID=62  and RoleID in(SELECT RoleID FROM Role WHERE RoleName='Director') and OrgID=@orgid)
BEGIN
   INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)
   SELECT 62,@RoleID,@orgid
 
END
 
 ----------------------------------------------

  ------------------Create New Role for Director------------------------


	set @orgid=80
  IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Director' and OrgID=@orgid)
  BEGIN
 
   INSERT INTO Role (RoleID,RoleName,Description,OrgID)
	select max(roleid)+1,'Director','Director',@orgid from role
	 
  END


  Set @RoleID=(select roleID from role where rolename='Director' and orgID=@orgid)
  select @pageID= PageID from Pages where PageURL ='/Phlebotomist/Home.aspx'
 


	select @RoleID = RoleID from Role where RoleName='Director'
 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
 BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
  
  END	
   

 IF NOT EXISTS (select 1 from TaskActionOrgMapping where TaskActionID=62  and RoleID in(SELECT RoleID FROM Role WHERE RoleName='Director') and OrgID=@orgid)
BEGIN
   INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)
   SELECT 62,@RoleID,@orgid
 
END
  ------------------Create New Role for Director------------------------


 
	set @orgid=159
  IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Director' and OrgID=@orgid)
  BEGIN
 
   INSERT INTO Role (RoleID,RoleName,Description,OrgID)
	select max(roleid)+1,'Director','Director',@orgid from role
	 
  END


  Set @RoleID=(select roleID from role where rolename='Director' and orgID=@orgid)
  select @pageID= PageID from Pages where PageURL ='/Phlebotomist/Home.aspx'
 


	select @RoleID = RoleID from Role where RoleName='Director'
 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
 BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
  
  END	
   

 IF NOT EXISTS (select 1 from TaskActionOrgMapping where TaskActionID=62  and RoleID in(SELECT RoleID FROM Role WHERE RoleName='Director') and OrgID=@orgid)
BEGIN
   INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)
   SELECT 62,@RoleID,@orgid
 
END
  ------------------Create New Role for Director------------------------


    
	set @orgid=162
  IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Director' and OrgID=@orgid)
  BEGIN
 
   INSERT INTO Role (RoleID,RoleName,Description,OrgID)
	select max(roleid)+1,'Director','Director',@orgid from role
	 
  END


  Set @RoleID=(select roleID from role where rolename='Director' and orgID=@orgid)
  select @pageID= PageID from Pages where PageURL ='/Phlebotomist/Home.aspx'
 


	select @RoleID = RoleID from Role where RoleName='Director'
 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
 BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
  
  END	
   

 IF NOT EXISTS (select 1 from TaskActionOrgMapping where TaskActionID=62  and RoleID in(SELECT RoleID FROM Role WHERE RoleName='Director') and OrgID=@orgid)
BEGIN
   INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)
   SELECT 62,@RoleID,@orgid
 
END
  ------------------Create New Role for Director------------------------



	set @orgid=161
  IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Director' and OrgID=@orgid)
  BEGIN
 
   INSERT INTO Role (RoleID,RoleName,Description,OrgID)
	select max(roleid)+1,'Director','Director',@orgid from role
	 
  END


  Set @RoleID=(select roleID from role where rolename='Director' and orgID=@orgid)
  select @pageID= PageID from Pages where PageURL ='/Phlebotomist/Home.aspx'
 


	select @RoleID = RoleID from Role where RoleName='Director'
 IF NOT EXISTS(SELECT RoleID FROM PageMapping WHERE RoleID=@RoleID)
 BEGIN
   insert into PageMapping(RoleId,PageID,SeqNo) values(@RoleID,@pageID,1)
  
  END	
   

 IF NOT EXISTS (select 1 from TaskActionOrgMapping where TaskActionID=62  and RoleID in(SELECT RoleID FROM Role WHERE RoleName='Director') and OrgID=@orgid)
BEGIN
   INSERT INTO TaskActionOrgMapping (TaskActionID,RoleID,OrgID)
   SELECT 62,@RoleID,@orgid
 
END
 --------------------org ot org sample transfer-----------------------

 INSERT INTO trustedorgdetails (LoggedOrgID,SharingOrgID,ShareTypeID)VALUES (162,161,1)

 INSERT INTO trustedorgdetails (LoggedOrgID,SharingOrgID,ShareTypeID)VALUES (161,162,1)

 INSERT INTO trustedorgdetails (LoggedOrgID,SharingOrgID,ShareTypeID)VALUES (159,77,1)
 INSERT INTO trustedorgdetails (LoggedOrgID,SharingOrgID,ShareTypeID)VALUES (77,159,1)
 -------------------------------------------------------------------------------------------------

DECLARE @configkeyid BIGINT
SET @configkeyid= (select max(ConfigKeyID+1) FROM configkeymaster)

IF  NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='IGEN_BatchWiseEndResult')
BEGIN

SELECT @configkeyid
INSERT INTO dbo.ConfigKeyMaster        
VALUES  (@configkeyid , -- ConfigKeyID - bigint
         N'IGEN_BatchWiseEndResult' , -- ConfigKey - nvarchar(50)
         N'Do you want to print for only 1 day' , -- DisplayText - nvarchar(max)
         N'N' , -- IsInternal - nchar(1)
         NULL,NULL,NULL,NULL
        )
INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  77 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  80 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  159 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  161 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  162 ,  NULL , NULL,NULL,NULL,NULL )
 
END

--------------------------------------------------------------------------------------

--SELECT * FROM dbo.ConfigKeyMaster ORDER BY  ConfigKeyID desc
--SELECT * FROM dbo.ConfigOrgMaster ORDER BY  ConfigKeyID DESC

SET @configkeyid= (select max(ConfigKeyID+1) FROM configkeymaster)

IF  NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='Invoiceforcash')
BEGIN


INSERT INTO dbo.ConfigKeyMaster        
VALUES  (@configkeyid , -- ConfigKeyID - bigint
         N'Invoiceforcash' , -- ConfigKey - nvarchar(50)
         N'Do you want to collect due  for credit client' , -- DisplayText - nvarchar(max)
         N'N' , -- IsInternal - nchar(1)
         NULL,NULL,NULL,NULL
        )
INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  77 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  80 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  159 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  161 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  162 ,  NULL , NULL,NULL,NULL,NULL )
 
END
----------------------------------------------------------------------


--SELECT * FROM dbo.ConfigKeyMaster ORDER BY  ConfigKeyID desc
--SELECT * FROM dbo.ConfigOrgMaster ORDER BY  ConfigKeyID DESC

SET @configkeyid= (select max(ConfigKeyID+1) FROM configkeymaster)
IF  NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='IsDisabledDiscount')
BEGIN


INSERT INTO dbo.ConfigKeyMaster        
VALUES  (@configkeyid , -- ConfigKeyID - bigint
         N'IsDisabledDiscount' , -- ConfigKey - nvarchar(50)
         N'Do you want disable discount if it is unchecked for cash client' , -- DisplayText - nvarchar(max)
         N'N' , -- IsInternal - nchar(1)
         NULL,NULL,NULL,NULL
        )
INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  77 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  80 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  159 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  161 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  162 ,  NULL , NULL,NULL,NULL,NULL )
 
END
--------------------------------------------------------------         
SET @configkeyid= (select max(ConfigKeyID+1) FROM configkeymaster)


IF  NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='collectcashforcreditclient')
BEGIN


INSERT INTO dbo.ConfigKeyMaster        
VALUES  (@configkeyid , -- ConfigKeyID - bigint
         N'collectcashforcreditclient' , -- ConfigKey - nvarchar(50)
         N'Do you want to collect cash for credit client' , -- DisplayText - nvarchar(max)
         N'N' , -- IsInternal - nchar(1)
         NULL,NULL,NULL,NULL
        )
INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  77 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  80 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  159 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  161 ,  NULL , NULL,NULL,NULL,NULL )

INSERT INTO dbo.ConfigOrgMaster
VALUES  (@configkeyid ,   N'Y' ,  162 ,  NULL , NULL,NULL,NULL,NULL )
 
END


------------------------orgid 159 Sample rejection sms--------------
insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(58,5035,10,1,'Reject','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(6,5035,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(7,5035,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,5038,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,5038,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,5041,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,5041,10,1,'Recollect','Notify',NULL,'N')

insert into PageContext (PageID,ButtonName,ButtionValue) values(449,'btnOK','OK')

----------------------orgid 77--------------------------

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(58,3358,10,1,'Reject','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(6,3358,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(7,3358,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,3361,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,3361,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,3364,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,3364,10,1,'Recollect','Notify',NULL,'N')

-------------------------------------------

----------------------orgid 80--------------------------

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(58,3407,10,1,'Reject','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(6,3407,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(7,3407,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,3410,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,3410,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,3412,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,3412,10,1,'Recollect','Notify',NULL,'N')




----------------------orgid 161--------------------------

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(58,5081,10,1,'Reject','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(6,5081,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(7,5081,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,5084,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,5084,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,5087,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,5087,10,1,'Recollect','Notify',NULL,'N')


----------------------orgid 162--------------------------

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(58,5118,10,1,'Reject','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(6,5118,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(7,5118,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,5121,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,5121,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(11,5124,10,1,'Recollect','Notify',NULL,'N')

insert into PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,Description,IsAttachment)
values(9,5124,10,1,'Recollect','Notify',NULL,'N')
-------------------------------------


DECLARE @pOrgid INT =104
DECLARE @Maxroleid BIGINT=                (SELECT MAX(roleid+1) FROM role)
DECLARE @maxInvestigationStatusID BIGINT= (SELECT MAX(InvestigationStatusID+1) FROM InvestigationStatus )
DECLARE @maxtaskactionid BIGINT =         (SELECT MAX(TaskActionID+1) FROM dbo.TaskActions)
SET @configkeyid= (select max(ConfigKeyID+1) FROM configkeymaster)

INSERT INTO dbo.role                VALUES (@Maxroleid,'Revalidate','Revalidate',NULL,NULL,NULL,NULL,NULL,@pOrgid,NULL,'en-GB',NULL) 
INSERT INTO dbo.PageMapping         VALUES (@Maxroleid,452,NULL,NULL,NULL,NULL,1,NULL) 
INSERT INTO dbo.InvestigationStatus VALUES (@maxInvestigationStatusID,'Revalidate','Revalidate',NULL,'Revalidate',NULL,@maxInvestigationStatusID)
INSERT INTO dbo.InvStatusmapping    VALUES (@maxInvestigationStatusID,5,@pOrgid,1)
INSERT INTO dbo.InvStatusOrgMapping VALUES (@maxInvestigationStatusID,'Revalidate','en-GB',@pOrgid,'Revalidate',NULL,NULL,NULL,NULL)
INSERT INTO TaskEntityMap        VALUES('InvestigationStatus',12,@maxtaskactionid,@pOrgid,NULL)
INSERT INTO TaskEntityMap        VALUES('InvestigationStatus',17,@maxtaskactionid,@pOrgid,NULL)
INSERT INTO TaskEntityMap        VALUES('InvestigationStatus',21,@maxtaskactionid,@pOrgid,NULL)
INSERT INTO TaskEntityMap        VALUES('InvestigationStatus',27,@maxtaskactionid,@pOrgid,NULL)
INSERT INTO TaskEntityMap        VALUES('InvestigationStatus',35,@maxtaskactionid,@pOrgid,NULL)
INSERT INTO TaskEntityMap        VALUES('InvestigationStatus',62,@maxtaskactionid,@pOrgid,NULL)
INSERT INTO TaskActionOrgMapping VALUES (@maxtaskactionid,@Maxroleid,@pOrgid,NULL,NULL,NULL,NULL)
INSERT INTO dbo.TaskActions      VALUES (@maxtaskactionid,'ReApproval','~\Investigation\InvestigationApprovel.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}&Client=Y',
'Revalidate Investigation Result for {PatientName}({PatientNumber})(VisitNumber:{VisitNumber}',0,'ReApproval',0,1,'Y',
NULL,NULL,NULL,NULL,NULL,'en-GB',NULL)


IF  NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='Revalidate')
BEGIN

INSERT INTO dbo.ConfigKeyMaster VALUES  (@configkeyid , N'Revalidate' ,  N'Do you want to hide audit for client' , N'N' ,   NULL,NULL,NULL,NULL  )
INSERT INTO dbo.ConfigOrgMaster VALUES  (@configkeyid ,   N'Y' ,  @pOrgid ,  NULL , NULL,NULL,NULL,NULL )
 
END

/*************Slide Barcode Insert added By Arivalagan.kk**************/

IF NOT EXISTS (SELECT 1 FROM dbo.BarcodeCategories bc WHERE bc.Code='SlideBarcode')
BEGIN
INSERT INTO dbo.BarcodeCategories
(
    --Id - this column value is auto-generated
    dbo.BarcodeCategories.Name,
    dbo.BarcodeCategories.Code
)
VALUES
(
    -- Id - bigint
    N'Slide Barcode', -- Name - nvarchar
    N'SlideBarcode' -- Code - nvarchar
)
END
IF NOT EXISTS (SELECT 1 FROM dbo.BarcodePlaceHolders bph WHERE bph.Name ='Stain Type' AND  bph.Name ='Slide Prepared Date')
BEGIN
INSERT INTO dbo.BarcodePlaceHolders
(
    --Id - this column value is auto-generated
    dbo.BarcodePlaceHolders.Name,
    dbo.BarcodePlaceHolders.Code
)
SELECT -- Id - bigint
    N'Stain Type', -- Name - nvarchar
    N'TestStatus' -- Code - nvarchar
UNION ALL
SELECT -- Id - bigint
    N'Slide Prepared Date', -- Name - nvarchar
    N'CollectedDateTime' -- Code - nvarchar
END
IF NOT EXISTS (SELECT 1 FROM dbo.ActionMaster am WHERE am.ActionCode='Print_SlideBarcode_SampleSearch')
BEGIN
INSERT INTO dbo.ActionMaster
(
    dbo.ActionMaster.ActionID,
    dbo.ActionMaster.ActionName,
    dbo.ActionMaster.QueryString,
    dbo.ActionMaster.ActionCode,
    dbo.ActionMaster.IsShareable,
    dbo.ActionMaster.LanguageCode
)
VALUES
(
    (SELECT MAX(am.ActionID)+1 FROM dbo.ActionMaster am), -- ActionID - int
    N'Print Slide Barcode', -- ActionName - nvarchar
    N'../Admin/PrintBarcode.aspx?visitId={PatientVisitID}&sampleId={SampleID}&guId={GuId}&orgId={OrgID}&LID={LoginID}&ILocationID={LocID}&IsReprint={PrintAgain}&categoryCode={CategoryCode}&Ispopup=Y', -- QueryString - nvarchar
    N'Print_SlideBarcode_SampleSearch', -- ActionCode - nvarchar
    N'N', -- IsShareable - nchar
    N'en-GB' -- LanguageCode - nvarchar
)

INSERT INTO dbo.ActionRoleMapping
(
    ActionID,
    RoleID,
    RedirectPageID,
    SearchTypeID,
    IsMapped
    --ID - this column value is auto-generated
)
VALUES
(
    (SELECT MAX(am.ActionID) FROM dbo.ActionMaster am), -- ActionID - int
    3494, -- RoleID - bigint
    465, -- RedirectPageID - bigint
    42, -- SearchTypeID - int
    N'Y' -- IsMapped - nchar
      -- ID - bigint
)

END
------------------------------------Vijayalaskhmi.M----------------------------------------
DECLARE @PageID1 BIGINT
DECLARE @MenuID1 INT
DECLARE @MenuID2 INT
SELECT @PageID1=MAX(PageID) FROM Pages
SELECT @MenuID1=MAX(MenuID) FROM MenuMaster



DECLARE @OrgID INT
DECLARE @RoleID BIGINT
SET @OrgID=86
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'
																   

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Admin/SampleArchivalMaster.aspx?IsLims=Y')
BEGIN
INSERT into Pages(PageID,PageName,PageURL,IsShareable)
SELECT @PageID1+1,'Sample Storage Unit','/Admin/SampleArchivalMaster.aspx?IsLims=Y','Y'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/SampleArchivalMaster.aspx?IsLims=Y' AND MM.OrgId=@OrgID)
BEGIN
INSERT into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode)
SELECT	@MenuID1+1,'Sample archival master',2,@OrgID,@PageID1+1,'en-GB'
END

SELECT @MenuID2 =mm.MenuID  FROM MenuMaster MM where MM .DisplayText ='Sample archival master'
IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Admin/SampleArchivalMaster.aspx?IsLims=Y' AND MM.OrgId=@OrgID)
BEGIN
INSERT into RoleMenu(MenuID,RoleID,IsMapped)
SELECT @MenuID2,@RoleID,'Y'
END
-----------------------------------------------------------------------------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @MenuID3 INT
DECLARE @MenuID4 INT
DECLARE @OrgID INT
DECLARE @RoleID BIGINT
SET @OrgID=86
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Lab Technician'
																   
IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Lab/SampleWorkFlow.aspx')
BEGIN
INSERT into Pages(PageID,PageName,PageURL,IsShareable)
SELECT @PageID+1,'Sample WorkFlow','/Lab/SampleWorkFlow.aspx','Y'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Lab/SampleWorkFlow.aspx' AND MM.OrgId=@OrgID)
BEGIN
INSERT into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode)
SELECT	@MenuID+1,'Sample WorkFlow',0,@OrgID,@PageID+1,'en-GB'
END

SELECT @MenuID3 =MenuID FROM MenuMaster MM where  MM .DisplayText ='Sample WorkFlow'
IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Lab/SampleWorkFlow.aspx' AND MM.OrgId=@OrgID)
BEGIN
INSERT into RoleMenu(MenuID,RoleID,IsMapped)
SELECT @MenuID3,@RoleID,'Y'
END

-----------------------------------------------------------------------------------------------------------
DECLARE @PageID1 BIGINT
DECLARE @MenuID1 INT
DECLARE @MenuID2 INT
SELECT @PageID1=MAX(PageID) FROM Pages
SELECT @MenuID1=MAX(MenuID) FROM MenuMaster



DECLARE @OrgID INT
DECLARE @RoleID BIGINT
SET @OrgID=67
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Lab Technician'
																   

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Lab/SampleArchival.aspx')
BEGIN
INSERT into Pages(PageID,PageName,PageURL,IsShareable)
SELECT @PageID1+1,'Sample Archival','/Lab/SampleArchival.aspx','Y'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Lab/SampleArchival.aspx' AND MM.OrgId=@OrgID)
BEGIN
INSERT into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode)
SELECT	@MenuID1+1,'Sample Archival',0,@OrgID,@PageID1+1,'en-GB'
END

SELECT @MenuID2 =mm.MenuID  FROM MenuMaster MM where MM .DisplayText ='Sample Archival'
IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Lab/SampleArchival.aspx' AND MM.OrgId=@OrgID)
BEGIN
INSERT into RoleMenu(MenuID,RoleID,IsMapped)
SELECT @MenuID2,@RoleID,'Y'
END
-----------------------------------------------------------------------------------------------------
-------------------------------------------------------prem---------------------------------------------------------------------------


declare @pagecontextidsms int
declare @pagecontextidemail int
declare @pageid int
declare @Quotation_RegEmail int
declare @Quotation_RegSms int
declare @roleid int
select @roleid= RoleID from role where OrgID=98 and RoleName='Lab Technician'
select @pageid = PageID from pages where PageURL='/Waters/QuotationMaster.aspx'

if not exists(select 1 from PageContext where buttonname='SendQRegSms' or buttonname='SendQRegMail')
begin
insert into PageContext(PageID,ButtonName,ButtionValue)
select @pageid,'SendQRegSms','SendQRegSms'
union
select @pageid,'SendQRegMail','SendQRegMail'
end

select @pagecontextidsms= max(pagecontextid) from pagecontext where ButtonName='SendQRegSms'
select @pagecontextidemail= max(pagecontextid) from pagecontext where ButtonName='SendQRegMail'

insert into ActionTemplate(TemplateTypeID,Template,Subject,TemplateName)
select 1,'Dear {Name}, Your Quotation request has been registered successfully at {MsgedDate}, <br>Thank you','Registration Email','Quotation_RegEmail'
union
select 1,'Dear {Name}, Your Quotation request has been registered successfully at {MsgedDate}, <br>Thank you','','Quotation_RegSms'

select @Quotation_RegEmail=TemplateID from ActionTemplate where TemplateName='Quotation_RegEmail'
select @Quotation_RegSms=TemplateID from ActionTemplate where TemplateName='Quotation_RegSms'

insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
select @pagecontextidsms,@roleid,3,@Quotation_RegEmail,'QP','notify','N'
union
select @pagecontextidemail,@roleid,1,@Quotation_RegSms,'QP','notify','N'


----------------------------------------------------------------------------------------------------------------------------------------------

/*************************Added By Arivalagan.kk for  slide bar-code category insert and  print***************************/

IF NOT EXISTS (SELECT  1 FROM dbo.BarcodeCategories bc WHERE bc.Name ='Slide Barcode' AND bc.Code='SlideBarcode')
BEGIN
INSERT INTO dbo.BarcodeCategories
(
    --Id - this column value is auto-generated
    dbo.BarcodeCategories.Name,
    dbo.BarcodeCategories.Code
)
SELECT
    -- Id - bigint
    N'Slide Barcode', -- Name - nvarchar
    N'SlideBarcode' -- Code - nvarchar

END
IF NOT EXISTS (SELECT  1 FROM dbo.BarcodePlaceHolders bph WHERE bph.Name ='Stain Type' AND bph.Code='Stain Type')
BEGIN
INSERT INTO dbo.BarcodePlaceHolders
(
    --Id - this column value is auto-generated
    dbo.BarcodePlaceHolders.Name,
    dbo.BarcodePlaceHolders.Code
)
SELECT -- Id - bigint
    N'Stain Type', -- Name - nvarchar
    N'TestStatus' -- Code - nvarchar

END
IF NOT EXISTS (SELECT  1 FROM dbo.BarcodePlaceHolders bph WHERE bph.Name ='Slide Prepared Date' AND bph.Code='CollectedDateTime')
BEGIN
INSERT INTO dbo.BarcodePlaceHolders
(
    --Id - this column value is auto-generated
    dbo.BarcodePlaceHolders.Name,
    dbo.BarcodePlaceHolders.Code
)
SELECT -- Id - bigint
    N'Slide Prepared Date', -- Name - nvarchar
    N'CollectedDateTime' -- Code - nvarchar

END


IF NOT EXISTS (SELECT  1 FROM ActionMaster am WHERE am.ActionName='Print Slide Barcode' AND am.ActionCode='Print_SlideBarcode_SampleSearch')
BEGIN
INSERT INTO dbo.ActionMaster
(
    dbo.ActionMaster.ActionID,
    dbo.ActionMaster.ActionName,
    dbo.ActionMaster.QueryString,
    dbo.ActionMaster.ActionCode,
    dbo.ActionMaster.IsShareable,
    dbo.ActionMaster.LanguageCode
)
SELECT
    (SELECT MAX(am.ActionID)+1 FROM dbo.ActionMaster am), -- ActionID - int
    N'Print Slide Barcode', -- ActionName - nvarchar
    N'../Admin/PrintBarcode.aspx?visitId={PatientVisitID}&sampleId={SampleID}&guId={GuId}&orgId={OrgID}&LID={LoginID}&ILocationID={LocID}&IsReprint={PrintAgain}&categoryCode={CategoryCode}&Ispopup=Y', -- QueryString - nvarchar
    N'Print_SlideBarcode_SampleSearch', -- ActionCode - nvarchar
    N'N', -- IsShareable - nchar
    N'en-GB' -- LanguageCode - nvarchar

END

IF NOT EXISTS (SELECT  1 FROM ActionRoleMapping arm WHERE arm.RoleID=3494 AND arm.RedirectPageID=465 AND arm.SearchTypeID=42)
BEGIN
INSERT INTO dbo.ActionRoleMapping
(
    ActionID,
    RoleID,
    RedirectPageID,
    SearchTypeID,
    IsMapped
    --ID - this column value is auto-generated
)
SELECT
    (SELECT MAX(am.ActionID) FROM dbo.ActionMaster am), -- ActionID - int
    3494, -- RoleID - bigint
    465, -- RedirectPageID - bigint
    42, -- SearchTypeID - int
    N'Y' -- IsMapped - nchar
      -- ID - bigint
END

/*************************Added By Arivalagan.kk for  slide bar-code category insert and  print***************************/
/*************************Added By Arivalagan.kk for  Synoptic Report***************************/
IF NOT EXISTS(SELECT 1
              FROM   dbo.InvestigationStatus [is]
              WHERE  [is].Status = 'Synoptic')
  BEGIN
      INSERT INTO dbo.InvestigationStatus
                  (dbo.InvestigationStatus.InvestigationStatusID,
                   dbo.InvestigationStatus.Status,
                   dbo.InvestigationStatus.Reason,
                   dbo.InvestigationStatus.Orgid,
                   dbo.InvestigationStatus.DisplayText,
                   dbo.InvestigationStatus.ABBR,
                   dbo.InvestigationStatus.[Sequence])
      SELECT (SELECT Max(InvestigationStatusID) + 1
              FROM   InvestigationStatus),-- InvestigationStatusID - int
             N'Synoptic',-- Status - nvarchar
             N'Synoptic Report  ',-- Reason - nvarchar
             NULL,-- Orgid - int
             N'Synoptic Report',-- DisplayText - nvarchar
             NULL,-- ABBR - nvarchar
             (SELECT Max(Sequence) + 1
              FROM   InvestigationStatus) -- Sequence - int
  END

--SELECT * FROM dbo.InvStatusOrgMapping isom WHERE isom.InvestigationStatusID=35
IF NOT EXISTS(SELECT 1
              FROM   dbo.InvStatusOrgMapping isom
              WHERE  isom.InvestigationStatusID IN (SELECT DISTINCT [is].InvestigationStatusID
                                                        FROM   dbo.InvestigationStatus [is]
                                                        WHERE  [is].Status = 'Synoptic'))
  BEGIN
      INSERT INTO dbo.InvStatusOrgMapping
                  (
      --InvStatusOrgMappingID - this column value is auto-generated
      dbo.InvStatusOrgMapping.InvestigationStatusID,
                   dbo.InvStatusOrgMapping.Status,
                   dbo.InvStatusOrgMapping.LangCode,
                   dbo.InvStatusOrgMapping.OrgID,
                   dbo.InvStatusOrgMapping.DisplayText)
      SELECT -- InvStatusOrgMappingID - bigint
      (SELECT [is].InvestigationStatusID
       FROM   dbo.InvestigationStatus [is]
       WHERE  [is].Status = 'Synoptic'),-- InvestigationStatusID - int
      N'Synoptic',-- Status - nvarchar
      N'en-GB',-- LangCode - nvarchar
      109,-- OrgID - int
      N'Synoptic' -- DisplayText - nvarchar
  END

--	SELECT * FROM dbo.InvStatusmapping [is] WHERE [is].InvestigationStatusID=12 AND [is].OrgID=109
IF NOT EXISTS (SELECT 1
               FROM   dbo.InvStatusmapping [is]
               WHERE  [is].InvestigationStatusID = 12
                      AND [is].MappingID IN (SELECT is2.InvestigationStatusID
                                                 FROM   dbo.InvestigationStatus is2
                                                 WHERE  is2.Status = 'Synoptic'))
  BEGIN
      DECLARE @MappingID NCHAR(5)

      SELECT @MappingID = is2.InvestigationStatusID
      FROM   dbo.InvestigationStatus is2
      WHERE  is2.Status = 'Synoptic'

      SELECT @MappingID

      INSERT INTO dbo.InvStatusmapping
                  (dbo.InvStatusmapping.InvestigationStatusID,
                   dbo.InvStatusmapping.MappingID,
                   dbo.InvStatusmapping.OrgID,
                   dbo.InvStatusmapping.SeqNo
      --ID - this column value is auto-generated
      )
      SELECT (SELECT InvestigationStatusID
              FROM   dbo.InvestigationStatus [is]
              WHERE  [is].InvestigationStatusID = 12),-- InvestigationStatusID - int
             @MappingID,-- MappingID - nchar
             109,-- OrgID - int
             12 -- SeqNo - int
  -- ID - int
  END

IF NOT EXISTS (SELECT 1
               FROM   dbo.TaskEntityMap tem
               WHERE  MappingType = 'InvestigationStatus'
                      AND tem.MappingID = 12
                      AND tem.TaskActionID = 39)
  BEGIN
      INSERT INTO dbo.TaskEntityMap
                  (
      --TaskEntityMapID - this column value is auto-generated
      dbo.TaskEntityMap.MappingType,
                   dbo.TaskEntityMap.MappingID,
                   dbo.TaskEntityMap.TaskActionID)
      SELECT -- TaskEntityMapID - bigint
      N'InvestigationStatus',-- MappingType - nvarchar
      12,-- MappingID - int
      39 -- TaskActionID - int
  END 

/*************************Added By Arivalagan.kk for  Synoptic Report***************************/

/************************Added by Seethaladevi for Localization Changes*********/

DECLARE @URNTYpe Nvarchar(50), @URNTypeId int
SET @URNTYpe='Lic. Conducir'
If NOT EXISTS (select 1 from URNTypes where URNType=@URNTYpe)
Begin
INSERT INTO URNTypes (URNTYpe)
SELECT @URNTYpe
END
GO
DECLARE @URNTYpe Nvarchar(50), @URNTypeId int
SET @URNTYpe='Pasaporte'
If NOT EXISTS (select 1 from URNTypes where URNType=@URNTYpe)
Begin
INSERT INTO URNTypes (URNTYpe)
SELECT @URNTYpe
END
GO
DECLARE @URNTYpe Nvarchar(50), @URNTypeId int
SET @URNTYpe='Doc. ID'
If NOT EXISTS (select 1 from URNTypes where URNType=@URNTYpe)
Begin
INSERT INTO URNTypes (URNTYpe)
SELECT @URNTYpe
END
GO




CREATE TABLE #TempOrg (OrgID int)
INSERT INTO #TempOrg
SELECT OrgID from Organization where Name in ('Neolab','Clinica vida','Provital','BoteroSanin','Labcenter','Celsalud') 
DECLARE @MinValue int 
DECLARE @MaxValue int

SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrg) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrg) 


WHILE @MinValue <= @MaxValue 
BEGIN
SET @MinValue = @MinValue 
DECLARE @URNTypeId int,@Orgid int, @URNType Nvarchar(50)
set @URNType='Lic. Conducir'
SELECT @URNTypeId=URNTypeId from URNTypes where URNType=@URNType

IF NOT EXISTS (Select 1 from URNOrgMapping where URNTypeId=@URNTypeId and OrgID=@MinValue)
BEGIN
INSERT INTO URNOrgMapping (URNTypeId,OrgID,SeqNo,Displaytext,LangCode)
SELECT @URNTypeId,@MinValue,1,@URNType,'es-ES'
END
SET @MinValue = @MinValue + 1 
END

drop table #TempOrg 
GO


CREATE TABLE #TempOrg (OrgID int)
INSERT INTO #TempOrg
SELECT OrgID from Organization where Name in ('Neolab','Clinica vida','Provital','BoteroSanin','Labcenter','Celsalud') 
DECLARE @MinValue int 
DECLARE @MaxValue int

SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrg) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrg) 


WHILE @MinValue <= @MaxValue 
BEGIN
SET @MinValue = @MinValue 
DECLARE @URNTypeId int,@Orgid int, @URNType Nvarchar(50)
set @URNType='Pasaporte'
SELECT @URNTypeId=URNTypeId from URNTypes where URNType=@URNType

IF NOT EXISTS (Select 1 from URNOrgMapping where URNTypeId=@URNTypeId and OrgID=@MinValue)
BEGIN
INSERT INTO URNOrgMapping (URNTypeId,OrgID,SeqNo,Displaytext,LangCode)
SELECT @URNTypeId,@MinValue,2,@URNType,'es-ES'
END
SET @MinValue = @MinValue + 1 
END

drop table #TempOrg 
GO


CREATE TABLE #TempOrg (OrgID int)
INSERT INTO #TempOrg
SELECT OrgID from Organization where Name in ('Neolab','Clinica vida','Provital','BoteroSanin','Labcenter','Celsalud') 
DECLARE @MinValue int 
DECLARE @MaxValue int

SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrg) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrg) 


WHILE @MinValue <= @MaxValue 
BEGIN
SET @MinValue = @MinValue
DECLARE @URNTypeId int,@Orgid int, @URNType Nvarchar(50)
set @URNType='Doc. ID'
SELECT @URNTypeId=URNTypeId from URNTypes where URNType=@URNType

IF NOT EXISTS (Select 1 from URNOrgMapping where URNTypeId=@URNTypeId and OrgID=@MinValue)
BEGIN
INSERT INTO URNOrgMapping (URNTypeId,OrgID,SeqNo,Displaytext,LangCode)
SELECT @URNTypeId,@MinValue,3,@URNType,'es-ES'
END
SET @MinValue = @MinValue + 1 
END

drop table #TempOrg 
GO


IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Registration SMS')
BEGIN	
insert into MetaData select 'ContextType', 'RSMS', 'Registration SMS','',0,NULL
END
IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Report SMS')
BEGIN	
insert into MetaData select 'ContextType', 'REPSMS', 'Report SMS','',0,NULL
END
IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Bill Pdf')
BEGIN	
insert into MetaData select 'ContextType', 'BPDF', 'Bill Pdf','',0,NULL
END
IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Bill Email')
BEGIN	
insert into MetaData select 'ContextType', 'BEMAIL', 'Bill Email','',0,NULL
END

IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Report Pdf (With Stationery)')
BEGIN	
insert into MetaData select 'ContextType', 'RPDFWSTA', 'Report Pdf (With Stationery)','',0,NULL
END

IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Report Pdf (WithOut Stationery)')
BEGIN	
insert into MetaData select 'ContextType', 'RPDFWOSTA', 'Report Pdf (WithOut Stationery)','',0,NULL
END

IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Report Email')
BEGIN	
insert into MetaData select 'ContextType', 'REMAIL', 'Report Email','',0,NULL
END


IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Completed')
BEGIN	
insert into MetaData select 'ContextType', 'Comp', 'Completed','',0,NULL
END


IF NOT EXISTS(SELECT MetaDataID FROM metadata WHERE Domain='ContextType' and DisplayText ='Error')
BEGIN	
insert into MetaData select 'ContextType', 'Err', 'Error','',0,NULL
END


   
Declare @Orgid int
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT orgid from Organization where OrgID in (176,177,178,179,180,181)
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
declare @Metadataid bigint, @LanguageCode nvarchar(20)
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT orgid FROM Organization WHERE orgid=@MinValue) 
	BEGIN
		set @LanguageCode='es-ES'
		SELECT @Orgid =orgid FROM Organization WHERE orgid=@MinValue
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='RSMS'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'SMS registro')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='REPSMS'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Informe SMS')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='BPDF'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Bill Pdf')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='BEMAIL'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Bill Email')
	   End
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='RPDFWSTA'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Informe en PDF (con diseño de fondo)')
	   End
	   
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='RPDFWOSTA'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Informe Pdf (sin papel)')
	   End
	   
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='REMAIL'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Correo electrónico de informe')
	   End
	   
	      
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='Err'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Error')
	   End
	   
	      
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='Comp'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Finalizado')
	   End
	   
   End
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID  
GO


Declare @Orgid int
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT orgid from Organization where OrgID in (176,177,178,179,180,181)
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
declare @Metadataid bigint, @LanguageCode nvarchar(20)
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT orgid FROM Organization WHERE orgid=@MinValue) 
	BEGIN
		set @LanguageCode='en-GB'
		SELECT @Orgid =orgid FROM Organization WHERE orgid=@MinValue
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='RSMS'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Registration SMS')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='REPSMS'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Report SMS')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='BPDF'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Bill Pdf')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='BEMAIL'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Bill Email')
	   End
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='RPDFWSTA'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Report Pdf (With Stationery)')
	   End
	   
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='RPDFWOSTA'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Report Pdf (WithOut Stationery)')
	   End
	   
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='REMAIL'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Report Email')
	   End
	   
	     select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='Err'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Error')
	   End
	   
	      
	    select @Metadataid=MetaDataID from Metadata where Domain='ContextType' and Code='Comp'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Completed')
	   End
   End
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID  
GO

/************************* Added by seethaladevi for Localization changes**************************/
/************************* Vijayalakshmi.M ********************************************************/
/************************* For rejected status not capturing in Visit Search **********************/
begin
insert into invstatusorgmapping (investigationstatusid,status,LangCode,DisplayText)
select 1000,'Rejected','en-GB','Rejected'
end
/**************************End*********************************************************************/


SELECT @OrgID=orgid from Organization
SELECT @RoleID=RoleID FROM Role WHERE RoleName LIKE 'Dispatch Controller' AND OrgID=@OrgID
INSERT INTO ActionRoleMapping (ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)VALUES(42,@RoleID,55,11,'Y')
INSERT INTO ActionRoleMapping (ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)VALUES(42,@RoleID,55,10,'Y')
INSERT INTO ActionRoleMapping (ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)VALUES(149,@RoleID,460,11,'Y')
INSERT INTO ActionRoleMapping (ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)VALUES(150,@RoleID,352,11,'Y')


/************************* Added by seethaladevi for Localization changes**************************/

Declare @Orgid int
CREATE TABLE #TempOrgID ( OrgID int )
INSERT INTO #TempOrgID 
SELECT orgid from Organization 
DECLARE @MinValue int 
DECLARE @MaxValue int 
SET @MinValue=(SELECT MIN(OrgID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(OrgID) FROM #TempOrgID) 
declare @Metadataid bigint, @LanguageCode nvarchar(20)
WHILE @MinValue <= @MaxValue 
BEGIN
IF EXISTS(SELECT orgid FROM Organization WHERE orgid=@MinValue) 
	BEGIN
		set @LanguageCode='es-ES'
		SELECT @Orgid =orgid FROM Organization WHERE orgid=@MinValue
	   select @Metadataid=MetaDataID from Metadata where Domain='ReportFormat' and Code='1'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Detalle')
	   End
	   select @Metadataid=MetaDataID from Metadata where Domain='ReportFormat' and Code='0'
	   if not exists(select 1 from MetadataOrgMapping where MetadataID=@Metadataid and orgid=@Orgid and LangCode=@LanguageCode)
	   Begin
			insert into metadataorgmapping (MetadataID,OrgID,LangCode,DisplayText) values(@Metadataid,@Orgid,@LanguageCode,'Resumen')
	   End
	   
	   
   End
SET @MinValue = @MinValue + 1 
END
drop table #TempOrgID  
GO

/************************* Added by seethaladevi for Localization changes**************************/

Declare @Type NVarchar(50), @ORgid int
set @Type='Name'
set @orgid=86
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Patient Name cannot be empty',@orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='Gender'
set @orgid=86
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Gender cannot be empty', @orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='ClientCode'
set @orgid=86
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Client code cannot be empty', @orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='TestCode'
set @orgid=86
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Test code cannot be empty',@orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='Age'
set @orgid=86
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Date of birth cannot be empty', @orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='Refferphysician'
set @orgid=86
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Refering Physician code cannot be empty', @orgid
END
GO


DECLARE @OrgID int, @configkeyid int,@configkey varchar(max),@DisplayText varchar(Max),@isinternal varchar(10),@orgaddressid int, @configkeyvalue varchar(Max)
select @orgid=86
select @orgaddressid=Addressid from organizationAddress where OrgID=@OrgID
select @configkeyid =Max(ConfigKeyID)+1 from ConfigKeyMaster 
set @configkey='VisitSearch_ExternalVisitid_VisitNumber'
set @isinternal='Y'

if not exists(select * from ConfigKeyMaster where ConfigKey=@configkey)
begin
insert into ConfigKeyMaster (ConfigKeyID,ConfigKey,IsInternal)
select @configkeyid,@configkey,@isinternal
end

select @configkeyid=ConfigKeyID, @configkeyvalue=IsInternal from ConfigKeyMaster where ConfigKey='VisitSearch_ExternalVisitid_VisitNumber'
if not exists (select * from ConfigOrgMaster where ConfigKeyID=@configkeyid and OrgID=@orgid)
begin
insert into ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,OrgAddressId)
select @configkeyid,@configkeyvalue,@OrgID,@orgaddressid
end





Declare @Type NVarchar(50), @ORgid int
set @Type='Name'
set @orgid=128
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Patient Name cannot be empty',@orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='Gender'
set @orgid=128
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Gender cannot be empty', @orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='ClientCode'
set @orgid=128
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Client code cannot be empty', @orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='TestCode'
set @orgid=128
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Test code cannot be empty',@orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='Age'
set @orgid=128
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Date of birth cannot be empty', @orgid
END
GO

Declare @Type NVarchar(50), @ORgid int
set @Type='Refferphysician'
set @orgid=128
IF NOT EXISTS (Select 1 from IntegrationError where Type=@Type and ORgid=@ORgid)
Begin
insert into IntegrationError (Type,Description,Orgid)
select @Type,'Refering Physician code cannot be empty', @orgid
END
GO
	
	
DECLARE @OrgID int, @configkeyid int,@configkey varchar(max),@DisplayText varchar(Max),@isinternal varchar(10),@orgaddressid int, @configkeyvalue varchar(Max)
select @orgid=128
select @orgaddressid=Addressid from organizationAddress where OrgID=@OrgID
select @configkeyid =Max(ConfigKeyID)+1 from ConfigKeyMaster 
set @configkey='VisitSearch_ExternalVisitid_VisitNumber'
set @isinternal='Y'

if not exists(select * from ConfigKeyMaster where ConfigKey=@configkey)
begin
insert into ConfigKeyMaster (ConfigKeyID,ConfigKey,IsInternal)
select @configkeyid,@configkey,@isinternal
end

select @configkeyid=ConfigKeyID, @configkeyvalue=IsInternal from ConfigKeyMaster where ConfigKey='VisitSearch_ExternalVisitid_VisitNumber'
if not exists (select * from ConfigOrgMaster where ConfigKeyID=@configkeyid and OrgID=@orgid)
begin
insert into ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,OrgAddressId)
select @configkeyid,@configkeyvalue,@OrgID,@orgaddressid
end


DECLARE @OrgID int, @configkeyid int,@configkey varchar(max),@DisplayText varchar(Max),@isinternal varchar(10),@orgaddressid int, @configkeyvalue varchar(Max)
select @orgid=128
select @orgaddressid=Addressid from organizationAddress where OrgID=@OrgID
select @configkeyid =Max(ConfigKeyID)+1 from ConfigKeyMaster 
set @configkey='ISOutBound_Needed'
set @isinternal='Y'

if not exists(select * from ConfigKeyMaster where ConfigKey=@configkey)
begin
insert into ConfigKeyMaster (ConfigKeyID,ConfigKey,IsInternal)
select @configkeyid,@configkey,@isinternal
end

select @configkeyid=ConfigKeyID, @configkeyvalue=IsInternal from ConfigKeyMaster where ConfigKey='ISOutBound_Needed'
if not exists (select * from ConfigOrgMaster where ConfigKeyID=@configkeyid and OrgID=@orgid)
begin
insert into ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,OrgAddressId)
select @configkeyid,@configkeyvalue,@OrgID,@orgaddressid
end
GO

Declare @Attributename nvarchar(50), @Attributecode Nvarchar(20)
set @Attributename='OutBound'
set @Attributecode='OB'
if NOT EXISTS (select 1 from ClientAttributes where AttributeName=@Attributename and @Attributecode=@Attributecode)
BEGIN
insert into ClientAttributes (AttributeName,AttributeCode,AttributesType)
Select  @Attributename,@Attributecode,'Report'
END
GO


Declare @Roleid int, @Actiontypeid int, @TemplateID int, @PageContextid int

select  @Roleid=RoleID from role where Rolename='Doctor' and Orgid=128
select @TemplateID=TemplateID from ActionTemplate  where TemplateName='P_Report_pdf' and Template='\REPORT\{OrgID}\{pdfDate}\' and Attachmentname='Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf'
select @PageContextid=PageContextID from PageContext where ButtonName='btnSaveToDispatch'
select @Actiontypeid=ActionTypeID from ActionManagerType where ActionType='OutBound'
if not exists(select 1 from PageContextactionmapping where Roleid=@Roleid and ActionTypeID=@Actiontypeid and PageContextID=@PageContextid and TemplateID=@TemplateID)
Begin
Insert into PageContextactionmapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
Select @PageContextid,@Roleid,@Actiontypeid,@TemplateID,'P','Report','Y'
End
GO

Declare @Roleid int, @Actiontypeid int, @TemplateID int, @PageContextid int

select  @Roleid=RoleID from role where Rolename='Doctor' and Orgid=128
select @TemplateID=TemplateID from ActionTemplate  where TemplateName='P_Report_pdf' and Template='\REPORT\{OrgID}\{pdfDate}\' and Attachmentname='Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf'
select @PageContextid=PageContextID from PageContext where ButtonName='btnSave' and ButtionValue='Save'
select @Actiontypeid=ActionTypeID from ActionManagerType where ActionType='OutBound'
if not exists(select 1 from PageContextactionmapping where Roleid=@Roleid and ActionTypeID=@Actiontypeid and PageContextID=@PageContextid and TemplateID=@TemplateID)
Begin
Insert into PageContextactionmapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
Select @PageContextid,@Roleid,@Actiontypeid,@TemplateID,'P','Report','Y'
End
GO

Declare @ActionType Nvarchar(50), @Actioncode Nvarchar(10)
set @ActionType='OutBound' 
set @Actioncode='OB'
If Not Exists (select 1 from ActionManagerType where ActionType=@ActionType and ActionCode=@Actioncode)
BEgin
INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,LangCode)
SELECT  @ActionType,'N',@Actioncode,'en-GB'
END
GO


DECLARE @OrgID int, @configkeyid int,@configkey varchar(max),@DisplayText varchar(Max),@isinternal varchar(10),@orgaddressid int, @configkeyvalue varchar(Max)
select @orgid=128
select @orgaddressid=Addressid from organizationAddress where OrgID=@OrgID
select @configkeyid =Max(ConfigKeyID)+1 from ConfigKeyMaster 
set @configkey='IntegrationLogin'
set @isinternal='Y'

if not exists(select * from ConfigKeyMaster where ConfigKey=@configkey)
begin
insert into ConfigKeyMaster (ConfigKeyID,ConfigKey,IsInternal)
select @configkeyid,@configkey,@isinternal
end

select @configkeyid=ConfigKeyID from ConfigKeyMaster where ConfigKey='IntegrationLogin'
if not exists (select * from ConfigOrgMaster where ConfigKeyID=@configkeyid and OrgID=@orgid and ConfigValue='33037')
begin
insert into ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,OrgAddressId)
select @configkeyid,33037,@OrgID,@orgaddressid
end
------------------------------------------

 Insert Into Ordtasks (status,Seq) values ('Retest',-9)
 Insert Into Ordtasks (status,Seq) values ('Rejected',-8)
 Insert Into Ordtasks (status,Seq) values ('Reject',-7)
 Insert Into Ordtasks (status,Seq) values ('ReflexTest',-6)
 Insert Into Ordtasks (status,Seq) values ('Recheck',-5)
 Insert Into Ordtasks (status,Seq) values ('OutSource',-4)
 Insert Into Ordtasks (status,Seq) values ('Not Given',-3)
 Insert Into Ordtasks (status,Seq) values ('NonReportable',-2)
 Insert Into Ordtasks (status,Seq) values ('Cancel',-1)
 Insert Into Ordtasks (status,Seq) values ('Paid',1)
 Insert Into Ordtasks (status,Seq) values ('SampleCollected',2)
 Insert Into Ordtasks (status,Seq) values ('PartialyCollected',3)
 Insert Into Ordtasks (status,Seq) values ('SampleTransferred',4)
 Insert Into Ordtasks (status,Seq) values ('Yet to Transfer',5)
 Insert Into Ordtasks (status,Seq) values ('SampleReceived',6)
 Insert Into Ordtasks (status,Seq) values ('OutSource',7)
 Insert Into Ordtasks (status,Seq) values ('Pending',8)
 Insert Into Ordtasks (status,Seq) values ('PartiallyCompleted',9)
 Insert Into Ordtasks (status,Seq) values ('Completed',10)
 Insert Into Ordtasks (status,Seq) values ('PartiallyValidated',11)
 Insert Into Ordtasks (status,Seq) values ('Validate',12)
 Insert Into Ordtasks (status,Seq) values ('PartiallyApproved',13)
 Insert Into Ordtasks (status,Seq) values ('Approve',14)
 Insert Into Ordtasks (status,Seq) values ('Co-authorize',15)
 go




 IF NOT EXISTS (SELECT 1 FROM Pages WHERE PageName='Lab Quick Billing' AND PageURL='/Billing/WortixLabQuickBilling.aspx')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL)
SELECT MAX(PageID)+1,'Lab Quick Billing','/Billing/WortixLabQuickBilling.aspx' FROM Pages
END
GO
------------------------------------karthik.p added Referral Payout Page insert script-----------------------------------------
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=67

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Admin/DoctorPaySummary.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'Referral Payment','/Admin/DoctorPaySummary.aspx'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Admin/DoctorPaySummary.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'Referral Payment',0,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Admin/DoctorPaySummary.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END
------------------------------------karthik.p added Referral Payout Page insert script--------------------------------------------

-------------------------------rajesh ----------------------------------
IF Not Exists(Select * from MetaData where Domain='WorkListType' and Code='Special_Based' and DisplayText='Special')
Begin 
insert into MetaData(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('WorkListType','Special_Based','Special','en-GB',0,NULL)
DECLARE @Metadata INT
 SELECT @Metadata=(SELECT metadataid from metadata where domain='WorkListType' and displaytext='Special' and Code='Special_Based')
 Insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values(@Metadata,159,'en-GB','Special')
End

IF Not Exists(Select * from MetaData where Domain='WL_Type' and Code='Histopath Format' and DisplayText='Histopath Format')
Begin 
insert into MetaData(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('WL_Type','Histopath Format','Histopath Format','en-GB',0,NULL)
DECLARE @Metadata1 INT
 SELECT @Metadata1=(SELECT metadataid from metadata where domain='WL_Type' and displaytext='Histopath Format' and Code='Histopath Format')
 Insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values(@Metadata1,159,'en-GB','Histopath Format')
End

IF Not Exists(select * from ConfigKeyMaster where ConfigKey='WorkListFormatPrint' and DisplayText='WorkListFormatPrint')
Begin
insert into ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal) values((select max(configkeyid)+1 from ConfigKeyMaster),'WorkListFormatPrint','WorkListFormatPrint','N')

DECLARE @Configid INT
select @Configid=(select ConfigKeyID from ConfigKeyMaster where ConfigKey='WorkListFormatPrint' and DisplayText='WorkListFormatPrint')

insert into ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID) values(@Configid,'Y',159)
End

-----------------------------------------------------------------------

-----------------------------------------------------------------------

--------------------------Rajesh----------------------------

IF Not Exists(select 1 from ConfigKeyMaster where ConfigKey='AutoSave' and DisplayText='AutoSave')
Begin
insert into ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal) values((select max(configkeyid)+1 from ConfigKeyMaster),'AutoSave','AutoSave','N')

DECLARE @Configid INT
select @Configid=(select ConfigKeyID from ConfigKeyMaster where ConfigKey='AutoSave' and DisplayText='AutoSave')

IF Not Exists(select 1 from ConfigOrgMaster where configkeyid=@Configid and orgid=98)
begin
insert into ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID) values(@Configid,'Y',98)
end
End
----------------------------end-----------------------------------

------------------------------------------------Arunraj kernel_V2 New Billing and result entry page---------------------------------------
Declare @MetaDataID bigint, @Domain nvarchar(255), @Code nvarchar(25), @DisplayText nvarchar(255), @LangCode nvarchar(255), @OrgID bigint
Select @OrgID = OrgID from Organization where Name='Anderson Diagnostics & Labs'; 
Set @LangCode='en-GB'

Set @Domain='Gender';
Set @Code='T'; Set @DisplayText='Transgender'

IF Not Exists(Select 1 from MetaData where Domain=@Domain and DisplayText=@DisplayText)
Begin
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
	Select @Domain, @Code, @DisplayText, @LangCode,0
End

Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=@DisplayText

IF Not Exists(Select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID and OrgID=@OrgID and LangCode=@LangCode and DisplayText=@DisplayText)
Begin
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText)
	Select @MetaDataID,@OrgID,@LangCode,@DisplayText
End

Set @Code='V'; Set @DisplayText='Veterinary'

IF Not Exists(Select 1 from MetaData where Domain=@Domain and DisplayText=@DisplayText)
Begin
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
	Select @Domain, @Code, @DisplayText, @LangCode,0
End

Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=@DisplayText

IF Not Exists(Select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID and OrgID=@OrgID and LangCode=@LangCode and DisplayText=@DisplayText)
Begin
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText)
	Select @MetaDataID,@OrgID,@LangCode,@DisplayText
End

Set @Code='N'; Set @DisplayText='NA'

IF Not Exists(Select 1 from MetaData where Domain=@Domain and DisplayText=@DisplayText)
Begin
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
	Select @Domain, @Code, @DisplayText, @LangCode,0
End

Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=@DisplayText

IF Not Exists(Select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID and OrgID=@OrgID and LangCode=@LangCode and DisplayText=@DisplayText)
Begin
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText)
	Select @MetaDataID,@OrgID,@LangCode,@DisplayText
End

---------------------------------------------------------------------
Set @Domain='PatientStatus';
Set @Code='VIP'; Set @DisplayText='VIP'

IF Not Exists(Select 1 from MetaData where Domain=@Domain and DisplayText=@DisplayText)
Begin
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
	Select @Domain, @Code, @DisplayText, @LangCode,0
End

Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=@DisplayText

IF Not Exists(Select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID and OrgID=@OrgID and LangCode=@LangCode and DisplayText=@DisplayText)
Begin
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText)
	Select @MetaDataID,@OrgID,@LangCode,@DisplayText
End

Set @Code='VS'; Set @DisplayText='VISA'

IF Not Exists(Select 1 from MetaData where Domain=@Domain and DisplayText=@DisplayText)
Begin
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
	Select @Domain, @Code, @DisplayText, @LangCode,0
End

Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=@DisplayText

IF Not Exists(Select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID and OrgID=@OrgID and LangCode=@LangCode and DisplayText=@DisplayText)
Begin
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText)
	Select @MetaDataID,@OrgID,@LangCode,@DisplayText
End

Set @Code='ST'; Set @DisplayText='STAT'

IF Not Exists(Select 1 from MetaData where Domain=@Domain and DisplayText=@DisplayText)
Begin
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
	Select @Domain, @Code, @DisplayText, @LangCode,0
End

Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=@DisplayText

IF Not Exists(Select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID and OrgID=@OrgID and LangCode=@LangCode and DisplayText=@DisplayText)
Begin
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText)
	Select @MetaDataID,@OrgID,@LangCode,@DisplayText
End

---------------------------------------------------------------------
Set @Domain='KnowledgeOfService';
Declare @Count int = (Select count(*) from MetaData where Domain=@Domain)
WHILE (SELECT count(*) FROM KnowledgeOfService) > @Count
BEGIN  
    Set @Count=@Count+1
	Insert Into MetaData(Domain,Code,DisplayText,LangCode,ParentID)
    Select @Domain,CONVERT(varchar(10),@Count),KnowledgeOfServiceName,@LangCode,0 from KnowledgeOfService where KnowledgeOfServiceID= @Count

	Select @MetaDataID = MetaDataID from MetaData where Domain=@Domain and DisplayText=(Select KnowledgeOfServiceName from KnowledgeOfService where KnowledgeOfServiceID= @Count)
	
	Insert Into MetaDataOrgMapping(MetadataID,OrgID,DisplayText,LangCode)
	Select @MetaDataID,@OrgID,KnowledgeOfServiceName,@LangCode from KnowledgeOfService  where KnowledgeOfServiceID= @Count

	IF (SELECT count(*) FROM KnowledgeOfService) = (Select count(*) from MetaData where Domain=@Domain)  
		BREAK  
	ELSE  
		CONTINUE  
END  
Go
------------------------------------------------Arunraj kernel_V2 New Billing and result entry page---------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=98

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Lab/TriSampleCollection.aspx')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'TrisampleTransfer','/Lab/TriSampleCollection.aspx'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Lab/TriSampleCollection.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'TrisampleTransfer',2,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Lab/TriSampleCollection.aspx' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END
go
-------------------------------------------------trisamplepage-------------------------------------------------------------------------

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=159

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
SELECT @RoleID=RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='Administrator'

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Invoice/ClientBatchMaster.aspx?Flag=Y')
BEGIN
	INSERT INTO Pages(PageID,PageName,PageURL) 
	SELECT @PageID+1,'Client Batch Master','/Invoice/ClientBatchMaster.aspx?Flag=Y'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Invoice/ClientBatchMaster.aspx?Flag=Y' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
	SELECT @MenuID+1,'Client Batch Master',2,@OrgID,@PageID+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Invoice/ClientBatchMaster.aspx?Flag=Y' AND MM.OrgId=@OrgID)
BEGIN
	INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
	SELECT @MenuID+1,@RoleID,'Y'
END
--------------------------------------------clientbatchmaster----------------------------------------------------------------------------------------
 
 INSERT INTO [dbo].[MetaData]
           ([Domain]
           ,[Code]
           ,[DisplayText]
           ,[LangCode]
           )
     VALUES
           ('PrinterType'
           ,'Printer'
           ,'ReportPrinter'
           ,'en-GB'
           )

		   
		   
		   
		   
INSERT INTO [dbo].[MetaData]
           ([Domain]
           ,[Code]
           ,[DisplayText]
           ,[LangCode]
           )
     VALUES
           ('PrinterType'
           ,'Printer'
           ,'BarCodePrinter'
           ,'en-GB'
           )




go
DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='BarCodePrinter' and OrgID=@OrgID)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( (select MetadataID from MetaData where DisplayText like '%BarCodePrinter%'),@OrgID,'en-GB','BarCodePrinter')
END
Go




DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='ReportPrinter' and OrgID=@OrgID)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( (select MetadataID from MetaData where DisplayText like '%ReportPrinter%'),@OrgID,'en-GB','ReportPrinter')
END
Go

----------------------------------------------------------------------------------

declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='LoactionPrinter Mapping' and PageURL='/Admin/LocationPrinterMapping.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'LoactionPrinter Mapping','/Admin/LocationPrinterMapping.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='LoactionPrinter Mapping' and PageURL='/Admin/LocationPrinterMapping.aspx'
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'


if not Exists(select 1 from MenuMaster where DisplayText='LoactionPrinter Mapping' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'LoactionPrinter Mapping',2,@OrgID,@PAgeID,'en-GB')
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'
select @menuId=MenuID from MenuMaster where DisplayText='LoactionPrinter Mapping' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
go
--------------------End By sudha--------------------------------------------


/***************************Insert script *********************************/

 declare  @config_val nvarchar(100)  
  select @config_val=configvalue from ConfigOrgMaster where configkeyid=( select ConfigKeyID from ConfigKeyMaster where ConfigKey='LAL_Format')  
  select @config_val
  if(@config_val is null)
  begin
 insert into ConfigKeyMaster(ConfigKeyID, ConfigKey,DisplayText,IsInternal) SELECT MAX(ConfigkeyID) + 1 ,'LAL_Format','Do the functionality is Organization specific','Y' from ConfigKeyMaster
insert into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)SELECT MAX(ConfigkeyID),'Y',212 from ConfigKeyMaster
  end


  



if not Exists (select 1 from MetaData where DisplayText='ReportPrinter' and Domain='PrinterType')
begin
INSERT INTO [dbo].[MetaData]
           ([Domain]
           ,[Code]
           ,[DisplayText]
           ,[LangCode]
           )
     VALUES
           ('PrinterType'
           ,'Printer'
           ,'ReportPrinter'
           ,'en-GB'
           )
end
		   
		   
		   
		if not Exists (select 1 from MetaData where DisplayText='BarCodePrinter' and Domain='PrinterType')
begin   
INSERT INTO [dbo].[MetaData]
           ([Domain]
           ,[Code]
           ,[DisplayText]
           ,[LangCode]
           )
     VALUES
           ('PrinterType'
           ,'Printer'
           ,'BarCodePrinter'
           ,'en-GB'
           )
		   end




DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='BarCodePrinter' and OrgID=@OrgID)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( (select MetadataID from MetaData where DisplayText like '%BarCodePrinter%'),@OrgID,'en-GB','BarCodePrinter')
END
Go




DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='ReportPrinter' and OrgID=@OrgID)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( (select MetadataID from MetaData where DisplayText like '%ReportPrinter%'),@OrgID,'en-GB','ReportPrinter')
END
Go







Declare @ConfigKeyID Bigint
DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'
If (Select MAX(ConfigKeyID) FROM ConfigKeyMaster) IS NULL
BEGIN
	SET @ConfigKeyID = 0
END
ELSE
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster
IF NOT EXISTS( select * from ConfigKeyMaster where ConfigKey  like'%PRN_UploadPath%')
BEGIN
	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal)
	SELECT @ConfigKeyID+1,'PRN_UploadPath','Enter PRN  Upload Path','Y'
END







  DECLARE @OrgID1 int
select @OrgID1=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'
  Declare @ConfigKeyID1 Bigint
   select  @ConfigKeyID1= ConfigKeyID from ConfigKeyMaster where ConfigKey  like'%PRN_UploadPath%'
  IF NOT EXISTS (select * from  ConfigOrgMaster where  ConfigKeyID=@ConfigKeyID)
  begin
  INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	SELECT @ConfigKeyID1,'E:\\LisKernel_Preprod\\PRNFiles\\',@OrgID1
  end
  ------------------------End by sudha----------------------------------

  /************* Btn(Report) visibility in Patient Tracking Details - Statr by Sudha***************/

  
declare @pageid int
select @pageid= pageid from Pages where PageName like '%View Registration%'
--select @pageid
if not exists(select * from PageContext where ButtonName like '%btnSaveToDispatch%'  and PageID=@pageid)
begin
insert into PageContext(PageID,ButtonName,ButtionValue)values((select pageid from Pages where PageName like '%View Registration%'),'btnSaveToDispatch','Save And Home')
end

go
/*********************************************************/

declare @roleid int
declare @orgid int 
declare @pageContextid int
declare @ActionTypeID int
declare @TemplateID int 
select @orgid=OrgID from Organization where Name like 'IGENETIC Diagnostics Pvt. Ltd.%'
select @roleid=RoleID  from role where Description like 'Pathologist%' and OrgID= @orgid
select @pageContextid =Max(PageContextID) from PageContext where pageid in (select pageid from Pages where PageName like '%View Registration%')

select @ActionTypeID=ActionTypeID from ActionManagerType where ActionType like 'pdf%' and IsDisplay ='N'

select @TemplateID =TemplateID from actiontemplate where Template like '\REPORT\{OrgID}\{pdfDate}\' and TemplateName like 'CP_Report_pdf'
--select @orgid,@roleid,@pageContextid,@ActionTypeID,@TemplateID
if not exists (select * from PageContextActionMapping where RoleID= @roleid and PageContextID =@pageContextid and ContextType='CP')
begin
--select '1'
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
values(@pageContextid,@roleid,@ActionTypeID,@TemplateID,'CP')

end 

go

/***************************************************************/


declare @roleid int
declare @orgid int 
declare @pageContextid int
declare @ActionTypeID int
declare @TemplateID int 
select @orgid=OrgID from Organization where Name like 'IGENETIC Diagnostics Pvt. Ltd.%'
select @roleid=RoleID  from role where Description like 'Pathologist%' and OrgID= @orgid
select @pageContextid =Max(PageContextID) from PageContext where pageid in (select pageid from Pages where PageName like '%View Registration%')

select @ActionTypeID=ActionTypeID from ActionManagerType where ActionType like 'pdf%' and IsDisplay ='N'

select @TemplateID =TemplateID from actiontemplate where Template like '\REPORT\{OrgID}\{pdfDate}\' and TemplateName like 'P_Report_pdf'
--select @orgid,@roleid,@pageContextid,@ActionTypeID,@TemplateID
if not exists (select * from PageContextActionMapping where RoleID= @roleid and PageContextID =@pageContextid and ContextType='P')
begin
--select '1'
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
values(@pageContextid,@roleid,@ActionTypeID,@TemplateID,'P')

end 
go
/*********************************************************/

/************ For LAL********************/


declare @roleid int
declare @orgid int 
declare @pageContextid int
declare @ActionTypeID int
declare @TemplateID int 
select @orgid=OrgID from Organization where Name like 'LALPATH LABS%'
if (@orgid is not null)
begin
select @roleid=RoleID  from role where Description like 'Pathologist%' and OrgID= @orgid
select @pageContextid =Max(PageContextID) from PageContext where pageid in (select pageid from Pages where PageName like '%View Registration%')

select @ActionTypeID=ActionTypeID from ActionManagerType where ActionType like 'pdf%' and IsDisplay ='N'

select @TemplateID =TemplateID from actiontemplate where Template like '\REPORT\{OrgID}\{pdfDate}\' and TemplateName like 'CP_Report_pdf'
--select @orgid,@roleid,@pageContextid,@ActionTypeID,@TemplateID
if not exists (select * from PageContextActionMapping where RoleID= @roleid and PageContextID =@pageContextid and ContextType='CP')
begin
--select '1'
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
values(@pageContextid,@roleid,@ActionTypeID,@TemplateID,'CP')

end 
end
go

/***************************************************************/


declare @roleid int
declare @orgid int 
declare @pageContextid int
declare @ActionTypeID int
declare @TemplateID int 
select @orgid=OrgID from Organization where Name like 'LALPATH LABS%'
if (@orgid is not null)
begin
select @roleid=RoleID  from role where Description like 'Pathologist%' and OrgID= @orgid
select @pageContextid =Max(PageContextID) from PageContext where pageid in (select pageid from Pages where PageName like '%View Registration%')

select @ActionTypeID=ActionTypeID from ActionManagerType where ActionType like 'pdf%' and IsDisplay ='N'

select @TemplateID =TemplateID from actiontemplate where Template like '\REPORT\{OrgID}\{pdfDate}\' and TemplateName like 'P_Report_pdf'
--select @orgid,@roleid,@pageContextid,@ActionTypeID,@TemplateID
if not exists (select * from PageContextActionMapping where RoleID= @roleid and PageContextID =@pageContextid and ContextType='P')
begin
--select '1'
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType)
values(@pageContextid,@roleid,@ActionTypeID,@TemplateID,'P')
end
end 




  /************* Btn visibility in Patient Tracking Details - End by Sudha***************/

  /*************  Role Script for New Pages - sudha Start*********************************/

  declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='LoactionPrinter Mapping' and PageURL='/Admin/LocationPrinterMapping.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'LoactionPrinter Mapping','/Admin/LocationPrinterMapping.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='LoactionPrinter Mapping' and PageURL='/Admin/LocationPrinterMapping.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='LoactionPrinter Mapping' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'LoactionPrinter Mapping',2,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='LoactionPrinter Mapping' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go


/***********************************************************************************/






declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='InvStatusOrgPageMapping' and PageURL='/Admin/InvStatusOrgPageMapping.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'InvStatusOrgPageMapping','/Admin/InvStatusOrgPageMapping.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='InvStatusOrgPageMapping' and PageURL='/Admin/InvStatusOrgPageMapping.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if (@orgid is not null)
begin
if not Exists(select 1 from MenuMaster where DisplayText='InvStatusOrgPageMapping' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'InvStatusOrgPageMapping',2,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='InvStatusOrgPageMapping' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go


/******************************************************************************/




 if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%CollectSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','1','CollectSample','en-GB')
  end


  if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%RecieveSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','2','RecieveSample','en-GB')
  end
   if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%AbbarentSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','3','AbbarentSample','en-GB')
  end

  /*************  Role Script for New Pages - sudha End*********************************/
  /*************sudha start*************************/

  if not exists(select * from LanguageMaster where Code like '%en-GB%' and Name like '%English%')
  begin
  insert into LanguageMaster(Code,Name)values('en-GB','English')
  end

    if not exists(select * from LanguageMaster where Code like '%id-ID%' and Name like '%Bahasa%')
  begin
  insert into LanguageMaster(Code,Name)values('id-ID','Bahasa')
  end

    if not exists(select * from LanguageMaster where Code like '%ta-IN%' and Name like '%Tamil%')
  begin
  insert into LanguageMaster(Code,Name)values('ta-IN','Tamil')
  end






  if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%CollectSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','1','CollectSample','en-GB')
  end


  if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%RecieveSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','2','RecieveSample','en-GB')
  end
   if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%AbbarentSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','3','AbbarentSample','en-GB')
  end
   /*************sudha End*************************/
   --------------******************************************************************BarcodeMainAttributes***** start******-----------
if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line1')  
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
--VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line1','Right Header Line1')
VALUES ( 'Right Header Line1','Right Header Line1')
go


if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line2')  
 if exists (select 1 from sys.tables st
inner join sys.columns sc 
on st.object_id=sc.object_id 
where st.name like '%BarcodeMainAttributes%' and sc.is_identity=0 and sc.name='Id')
begin
INSERT [dbo].[BarcodeMainAttributes] ([Id], [Name],[Code]) 
VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line2','Right Header Line2')
end
else
begin
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
VALUES ('Right Header Line2','Right Header Line2')
end
go


if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line3')  
  if exists (select 1 from sys.tables st
inner join sys.columns sc 
on st.object_id=sc.object_id 
where st.name like '%BarcodeMainAttributes%' and sc.is_identity=0 and sc.name='Id')
begin
INSERT [dbo].[BarcodeMainAttributes] ([Id], [Name],[Code]) 
VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line3','Right Header Line3')
end
else
begin
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
VALUES ('Right Header Line2','Right Header Line2')
end
go


if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line4')  
  if exists (select 1 from sys.tables st
inner join sys.columns sc 
on st.object_id=sc.object_id 
where st.name like '%BarcodeMainAttributes%' and sc.is_identity=0 and sc.name='Id')
begin
INSERT [dbo].[BarcodeMainAttributes] ([Id], [Name],[Code]) 
VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line4','Right Header Line4')
end
else
begin
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
VALUES ('Right Header Line2','Right Header Line2')
end
go


if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line5')  
  if exists (select 1 from sys.tables st
inner join sys.columns sc 
on st.object_id=sc.object_id 
where st.name like '%BarcodeMainAttributes%' and sc.is_identity=0 and sc.name='Id')
begin
INSERT [dbo].[BarcodeMainAttributes] ([Id], [Name],[Code]) 
VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line5','Right Header Line5')
end
else
begin
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
VALUES ('Right Header Line2','Right Header Line2')
end
go


if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line6')  
  if exists (select 1 from sys.tables st
inner join sys.columns sc 
on st.object_id=sc.object_id 
where st.name like '%BarcodeMainAttributes%' and sc.is_identity=0 and sc.name='Id')
begin
INSERT [dbo].[BarcodeMainAttributes] ([Id], [Name],[Code]) 
VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line6','Right Header Line6')
end
else
begin
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
VALUES ('Right Header Line2','Right Header Line2')
end
go


if not exists(select * from BarcodeMainAttributes
 where [Name]='Right Header Line7')  
  if exists (select 1 from sys.tables st
inner join sys.columns sc 
on st.object_id=sc.object_id 
where st.name like '%BarcodeMainAttributes%' and sc.is_identity=0 and sc.name='Id')
begin
INSERT [dbo].[BarcodeMainAttributes] ([Id], [Name],[Code]) 
VALUES ((select max(id)+1 from BarcodeMainAttributes), 'Right Header Line7','Right Header Line7')
end
else
begin
INSERT [dbo].[BarcodeMainAttributes] ( [Name],[Code]) 
VALUES ('Right Header Line2','Right Header Line2')
end
go
--------------------***********************BarcodeOrgMapping based on OrgId*****************---------------------
DECLARE @OrgId int

SELECT TOP 1 @OrgId=OrgId from Organization Where Name like '%lalpath%'

if (@OrgId is not null)
begin
insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line1'),@OrgId,'{TestUnit} ','{TestUnit} ')




 insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line2'),@OrgId,'{Age} {Sex}','{Age} {Sex}')

insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line3'),@OrgId,'{SampleCollectionDate}','{SampleCollectionDate}')


insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line4'),@OrgId,'{CurrentCourse} {ProcessingCourse}','{CurrentCourse} {ProcessingCourse}')




insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line5'),@OrgId,'{DeptCode} {ContainerType}','{DeptCode} {ContainerType}')



insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line6'),@OrgId,'{SampleType} {LabelPrintTime}','{SampleType} {LabelPrintTime}')
 

insert into BarcodeOrgMapping(BarcodeCategoryId ,BarcodeMainAttributeId ,OrgID ,Value ,DisplayText )
values (3,(select id from BarcodeMainAttributes
 where [Name]='Right Header Line7'),@OrgId,'{DOB}','{DOB}')

 end
 ------------------********* End ********************-------------------

 --As part od MetaData Master START
--Pages
declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='MetaData' and PageURL='/Admin/MetaData.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'MetaData','/Admin/MetaData.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='MetaData' and PageURL='/Admin/MetaData.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='MetaData Master' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'MetaData Master',2,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='MetaData Master' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

--As part od MetaData END

 INSERT INTO [dbo].[MetaData]
           ([Domain]
           ,[Code]
           ,[DisplayText]
           ,[LangCode]
           )
     VALUES
           ('PrinterType'
           ,'Printer'
           ,'ReportPrinter'
           ,'en-GB'
           )
/*****************Alex START*******/
if not exists(select * from ClientAttributes where AttributeName='FTP' and AttributeCode='FTP')
begin
insert into ClientAttributes(AttributeName,AttributeCode,OrgID,AttributesType,LangCode) values('FTP','FTP',null,'Commercial',null)
end
go
DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
if not exists(select * from MetaDataOrgMapping where DisplayText='1 Month' and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText) values ((select max(metadataid) from MetaDataOrgMapping),@OrgID,'en-GB','1 Month')
end
end
go
DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC Diagnostics Pvt. Ltd.%'
if not exists(select * from MetaDataOrgMapping where DisplayText='15 Days' and OrgID=@OrgID)
begin
insert into MetaDataOrgMapping (MetadataID,OrgID,LangCode,DisplayText) values ((select max(metadataid) from MetaDataOrgMapping),@OrgID,'en-GB','15 Days')
end
go

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=1)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (1, N'Paid', N'en-GB',  @OrgID, N'Paid', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=2)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (2, N'Completed', N'en-GB',  @OrgID, N'Completed', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=3)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (3, N'Reject', N'en-GB',  @OrgID, N'Reject', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=4)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (4, N'Pending', N'en-GB',  @OrgID, N'Pending', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=5)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (5, N'Approve', N'en-GB',  @OrgID, N'Approve', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=6)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (6, N'SampleReceived', N'en-GB',  @OrgID, N'SampleReceived', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=7)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (7, N'SampleCollected', N'en-GB',  @OrgID, N'Ordered', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=8)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (8, N'OutSource', N'en-GB',  @OrgID, N'OutSource', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=9)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (9, N'Cancel', N'en-GB',  @OrgID, N'Cancel', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=10)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (10, N'Retest', N'en-GB',  @OrgID, N'Recollect', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=11)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (11, N'Recheck', N'en-GB',  @OrgID, N'Rerun', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=12)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (12, N'Validate', N'en-GB',  @OrgID, N'Validate', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=13)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (13, N'Ordered', N'en-GB',  @OrgID, N'Ordered', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=14)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (14, N'Refered', N'en-GB',  @OrgID, N'Refered', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=15)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (15, N'SampleTransferred', N'en-GB',  @OrgID, N'SampleTransferred', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=16)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (16, N'Co-authorize', N'en-GB',  @OrgID, N'Co-authorize', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=17)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (17, N'Co-authorized', N'en-GB',  @OrgID, N'Co-authorized', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=18)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (18, N'Not given', N'en-GB',  @OrgID, N'Not given', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=19)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (19, N'PartialyCollected', N'en-GB',  @OrgID, N'PartialyCollected', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=20)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (20, N'PartiallyCompleted', N'en-GB',  @OrgID, N'PartiallyCompleted', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=21)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (21, N'PartiallyValidated', N'en-GB',  @OrgID, N'PartiallyValidated', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=22)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (22, N'PartiallyApproved', N'en-GB',  @OrgID, N'PartiallyApproved', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=23)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (23, N'With Held', N'en-GB',  @OrgID, N'With Held', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=25)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (25, N'SampleLoaded', N'en-GB',  @OrgID, N'SampleLoaded', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=26)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (26, N'Second Opinion', N'en-GB',  @OrgID, N'Second Opinion', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=27)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (27, N'Opinion Given', N'en-GB',  @OrgID, N'Opinion Given', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=29)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (29, N'ReflexTest', N'en-GB',  @OrgID, N'ReflexTest', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=30)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (30, N'With-hold Completion', N'en-GB',  @OrgID, N'With-hold Completion', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=31)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (31, N'With-hold Validation', N'en-GB',  @OrgID, N'With-hold Validation', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=32)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (32, N'With-hold Approval', N'en-GB',  @OrgID, N'With-hold Approval', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=33)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (33, N'RejectClose', N'en-GB',  @OrgID, N'RejectClose', NULL, NULL, NULL, NULL)
if not exists(select 1 from InvStatusOrgMapping where OrgID=@OrgID and InvestigationStatusID=34)
INSERT [dbo].[InvStatusOrgMapping] ([InvestigationStatusID], [Status], [LangCode], [OrgID], [DisplayText], [createdat], [CreatedBy], [ModifiedAt], [ModifiedBy]) VALUES (34, N'ProblemSample', N'en-GB',  @OrgID, N'ProblemSample', NULL, NULL, NULL, NULL)
end
GO

insert into LanguageMaster values('en-GB',N'English');
insert into LanguageMaster values('ta-IN',N'?????');
insert into LanguageMaster values('id-ID',N'Bahasa Indonesia');
insert into LanguageMaster values('ar-SA',N'???????');
insert into LanguageMaster values('zh-CN',N'??');
insert into LanguageMaster values('vi-VN',N'Ti?ng Vi?t');
insert into LanguageMaster values('es-ES',N'Español');


----------------------------------------Scan In ---------------------------------------------
declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Scan In' and PageURL='/Lab/ScanIn.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Scan In','/Lab/ScanIn.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Scan In' and PageURL='/Lab/ScanIn.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='Scan In' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Scan In',0,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Scan In' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Accession' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

-------------------------------Scan Out -------------------------------------------

declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Scan Out' and PageURL='/Lab/ScanOut.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Scan Out','/Lab/ScanOut.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Scan Out' and PageURL='/Lab/ScanOut.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='Scan Out' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Scan Out',0,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Scan Out' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Accession' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

----------------------------------Sample Enquiery--------------------------------------------------------------------


declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Sample Enquiry' and PageURL='/Lab/SampleEnquiry.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Sample Enquiry','/Lab/SampleEnquiry.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Sample Enquiry' and PageURL='/Lab/SampleEnquiry.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='Sample Enquiry' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Sample Enquiry',0,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Sample Enquiry' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Accession' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

---------------------------------Page Context Master ------------------------------------------


declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Page Context Master' and PageURL='/Admin/PageContext.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Page Context Master','/Admin/PageContext.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Page Context Master' and PageURL='/Admin/PageContext.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='Page Context Master' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Scan Out',0,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Page Context Master' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

----------------------------------Analyzer Error Flag Mapping-----------------------------------------

declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Analyzer Error Flag Mapping' and PageURL='/Admin/ErrorFlagMappingMaster.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Analyzer Error Flag Mapping','/Admin/ErrorFlagMappingMaster.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Analyzer Error Flag Mapping' and PageURL='/Admin/ErrorFlagMappingMaster.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if (@orgid is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='Analyzer Error Flag Mapping' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Analyzer Error Flag Mapping',2,@OrgID,@PAgeID,'en-GB')
end
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Analyzer Error Flag Mapping' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go



/************Alex End**************/		   


/***Radha END***/


/* Add 'Cancel' in Status dropdown  for Visit DeFlag LALPATH org */
/***Radha START***/
Declare @ConfigKeyID Bigint
DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin

If (Select MAX(ConfigKeyID) FROM ConfigKeyMaster) IS NULL
BEGIN
	SET @ConfigKeyID = 0
END
ELSE
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster

IF NOT EXISTS(SELECT ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='Cancel')
BEGIN
	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal)
	SELECT @ConfigKeyID+1,'Cancel','Do you want to Cancel test individually ?','N'
END
IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM 
	JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID 
	WHERE CKM.ConfigKey='Cancel' AND COM.OrgID=@OrgID)
BEGIN
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster WHERE ConfigKey='Cancel'
	
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	SELECT @ConfigKeyID,'Y',@OrgID
END
END
/***Radha END***/
/************radha start  For visit search************/
--Entry faced from procedure integration
insert into ConfigKeyMaster(ConfigKeyID, ConfigKey,DisplayText,IsInternal,ValueType) SELECT MAX(ConfigkeyID) + 1 ,'HL7IntegrationisRequired','Do you push data from HL7 messages?','N','RDO' from ConfigKeyMaster
insert into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)SELECT MAX(ConfigkeyID),'Y',212 from ConfigKeyMaster

--Entry for column view based on org
insert into ConfigKeyMaster(ConfigKeyID, ConfigKey,DisplayText,IsInternal) SELECT MAX(ConfigkeyID) + 1 ,'IsColumnViewable','Do the column is Viewable for the Organization','N' from ConfigKeyMaster
insert into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)SELECT MAX(ConfigkeyID),'Y',212 from ConfigKeyMaster

/*************Radha end for visit search*************/

/*************sudha start*****************/
declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='InvStatusOrgPageMapping' and PageURL='/Admin/InvStatusOrgPageMapping.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'InvStatusOrgPageMapping','/Admin/InvStatusOrgPageMapping.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='InvStatusOrgPageMapping' and PageURL='/Admin/InvStatusOrgPageMapping.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin

if not Exists(select 1 from MenuMaster where DisplayText='InvStatusOrgPageMapping' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'InvStatusOrgPageMapping',2,@OrgID,@PAgeID,'en-GB')
end
END
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='InvStatusOrgPageMapping' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go


/******************************************************************************/




 if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%CollectSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','1','CollectSample','en-GB')
  end


  if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%RecieveSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','2','RecieveSample','en-GB')
  end
   if not exists( select * from metadata where domain like '%samplestatusmapping%'and DisplayText like '%AbbarentSample%')
  begin
  insert into MetaData (Domain,Code,DisplayText,LangCode)values('samplestatusmapping','3','AbbarentSample','en-GB')
  end

/*************sudha end ******************/



/*************Alex**********************/
declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Analyzer Error Flag Mapping Master' and PageURL='/Admin/ErrorFlagMappingMaster.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Analyzer Error Flag Mapping Master','/Admin/ErrorFlagMappingMaster.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Analyzer Error Flag Mapping Master' and PageURL='/Admin/ErrorFlagMappingMaster.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if(@OrgID is not null)
begin
if not Exists(select 1 from MenuMaster where DisplayText='Analyzer Error Flag Mapping Master' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Analyzer Error Flag Mapping Master',2,@OrgID,@PAgeID,'en-GB')
end
END
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Analyzer Error Flag Mapping Master' and Parentid=2 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go


----------------------------------------Scan In ---------------------------------------------
declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Scan In' and PageURL='/Lab/ScanIn.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Scan In','/Lab/ScanIn.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Scan In' and PageURL='/Lab/ScanIn.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if(@OrgID is not null)
begin
if not Exists(select 1 from MenuMaster where DisplayText='Scan In' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Scan In',0,@OrgID,@PAgeID,'en-GB')
end
END
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Scan In' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Accession' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

-------------------------------Scan Out -------------------------------------------

declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Scan Out' and PageURL='/Lab/ScanOut.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Scan Out','/Lab/ScanOut.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Scan Out' and PageURL='/Lab/ScanOut.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if(@OrgID is not null)
begin
if not Exists(select 1 from MenuMaster where DisplayText='Scan Out' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Scan Out',0,@OrgID,@PAgeID,'en-GB')
end
END
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Scan Out' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Accession' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

----------------------------------Sample Enquiery--------------------------------------------------------------------


declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Sample Enquiry' and PageURL='/Lab/SampleEnquiry.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Sample Enquiry','/Lab/SampleEnquiry.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Sample Enquiry' and PageURL='/Lab/SampleEnquiry.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if(@OrgID is not null)
begin
if not Exists(select 1 from MenuMaster where DisplayText='Sample Enquiry' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Sample Enquiry',0,@OrgID,@PAgeID,'en-GB')
end
END
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Sample Enquiry' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Accession' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

---------------------------------Page Context Master ------------------------------------------


declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Page Context Master' and PageURL='/Admin/PageContext.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Page Context Master','/Admin/PageContext.aspx','N')
END
Go
------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Page Context Master' and PageURL='/Admin/PageContext.aspx'
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if(@OrgID is not null)
begin
if not Exists(select 1 from MenuMaster where DisplayText='Page Context Master' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Page Context Master',0,@OrgID,@PAgeID,'en-GB')
end
END
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'
if(@OrgID is not null)
begin
select @menuId=MenuID from MenuMaster where DisplayText='Page Context Master' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
end
go

----------------------------------

/****************end*******************/


--Added as part of Delivery Queue START
--Edit Notification

declare @ActionID int
select @ActionID=max(ActionID) from ActionMaster

if not Exists (select 1 from ActionMaster where  ActionName='Edit Notification' and  ActionCode='Edit Notification')
BEGIN
INSERT INTO [dbo].[ActionMaster]([ActionID],[ActionName] ,[CreatedBy],[CreatedAt],[ModifiedBy],[ModifiedAt],[QueryString],[ActionCode],[ModuleID],[IsShareable],[LanguageCode])
     VALUES (@ActionID+1,'Edit Notification',NULL,NULL,NULL,NULL ,NULL ,'Edit Notification' ,NULL ,'N','en-GB')
END
GO

declare @PAgeID int
select @PAgeID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='Delivery Queue' and PageURL='/Admin/Notifications.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'Delivery Queue','/Admin/Notifications.aspx','N')
END
Go
declare @ActionID1 int
select @ActionID1=max(ActionID) from ActionMaster

DECLARE @RedirectPageID INT
select @RedirectPageID=pageID  FROM Pages WHERE PAGENAME='Delivery Queue'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

DECLARE @roleID int
select @roleID=RoleID from role where RoleName like 'Administrator' and orgid=@OrgID

DECLARE @roleID1 int
select @roleID1=RoleID from role where RoleName like 'Chief of Lab Services' and orgid=@OrgID

INSERT INTO [dbo].ActionRoleMapping([ActionID] ,[RoleID] ,[RedirectPageID] ,[SearchTypeID] ,[CreatedBy],[CreatedAt] ,[ModifiedBy],[ModifiedAt] ,[IsMapped] ,[isSplAuthorize])
     VALUES (@ActionID1,@roleID,@RedirectPageID,47,NULL,NULL,NULL,NULL,'Y',NULL)
	 
INSERT INTO [dbo].ActionRoleMapping([ActionID] ,[RoleID] ,[RedirectPageID] ,[SearchTypeID] ,[CreatedBy],[CreatedAt] ,[ModifiedBy],[ModifiedAt] ,[IsMapped] ,[isSplAuthorize])
     VALUES (@ActionID1,@roleID1,@RedirectPageID,47,NULL,NULL,NULL,NULL,'Y',NULL) 
GO


--Update Notification

declare @ActionID int
select @ActionID=max(ActionID) from ActionMaster

if not Exists (select 1 from ActionMaster where  ActionName='Update Notification' and  ActionCode='Update Notification')
BEGIN
INSERT INTO [dbo].[ActionMaster]([ActionID],[ActionName] ,[CreatedBy],[CreatedAt],[ModifiedBy],[ModifiedAt],[QueryString],[ActionCode],[ModuleID],[IsShareable],[LanguageCode])
     VALUES (@ActionID+1,'Update Notification',NULL,NULL,NULL,NULL ,NULL ,'Update Notification' ,NULL ,'N','en-GB')
END
GO

declare @ActionID1 int
select @ActionID1=max(ActionID) from ActionMaster

DECLARE @RedirectPageID INT
select @RedirectPageID=pageID  FROM Pages WHERE PAGENAME='Delivery Queue'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

DECLARE @roleID int
select @roleID=RoleID from role where RoleName like 'Administrator' and orgid=@OrgID

DECLARE @roleID1 int
select @roleID1=RoleID from role where RoleName like 'Chief of Lab Services' and orgid=@OrgID

INSERT INTO [dbo].ActionRoleMapping([ActionID] ,[RoleID] ,[RedirectPageID] ,[SearchTypeID] ,[CreatedBy],[CreatedAt] ,[ModifiedBy],[ModifiedAt] ,[IsMapped] ,[isSplAuthorize])
     VALUES (@ActionID1,@roleID,@RedirectPageID,47,NULL,NULL,NULL,NULL,'Y',NULL)
	 
INSERT INTO [dbo].ActionRoleMapping([ActionID] ,[RoleID] ,[RedirectPageID] ,[SearchTypeID] ,[CreatedBy],[CreatedAt] ,[ModifiedBy],[ModifiedAt] ,[IsMapped] ,[isSplAuthorize])
     VALUES (@ActionID1,@roleID1,@RedirectPageID,47,NULL,NULL,NULL,NULL,'Y',NULL) 
GO


--Added as part of Delivery Queue END



--As part od Delivery Queue START
--Pages

------------MenuMaster
Declare @Menuid int
Declare @Pageid int 
DECLARE @OrgID int

select @Menuid=max(Menuid)+1 from MenuMaster
select @Pageid=PageID from Pages where PageName='Delivery Queue' and PageURL='/Admin/Notifications.aspx'
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'


if not Exists(select 1 from MenuMaster where DisplayText='Delivery Queue' and OrgId=@OrgID and LanguageCode='en-GB')
begin
insert into MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,LanguageCode) values(@Menuid,'Delivery Queue',0,@OrgID,@PAgeID,'en-GB')
end
go
-----------RoleMenu
Declare @menuId int
Declare @roleId int
DECLARE @OrgID int

select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'
select @menuId=MenuID from MenuMaster where DisplayText='Delivery Queue' and Parentid=0 and OrgId=@OrgID
select @roleId=RoleId from Role where RoleName='Administrator' and OrgID=@OrgID and LangCode='en-GB'

if not Exists(select 1 from RoleMenu where MenuID=@menuId and RoleID=@roleId)
begin
insert into RoleMenu(MenuID,RoleID,IsMapped) values(@menuId,@roleId,'Y')
end
go

--As part od Delivery Queue END

/* Script for Investigation Report - PageContextActionMapping Table */
/* START  */

declare @PageID int
select @PageID=MAx(pageid)+1 from Pages

if not Exists (select 1 from Pages where  PageName='InvestigationReport' and PageURL='/Investigation/InvestigationReport.aspx')
BEgin
insert into Pages(PageID,PageName,PageURL,IsShareable) values(@PAgeID,'InvestigationReport','/Investigation/InvestigationReport.aspx','N')
END
Go

declare @GetPageID int
select @GetPageID=pageid from pages where pagename like 'InvestigationReport' and PageURL='/Investigation/InvestigationReport.aspx'

if not Exists (select 1 from PageContext where  PageID=@GetPageID and ButtonName='btnSaveToDispatch' and ButtionValue='Generate Report')
BEGIN
	INSERT INTO PageContext(PageID,ButtonName,ButtionValue) VALUES (@GetPageID,'btnSaveToDispatch','Generate Report')
END

--select * from PageContext where   ButtonName='btnSaveToDispatch' and ButtionValue='Generate Report'   71

declare @orgid int
select @orgid=OrgID from Organization where Name like 'IGENETIC - Ahmedabad%'

declare @GetPageContextID int
select @GetPageContextID=PageContextID from PageContext where  PageID=@GetPageID and ButtonName='btnSaveToDispatch' and ButtionValue='Generate Report'

declare @GetActionTypeID_0 int
select @GetActionTypeID_0=ActionTypeID from ActionManagerType where ActionType='Pdf' and IsDisplay='N'  --9


declare @GetActionTypeID_1 int
select @GetActionTypeID_1=ActionTypeID from ActionManagerType where ActionType='ROUNDBPDF'   --17

declare @GetRoleID int
select @GetRoleID=RoleID from role  where RoleName like '%Chief of Lab Services%' and Description like '%Chief of Lab Services%' and orgid=@orgid

declare @GetTemplateID_1 int
select @GetTemplateID_1=TemplateID from actiontemplate where TemplateName='CP_Report_pdf'  --22


declare @GetTemplateID_2 int
select @GetTemplateID_2=TemplateID from actiontemplate where TemplateName='REPORT_ROUNDBPDF'  --25


declare @GetTemplateID_3 int
select @GetTemplateID_3=TemplateID from actiontemplate where  TemplateName='P_Report_pdf'   --21



--ActionTypeID=9	TemplateID=22	ContextType=CP
if not exists (select * from PageContextActionMapping where RoleID= @GetRoleID and PageContextID =@GetPageContextID and ActionTypeID= @GetActionTypeID_0 
and TemplateID=@GetTemplateID_3 and ContextType='P' )
begin

insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
values(@GetPageContextID,@GetRoleID,@GetActionTypeID_0,@GetTemplateID_3,'P','Report','Y')
END

--ActionTypeID=17	TemplateID=25	ContextType=CP


if not exists (select * from PageContextActionMapping where RoleID= @GetRoleID and PageContextID =@GetPageContextID and ActionTypeID= @GetActionTypeID_0 
and TemplateID=@GetTemplateID_1 and ContextType='CP' )
begin
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
values(@GetPageContextID,@GetRoleID,@GetActionTypeID_0,@GetTemplateID_1,'CP','Report','Y')
END



if not exists (select * from PageContextActionMapping where RoleID= @GetRoleID and PageContextID =@GetPageContextID and ActionTypeID= @GetActionTypeID_1 
and TemplateID=@GetTemplateID_2 and ContextType='CP' )
begin
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
values(@GetPageContextID,@GetRoleID,@GetActionTypeID_1,@GetTemplateID_2,'CP','Report','Y')
END



if not exists (select * from PageContextActionMapping where RoleID= @GetRoleID and PageContextID =@GetPageContextID and ActionTypeID= @GetActionTypeID_1 
and TemplateID=@GetTemplateID_2 and ContextType='P' )
begin
insert into PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment)
values(@GetPageContextID,@GetRoleID,@GetActionTypeID_1,@GetTemplateID_2,'P','Report','Y')
END

/* END  */



--Investgation Report
-------------------------


--Script:

-------------------------------------------------------

declare @ActionID int
select @ActionID=max(ActionID) from ActionMaster

if not Exists (select 1 from ActionMaster where  ActionName='Show Report' and  ActionCode='Show_Report_InvestigationReport')
BEGIN
INSERT INTO [dbo].[ActionMaster]([ActionID],[ActionName] ,[CreatedBy],[CreatedAt],[ModifiedBy],[ModifiedAt],[QueryString],[ActionCode],[ModuleID],[IsShareable],[LanguageCode])
     VALUES (@ActionID+1,'Show Report',NULL,NULL,NULL,NULL ,NULL ,'Show_Report_InvestigationReport' ,NULL ,'N','en-GB')
END
GO

declare @ActionID1 int
select @ActionID1=max(ActionID) from ActionMaster where  ActionName='Show Report' and  ActionCode='Show_Report_InvestigationReport'

DECLARE @RedirectPageID INT
select @RedirectPageID=pageID  FROM Pages WHERE PAGENAME='InvestigationReport'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

DECLARE @roleID1 int
select @roleID1=RoleID from role where RoleName like 'Chief of Lab Services' and orgid=@OrgID
 
INSERT INTO [dbo].ActionRoleMapping([ActionID] ,[RoleID] ,[RedirectPageID] ,[SearchTypeID] ,[CreatedBy],[CreatedAt] ,[ModifiedBy],[ModifiedAt] ,[IsMapped] ,[isSplAuthorize])
     VALUES (@ActionID1,@roleID1,@RedirectPageID,4,NULL,NULL,NULL,NULL,'Y',NULL) 
GO
----------------------------------------------------------

declare @ActionID int
select @ActionID=max(ActionID) from ActionMaster

if not Exists (select 1 from ActionMaster where  ActionName='Generate Report' and  ActionCode='Generate_Report')
BEGIN
INSERT INTO [dbo].[ActionMaster]([ActionID],[ActionName] ,[CreatedBy],[CreatedAt],[ModifiedBy],[ModifiedAt],[QueryString],[ActionCode],[ModuleID],[IsShareable],[LanguageCode])
     VALUES (@ActionID+1,'Generate Report',NULL,NULL,NULL,NULL ,NULL ,'Generate_Report' ,NULL ,'N','en-GB')
END
GO

declare @ActionID1 int
select @ActionID1=max(ActionID) from ActionMaster where  ActionName='Generate Report' and  ActionCode='Generate_Report'

DECLARE @RedirectPageID INT
select @RedirectPageID=pageID  FROM Pages WHERE PAGENAME='InvestigationReport'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

DECLARE @roleID1 int
select @roleID1=RoleID from role where RoleName like 'Chief of Lab Services' and orgid=@OrgID
 
INSERT INTO [dbo].ActionRoleMapping([ActionID] ,[RoleID] ,[RedirectPageID] ,[SearchTypeID] ,[CreatedBy],[CreatedAt] ,[ModifiedBy],[ModifiedAt] ,[IsMapped] ,[isSplAuthorize])
     VALUES (@ActionID1,@roleID1,@RedirectPageID,4,NULL,NULL,NULL,NULL,'Y',NULL) 
GO

-------------------------------------------------------

/* Added as part of Investigation Report - Manual Report  */

/*  Add 'Interim' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTI' and DisplayText='Interim')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTI','Interim','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTI' and DisplayText='Interim'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Interim' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Interim')
END
Go
------------------------------------------------------

/*  Add 'Provision' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTP' and DisplayText='Provision')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTP','Provision','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTP' and DisplayText='Provision'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Provision' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Provision')
END
Go


-----------------------------------------------------------------------
/*  Add 'Duplicate' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTD' and DisplayText='Duplicate')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTD','Duplicate','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTD' and DisplayText='Duplicate'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Duplicate' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Duplicate')
END
Go


-----------------------------------------------------------------------
/*  Add 'Final' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTF' and DisplayText='Final')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTF','Final','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTF' and DisplayText='Final'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Final' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Final')
END
Go


-----------------------------------------------------------------------

/*  Add 'Amended' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTA' and DisplayText='Amended')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTA','Amended','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTA' and DisplayText='Amended'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Amended' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Amended')
END
Go


-----------------------------------------------------------------------

/* Added as part of Investigation Report - Manual Report  */

/*  Add 'Single' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTS' and DisplayText='Single')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTS','Single','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTS' and DisplayText='Single'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Single' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Single')
END
Go


-----------------------------------------------------------------------


/*  Add 'Cumulative' Report type into Metadata and MetaDataOrgMapping */

if not Exists (select 1 from Metadata where  Domain='NotificationReportType' and Code='NRTC' and DisplayText='Cumulative')
BEGIN
insert into Metadata(Domain,Code,DisplayText,LangCode,ParentID,SeqNo) values('NotificationReportType','NRTC','Cumulative','en-GB',NULL,NULL)
END
GO

declare @MetadataID1 int
select @MetadataID1=max(MetaDataID) from Metadata  where  Domain='NotificationReportType' and Code='NRTC' and DisplayText='Cumulative'

DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%IGENETIC - Ahmedabad%'

if not Exists (select 1 from MetaDataOrgMapping where DisplayText='Cumulative' and OrgID=@OrgID and MetadataID=@MetadataID1)
BEGIN
insert into MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText) values( @MetadataID1,@OrgID,'en-GB','Cumulative')
END
Go


-----------------------------------------------------------------------

Declare @ConfigKeyID Bigint
DECLARE @OrgID int
select @OrgID=OrgID from Organization where Name like '%LALPATH LABS%'

if(@OrgID is not null)
begin
If (Select MAX(ConfigKeyID) FROM ConfigKeyMaster) IS NULL
BEGIN
	SET @ConfigKeyID = 0
END
ELSE
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster

IF NOT EXISTS(SELECT ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='Revalidate')
BEGIN
	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal)
	SELECT @ConfigKeyID+1,'Revalidate','Do you want to hide audit for client?','N'
END
IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM 
	JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID 
	WHERE CKM.ConfigKey='Revalidate' AND COM.OrgID=@OrgID)
BEGIN
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster WHERE ConfigKey='Revalidate'
	
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	SELECT @ConfigKeyID,'Y',@OrgID
END
END
go
Declare @ConfigKeyID Bigint
DECLARE @OrgID int
select @OrgID=OrgID from Organization where orgid=98


If (Select MAX(ConfigKeyID) FROM ConfigKeyMaster) IS NULL
BEGIN
	SET @ConfigKeyID = 0
END
ELSE
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster

IF NOT EXISTS(SELECT ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='AtuoDocumentScanner')
BEGIN
	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal)
	SELECT @ConfigKeyID+1,'AtuoDocumentScanner','Do you want to atuo document scanner?','N'
END
IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM 
	JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID 
	WHERE CKM.ConfigKey='AtuoDocumentScanner' AND COM.OrgID=@OrgID)
BEGIN
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster WHERE ConfigKey='AtuoDocumentScanner'
	
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	SELECT @ConfigKeyID,'Y',@OrgID
END

go
Declare @ConfigKeyID Bigint
DECLARE @OrgID int
select @OrgID=OrgID from Organization where orgid=98


If (Select MAX(ConfigKeyID) FROM ConfigKeyMaster) IS NULL
BEGIN
	SET @ConfigKeyID = 0
END
ELSE
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster

IF NOT EXISTS(SELECT ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='AtuoDocumentScanner')
BEGIN
	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal)
	SELECT @ConfigKeyID+1,'AtuoDocumentScanner','Do you want to atuo document scanner?','N'
END
IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM 
	JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID 
	WHERE CKM.ConfigKey='AtuoDocumentScanner' AND COM.OrgID=@OrgID)
BEGIN
	Select @ConfigKeyID = MAX(ConfigKeyID) FROM ConfigKeyMaster WHERE ConfigKey='AtuoDocumentScanner'
	
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	SELECT @ConfigKeyID,'Y',@OrgID
END
------------------------------------------------------------------------------------------------------------------------
IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='PopupconfigorgidReport')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal ,ControlType ,ValueType ,ConfigType ) values
 (@GetconfigId,'PopupconfigorgidReport','PopupconfigorgidReports','N','','','') 
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',159)
end
---------------------------------------------------------------------------------------------------------------------------
GO
/* BEGIN | sabari | 20181129 | Dev | Culture Report */
/*PATERN INSERT SCRIPT*/
DECLARE @PatternID INT=65,@PatternName NVARCHAR(100)='~/Investigation/OrganismDrugPatternWithLevel.ascx',
@OrgID BIGINT=224,@DisplayText NVARCHAR(50)='OrganismDrugPatternWithLevel'
IF NOT EXISTS (SELECT 1 FROM InvestigationPattern WHERE PatternID=@PatternID AND PatternName=@PatternName AND ORGID=@OrgID )
BEGIN
INSERT INTO  InvestigationPattern(PatternID,PatternName,DisplayText,OrgID)
SELECT  @PatternID,@PatternName,@DisplayText,@OrgID
END
/* END | sabari | 20181129 | Dev | Culture Report */
GO
/* BEGIN | NA | Sabari | 20181202 | Created | MRP Apportioning WORKFLOW Add  */
DECLARE @pageID INT
DECLARE @OrgID INT
SET @OrgID= 224
---page insertion
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='OrganismLevelMapping')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'OrganismLevelMapping','/Admin/OrganismLevelMapping.aspx',GETDATE(),415 FROM Pages
END
--
SELECT top 1 @pageID=pageID FROM Pages WHERE PageName='OrganismLevelMapping'
--
IF Not Exists (SELECT 1 FROM Menumaster WHERE DisplayText='OrganismLevelMapping' and OrgID=@OrgId and PageID=@pageID)
BEGIN
INSERT INTO  Menumaster(DisplayText,CreatedAt,CreatedBy,Parentid,PageID,OrgID,LanguageCode,MenuID)
SELECT 'OrganismLevelMapping',GETDATE(),415,2,@pageID,@OrgID,'en-GB',MAX(MenuID)+1 FROM Menumaster
END
--
DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='OrganismLevelMapping'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='Administrator'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),415,'Y'
END
/* END | NA | Sabari | 20181202 | Created | MRP Apportioning WORKFLOW Add  */
GO


Page Mapping to Report
----------------------


DECLARE @RoleID BIGINT
DECLARE @PageID BIGINT
SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%'
SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Customization Page')
BEGIN
INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
VALUES(@PageID,'Customization Page','/Reports/CustomizationReport.aspx','N')
END

DECLARE @ReportID BIGINT
SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
SELECT @PageID=  PageID FROM Pages WHERE PageURL LIKE '/Reports/CustomizationReport.aspx' 

IF Not Exists (select 1 from ReportMaster where PageID=@PageID and ReportGroupID=1)
BEGIN
INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
VALUES(@ReportID,'Customization Report',
'/Reports/CustomizationReport.aspx','../Reports/CustomizationReport.aspx'
,1,405,GETDATE(),@PageID)
END

DECLARE @ReporID BIGINT
SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Customization Report'

If Not Exists(select 1 from ReportOrgMapping where ReportID=@ReporID  and RoleID=@RoleID)
BEGIN
Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
values (@ReporID, @RoleID,168,'Y')
END

-------------------------------------------------------------------------------------------------

Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Print Summary Report' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetSummaryReportField',168,'Print Summary Report'
END
Go
Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Visit Type Based Test Count' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetTestStatisticReportMIS',168,'Visit Type Based Test Count'
END
Go
Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Print Detailed Report' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetDetailedReportMIS',168,'Print Detailed Report'
END
Go

Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Visit Type Based Test Count' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetTestStatisticReportMIS',168,'Visit Type Based Test Count'
END
Go
Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Outsource Test report' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetOutSourceReportMIS',168,'Outsource Test report'
END
Go
Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Recollect Report' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetRecollectStatusReport',168,'Recollect Report'
END
Go
Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='Reject Report' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetRejectStatusReport',168,'Reject Report'
END
Go
Declare @ReportID int
Select @ReportID = ReportID from CustomisedReport where ReportName='OutSource Detailed Report' 
If not Exists ( select 1 from CustomisedReport where ReportID=@ReportID and Orgid=168)
BEGIN
Insert into CustomisedReport
select 'PGetOutSourceDetailReport',168,'OutSource Detailed Report'
END
Go
/* BEGIN | NA | Sabari | 06032019 | Created | InvestigationResultDeflagging */
go
DECLARE @pageID INT
DECLARE @OrgID INT
SELECT @OrgID=OrgID from organization where Name='Attune Demo' 
---page insertion
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='InvestigationResultDeflagging')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'InvestigationResultDeflagging','/Lab/InvestigationResultDeflagging.aspx',GETDATE(),415 FROM Pages
END
--
SELECT top 1 @pageID=pageID FROM Pages WHERE PageName='InvestigationResultDeflagging'
--
IF Not Exists (SELECT 1 FROM Menumaster WHERE DisplayText='Investigation ResultDeflag' and OrgID=@OrgId and PageID=@pageID)
BEGIN
INSERT INTO  Menumaster(DisplayText,CreatedAt,CreatedBy,Parentid,PageID,OrgID,LanguageCode,MenuID)
SELECT 'Investigation ResultDeflag',GETDATE(),415,0,@pageID,@OrgID,'en-GB',MAX(MenuID)+1 FROM Menumaster
END
--
DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='Investigation ResultDeflag'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='Doctor'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),415,'Y'
END
Go

/* END | NA | Sabari | 06032019 | Created | InvestigationResultDeflagging */
/* BEGIN | NA | Sabari | 03032019 | Created | InvestigationResultDeflagging */
------------------------------------------------------------------------
									/* DOCTOR */
-------------------------------------------------------------------------
--New Status Mapping ResultDeflag
DECLARE @Status NVARCHAR(200)='ResultDeflag' ,@Reason NVARCHAR(200)='ResultDeflag Reason' ,@DisplayText NVARCHAR(200)='ResultDeflag',
@InvestigationStatusID INT,@OrgID INT,@LangCode NVARCHAR(20)='en-GB',@CREATEDAT DATETIME=GETDATE() ,@CreatedBy BIGINT =415
IF NOT EXISTS (SELECT 1 FROM InvestigationStatus WHERE Status=@Status AND DisplayText=@DisplayText)
BEGIN
INSERT INTO  InvestigationStatus(InvestigationStatusID,Status,Reason,DisplayText,Sequence)
SELECT (SELECT MAX(InvestigationStatusID)+1 FROM InvestigationStatus),@Status,@Reason,@DisplayText,(SELECT MAX(Sequence)+1 FROM InvestigationStatus)
END

--New Status Mapping ResultDeflag against Org

SELECT @InvestigationStatusID=InvestigationStatusID FROM InvestigationStatus WHERE Status=@Status AND DisplayText=@DisplayText
SELECT @OrgID=OrgID from organization where Name='Attune Demo'  ---'Attune Demo' 
IF @OrgID IS NOT NULL AND @InvestigationStatusID IS NOT NULL
BEGIN
	IF NOT EXISTS (SELECT 1 FROM InvStatusOrgMapping WHERE InvestigationStatusID=@InvestigationStatusID AND Status=@Status AND OrgID=@OrgID AND DisplayText=@DisplayText)	
	BEGIN
	INSERT INTO InvStatusOrgMapping(InvestigationStatusID,Status,OrgID,LangCode,DisplayText,createdat,CreatedBy)
	SELECT @InvestigationStatusID,@Status,@OrgID,@LangCode,@DisplayText,@CREATEDAT,@CreatedBy
	END
END
ELSE
BEGIN
SELECT 'OrgID/Status was Empty'
END 

--New Status based Enter Rslt DropDownValues Load

IF NOT EXISTS (SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID=@InvestigationStatusID AND MappingID=5 AND  OrgID=@OrgID)
BEGIN 
INSERT INTO InvStatusmapping(InvestigationStatusID,MappingID,OrgID,SeqNo)
SELECT @InvestigationStatusID,5,@OrgID,1
END
IF NOT EXISTS (SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID=@InvestigationStatusID AND MappingID=12 AND  OrgID=@OrgID)
BEGIN 
INSERT INTO InvStatusmapping(InvestigationStatusID,MappingID,OrgID,SeqNo)
SELECT @InvestigationStatusID,12,@OrgID,(SELECT MAX(SeqNo)+1 FROM InvStatusmapping WHERE ORGID=@OrgID AND InvestigationStatusID=@InvestigationStatusID )
END
GO

/*   NEW STATUS BASED TASK CREATION SCRIPT */

DECLARE @ActionName NVARCHAR(100)='ResultDeflag',@RedirectURL NVARCHAR(2000)='~\Investigation\InvestigationApprovel.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}'
,@DisplayTextTemplate NVARCHAR(2000)='Approve ResultDeflag Result for {PatientName}({PatientNumber})(VisitNumber:{VisitNumber})',
@Category NVARCHAR(200)='Result Deflag',@OrgID INT,@RoleID BIGINT ,@TaskActionID BIGINT
,@LangCode NVARCHAR(20)='en-GB',@CREATEDAT DATETIME=GETDATE() ,@CreatedBy BIGINT =415
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName=@ActionName AND RedirectURL=@RedirectURL AND Category=@Category)
BEGIN
INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category,RoleID,ModuleID,Createdat,CreatedBy,LanguageCode)
SELECT  (SELECT MAX(TASKACTIONID)+1 FROM TaskActions),@ActionName,@RedirectURL,@DisplayTextTemplate,0,@Category,0,0,@CREATEDAT,@CreatedBy,@LangCode
END

SELECT @OrgID=OrgID from organization where Name='Attune Demo' 
SELECT @RoleID=ROLEID FROM Role WHERE ORGID=@OrgID AND RoleName='Doctor'
SELECT @TaskActionID=TaskActionID FROM TaskActions WHERE  ActionName=@ActionName AND RedirectURL=@RedirectURL AND Category=@Category
IF NOT EXISTS(SELECT 1 FROM TaskActionOrgMapping WHERE TaskActionID=@TaskActionID AND RoleID=@RoleID AND OrgID=@OrgID)
BEGIN
INSERT INTO TaskActionOrgMapping(TaskActionID,RoleID,OrgID)
SELECT @TaskActionID,@RoleID,@OrgID
END
GO
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
															/* SR LAB TECH */
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--New Status Mapping ResultDeflag
DECLARE @Status NVARCHAR(200)='ResultDeflags' ,@Reason NVARCHAR(200)='ResultDeflags Reason_SrLabTechRole' ,@DisplayText NVARCHAR(200)='ResultDeflag',
@InvestigationStatusID INT,@OrgID INT,@LangCode NVARCHAR(20)='en-GB',@CREATEDAT DATETIME=GETDATE() ,@CreatedBy BIGINT =415
IF NOT EXISTS (SELECT 1 FROM InvestigationStatus WHERE Status=@Status AND DisplayText=@DisplayText)
BEGIN
INSERT INTO  InvestigationStatus(InvestigationStatusID,Status,Reason,DisplayText,Sequence)
SELECT (SELECT MAX(InvestigationStatusID)+1 FROM InvestigationStatus),@Status,@Reason,@DisplayText,(SELECT MAX(Sequence)+1 FROM InvestigationStatus)
END

--New Status Mapping ResultDeflag against Org

SELECT @InvestigationStatusID=InvestigationStatusID FROM InvestigationStatus WHERE Status=@Status AND DisplayText=@DisplayText
SELECT @OrgID=OrgID from organization where Name='Attune Demo'  ---'Attune Demo' 
IF @OrgID IS NOT NULL AND @InvestigationStatusID IS NOT NULL
BEGIN
	IF NOT EXISTS (SELECT 1 FROM InvStatusOrgMapping WHERE InvestigationStatusID=@InvestigationStatusID AND Status=@Status AND OrgID=@OrgID AND DisplayText=@DisplayText)	
	BEGIN
	INSERT INTO InvStatusOrgMapping(InvestigationStatusID,Status,OrgID,LangCode,DisplayText,createdat,CreatedBy)
	SELECT @InvestigationStatusID,@Status,@OrgID,@LangCode,@DisplayText,@CREATEDAT,@CreatedBy
	END
END
ELSE
BEGIN
SELECT 'OrgID/Status was Empty'
END 

--New Status based Enter Rslt DropDownValues Load

IF NOT EXISTS (SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID=@InvestigationStatusID AND MappingID=5 AND  OrgID=@OrgID)
BEGIN 
INSERT INTO InvStatusmapping(InvestigationStatusID,MappingID,OrgID,SeqNo)
SELECT @InvestigationStatusID,5,@OrgID,1
END
IF NOT EXISTS (SELECT 1 FROM InvStatusmapping WHERE InvestigationStatusID=@InvestigationStatusID AND MappingID=12 AND  OrgID=@OrgID)
BEGIN 
INSERT INTO InvStatusmapping(InvestigationStatusID,MappingID,OrgID,SeqNo)
SELECT @InvestigationStatusID,12,@OrgID,(SELECT MAX(SeqNo)+1 FROM InvStatusmapping WHERE ORGID=@OrgID AND InvestigationStatusID=@InvestigationStatusID )
END
GO

/*   NEW STATUS BASED TASK CREATION SCRIPT */

DECLARE @ActionName NVARCHAR(100)='ResultDeflagSrLabTech',@RedirectURL NVARCHAR(2000)='~\Investigation\InvestigationApprovel.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}'
,@DisplayTextTemplate NVARCHAR(2000)='Validate ResultDeflag Result for {PatientName}({PatientNumber})(VisitNumber:{VisitNumber})',
@Category NVARCHAR(200)='Result Deflag',@OrgID INT,@RoleID BIGINT ,@TaskActionID BIGINT
,@LangCode NVARCHAR(20)='en-GB',@CREATEDAT DATETIME=GETDATE() ,@CreatedBy BIGINT =415
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName=@ActionName AND RedirectURL=@RedirectURL AND Category=@Category)
BEGIN
INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category,RoleID,ModuleID,Createdat,CreatedBy,LanguageCode)
SELECT  (SELECT MAX(TASKACTIONID)+1 FROM TaskActions),@ActionName,@RedirectURL,@DisplayTextTemplate,0,@Category,0,0,@CREATEDAT,@CreatedBy,@LangCode
END

SELECT @OrgID=OrgID from organization where Name='Attune Demo' 
SELECT @RoleID=ROLEID FROM Role WHERE ORGID=@OrgID AND RoleName='Doctor'
SELECT @TaskActionID=TaskActionID FROM TaskActions WHERE  ActionName=@ActionName AND RedirectURL=@RedirectURL AND Category=@Category
IF NOT EXISTS(SELECT 1 FROM TaskActionOrgMapping WHERE TaskActionID=@TaskActionID AND RoleID=@RoleID AND OrgID=@OrgID)
BEGIN
INSERT INTO TaskActionOrgMapping(TaskActionID,RoleID,OrgID)
SELECT @TaskActionID,@RoleID,@OrgID
END
GO
/* END | NA | Sabari | 03032019 | Created | InvestigationResultDeflagging */
/* BEGIN | NA | Sabari | 20190508 | Created | BulkEnterResult */
DECLARE @pageID INT
DECLARE @OrgID INT
SELECT @OrgID=OrgID FROM organization WHERE Name='Attune Demo'  
---page insertion
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='BulkEnterResult')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'BulkEnterResult','/Investigation/BulkEnterResult.aspx',GETDATE(),415 FROM Pages
END
--
SELECT top 1 @pageID=pageID FROM Pages WHERE PageName='BulkEnterResult'
--
IF Not Exists (SELECT 1 FROM Menumaster WHERE DisplayText='Bulk EnterResult' and OrgID=@OrgId and PageID=@pageID)
BEGIN
INSERT INTO  Menumaster(DisplayText,CreatedAt,CreatedBy,Parentid,PageID,OrgID,LanguageCode,MenuID)
SELECT 'Bulk EnterResult',GETDATE(),415,0,@pageID,@OrgID,'en-GB',MAX(MenuID)+1 FROM Menumaster
END
--
DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='Bulk EnterResult'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='Lab Technician'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),415,'Y'
END
Go
DECLARE @pageID INT
DECLARE @OrgID INT
SELECT @OrgID=OrgID FROM organization WHERE Name='Attune Demo'  
---page insertion
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='BulkEnterResult')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'BulkEnterResult','/Investigation/BulkEnterResult.aspx',GETDATE(),415 FROM Pages
END
--
SELECT top 1 @pageID=pageID FROM Pages WHERE PageName='BulkEnterResult'
--
IF Not Exists (SELECT 1 FROM Menumaster WHERE DisplayText='Bulk Validate' and OrgID=@OrgId and PageID=@pageID)
BEGIN
INSERT INTO  Menumaster(DisplayText,CreatedAt,CreatedBy,Parentid,PageID,OrgID,LanguageCode,MenuID)
SELECT 'Bulk Validate',GETDATE(),415,0,@pageID,@OrgID,'en-GB',MAX(MenuID)+1 FROM Menumaster
END
--
DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='Bulk Validate'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='SrLabTech'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),415,'Y'
END
Go
/* END | NA | Sabari | 20190508 | Created | BulkEnterResult */
/* BEGIN | NA | Sabari | 20181202 | Created | HOLD  */
DECLARE @pageID INT
DECLARE @OrgID INT
SELECT @OrgID=OrgID FROM organization WHERE Name='Attune Demo'  
---page insertion
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='HoldAndUnholdReports')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'HoldAndUnholdReports','/Lab/HoldAndUnholdReports.aspx',GETDATE(),415 FROM Pages
END
--
SELECT top 1 @pageID=pageID FROM Pages WHERE PageName='HoldAndUnholdReports'
--
IF Not Exists (SELECT 1 FROM Menumaster WHERE DisplayText='Hold And Unhold Reports' and OrgID=@OrgId and PageID=@pageID)
BEGIN
INSERT INTO  Menumaster(DisplayText,CreatedAt,CreatedBy,Parentid,PageID,OrgID,LanguageCode,MenuID)
SELECT 'Hold And Unhold Reports',GETDATE(),415,0,@pageID,@OrgID,'en-GB',MAX(MenuID)+1 FROM Menumaster
END
--
DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='Hold And Unhold Reports'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='Doctor'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),415,'Y'
END
Go
---Page Insertion:InvestigationApprovelOrHoldNew
DECLARE @pageID INT
DECLARE @OrgID INT
SET @OrgID= 224
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='InvestigationApprovelOrHoldNew')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'InvestigationApprovelOrHoldNew','/Investigation/InvestigationApprovelOrHoldNew.aspx',GETDATE(),415 FROM Pages
END
go
/* END | NA | Sabari | 20181202 | Created | HOLD */
/* BEGIN | NA | Sabari | 20181202 | Created | HOLD */
/*  Page Context insert for InvestigationApprovelOrHoldNew notification entry mapping  */

DECLARE @OrgID BIGINT,@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
IF NOT EXISTS(SELECT 1 FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID)
BEGIN
INSERT INTO PageContext(PageID,ButtonName,ButtionValue,CreatedBy,CreatedAt)
VALUES(@PageID,@ButtonName,@ButtionValue,@CreatedBy,@CreatedBy)
END
go
/*  PageContextActionMapping insert for InvestigationApprovelOrHoldNew notification entry mapping  */

--STEP 1 EMAIL
/*   Email MAPPING*/
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='CP'
DECLARE @ActionType VARCHAR(124)='Email',@ActionCode VARCHAR(50)='REPEMAIL'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='ReptEmail_C' AND TemplateID=14
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='P'
DECLARE @ActionType VARCHAR(124)='Email',@ActionCode VARCHAR(50)='REPEMAIL'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='ReptEmail_P' AND TemplateID=3
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO

--STEP 2 PDF

DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='P'
DECLARE @ActionType VARCHAR(124)='Pdf',@ActionCode VARCHAR(50)=NULL
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND ActionTypeID=9 --AND ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='P_Report_pdf' 
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO

DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='CP'
DECLARE @ActionType VARCHAR(124)='Pdf',@ActionCode VARCHAR(50)=NULL
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND ActionTypeID=9 --AND ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='CP_Report_pdf' 
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO

--STEP 3 SMS
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='CP'
DECLARE @ActionType VARCHAR(124)='Sms',@ActionCode VARCHAR(50)='RSMS'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND  ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='RSMS_P'  AND TemplateID=54
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','N',@CreatedAt,@CreatedBy)
END
GO
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='P'
DECLARE @ActionType VARCHAR(124)='Sms',@ActionCode VARCHAR(50)='RSMS'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND  ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='RSMS_P'  AND TemplateID=54
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','N',@CreatedAt,@CreatedBy)
END
GO

--STEP 4  TATPDF

DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='P'
DECLARE @ActionType VARCHAR(124)='ISSTATPDF',@ActionCode VARCHAR(50)='ISSTATPDF'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND  ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='REPORT_STATPDF'  AND TemplateID=24
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='CP'
DECLARE @ActionType VARCHAR(124)='ISSTATPDF',@ActionCode VARCHAR(50)='ISSTATPDF'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND  ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='REPORT_STATPDF'  AND TemplateID=24
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO

--STEP 5 ROUNDBPDF
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='P'
DECLARE @ActionType VARCHAR(124)='ROUNDBPDF',@ActionCode VARCHAR(50)='ROUNDBPDF'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND  ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='REPORT_ROUNDBPDF'  AND TemplateID=25
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
GO
DECLARE @ActionTypeID INT,@TemplateID INT,@RoleID BIGINT,@OrgID BIGINT,@PageContextID INT,
@RoleName NVARCHAR(50)='Doctor',@PageName NVARCHAR(50)='InvestigationApprovelOrHoldNew',@PageID BIGINT,
@ButtonName NVARCHAR(100)='btnSaveToDispatch',@ButtionValue NVARCHAR(200)='Save And Home',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @PageID=PageID  FROM Pages WHERE  PageName=@PageName 
SELECT @PageContextID=PageContextID FROM PageContext WHERE ButtonName=@ButtonName AND ButtionValue=ButtionValue AND PageID=@PageID
DECLARE @ContextType NVARCHAR(50)='CP'
DECLARE @ActionType VARCHAR(124)='ROUNDBPDF',@ActionCode VARCHAR(50)='ROUNDBPDF'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
SELECT @ActionTypeID= ActionTypeID FROM  ActionManagerType WHERE ActionType=@ActionType AND  ActionCode=@ActionCode 
SELECT @TemplateID=TemplateID FROM ActionTemplate WHERE TemplateName='REPORT_ROUNDBPDF'  AND TemplateID=25
IF NOT EXISTS(SELECT 1 FROM PageContextActionMapping WHERE ActionTypeID=@ActionTypeID 
AND TemplateID=@TemplateID AND ContextType=@ContextType AND PageContextID=@PageContextID  and RoleID=@RoleID)
BEGIN
INSERT INTO PageContextActionMapping(PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
VALUES(@PageContextID,@RoleID,@ActionTypeID,@TemplateID,@ContextType,'Report','Y',@CreatedAt,@CreatedBy)
END
go
/* END | NA | Sabari | 20181202 | Created | HOLD */
/* BEGIN | NA | Sabari | 20181202 | Created | HOLD */
DECLARE @OrgID BIGINT,@ActionName NVARCHAR(100)='UnHold',@PageID BIGINT,
@Category NVARCHAR(100)='UnHold',@LanguageCode NVARCHAR(100)= 'en-GB',@RoleName NVARCHAR(50)='Doctor',
@RedirectURL NVARCHAR(200)='~\Investigation\InvestigationApprovelOrHoldNew.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}&tid={TaskID}',
@DisplayTextTemplate NVARCHAR(200)='UnHold Investigation Result for {PatientName}({PatientNumber})(VisitNumber:{VisitNumber})',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415,
@TaskActionID BIGINT,@RoleID BIGINT
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName=@ActionName AND Category=@Category AND RedirectURL=@RedirectURL)
BEGIN
INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category,RoleID,ModuleID,Createdat,CreatedBy,LanguageCode)
SELECT  (SELECT MAX(TASKACTIONID)+1 FROM TaskActions),@ActionName,@RedirectURL,@DisplayTextTemplate,0,@Category,0,0,@CreatedAt,@CreatedBy,@LanguageCode
END
SELECT TOP 1 @TaskActionID=TaskActionID  FROM  TaskActions WHERE Category=@Category AND ActionName=@ActionName AND  RedirectURL=@RedirectURL
IF NOT EXISTS(SELECT 1 FROM TaskActionOrgMapping WHERE TaskActionID=@TaskActionID AND OrgID=@OrgID AND RoleID=@RoleID)
BEGIN
INSERT INTO TaskActionOrgMapping(TaskActionID,RoleID,OrgID,CreatedBy,CreatedAt)
SELECT  @TaskActionID,@RoleID,@OrgID,@CreatedBy,@CreatedAt
END
GO
/* END | NA | Sabari | 20181202 | Created | HOLD */
/* BEGIN | NA | Sabari | 20181202 | Created | HOLD */
DECLARE @OrgID BIGINT,@ActionName NVARCHAR(100)='Hold',@PageID BIGINT,
@Category NVARCHAR(100)='Hold',@LanguageCode NVARCHAR(100)= 'en-GB',@RoleName NVARCHAR(50)='Doctor',
@RedirectURL NVARCHAR(200)='~\Investigation\InvestigationApprovelOrHoldNew.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}&tid={TaskID}',
@DisplayTextTemplate NVARCHAR(200)='Hold Investigation Result for {PatientName}({PatientNumber})(VisitNumber:{VisitNumber})',
@CreatedAt DATETIME= GETDATE(),@CreatedBy BIGINT=415,
@TaskActionID BIGINT,@RoleID BIGINT
SELECT  @OrgID= OrgID FROM Organization WHERE NAME='Attune Demo'
SELECT @RoleID=RoleID  FROM Role WHERE  RoleName=@RoleName AND OrgID=@OrgID
IF NOT EXISTS(SELECT 1 FROM TaskActions WHERE ActionName=@ActionName AND Category=@Category AND RedirectURL=@RedirectURL)
BEGIN
INSERT INTO TaskActions(TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,OrgID,Category,RoleID,ModuleID,Createdat,CreatedBy,LanguageCode)
SELECT  (SELECT MAX(TASKACTIONID)+1 FROM TaskActions),@ActionName,@RedirectURL,@DisplayTextTemplate,0,@Category,0,0,@CreatedAt,@CreatedBy,@LanguageCode
END
SELECT TOP 1 @TaskActionID=TaskActionID  FROM  TaskActions WHERE Category=@Category AND ActionName=@ActionName AND  RedirectURL=@RedirectURL
IF NOT EXISTS(SELECT 1 FROM TaskActionOrgMapping WHERE TaskActionID=@TaskActionID AND OrgID=@OrgID AND RoleID=@RoleID)
BEGIN
INSERT INTO TaskActionOrgMapping(TaskActionID,RoleID,OrgID,CreatedBy,CreatedAt)
SELECT  @TaskActionID,@RoleID,@OrgID,@CreatedBy,@CreatedAt
END
GO
/* END | NA | Sabari | 20181202 | Created | HOLD */

------------------ Seetha Start - Report Readiness SMS related Script & Critical SMS---------------------------------

IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedRefDoctor_MobileNo')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal) values
 (@GetconfigId,'NeedRefDoctor_MobileNo','Is Need Ref. Doctor mobile no. to send SMS? ','Y')
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',233)
end

----

If Not Exists(select 1 from ClientAttributes where AttributesType='Notify' and Attributecode='CL_SMS')
BEGIN
Insert into ClientAttributes (AttributeName,AttributeCode,AttributesType)
Select 'Client Patient SMS','CL_SMS','Notify'
END

IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedClientLevel_PatientSMS')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal) values
 (@GetconfigId,'NeedClientLevel_PatientSMS','Is Patient SMS sent to client level ? ','Y')
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',233)
end
 ------------

IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedDeptLevel_PatientSMS')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal) values
 (@GetconfigId,'NeedDeptLevel_PatientSMS','Is Patient SMS sent to Dept level ? ','Y')
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',233)
end

-----------

IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedOrgLevel_PatientSMS')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal) values
 (@GetconfigId,'NeedOrgLevel_PatientSMS','Is Patient SMS sent to Org level ? ','Y')
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',233)
end

----------------------------------------------- Seetha End  ---------------------------------------------------------
IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='BarcodePrintCollectSample')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal ,ControlType ,ValueType ,ConfigType ) values
 (@GetconfigId,'BarcodePrintCollectSample','BarcodePrintCollectSample','N','','','') 
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',233)
end

----------------------------------------------------------------------------------



IF NOT EXISTS(SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedDeptLevel_Email')
BEGIN
declare @GetconfigId int
select @GetconfigId=MAX(configkeyid)+1 from ConfigKeyMaster 
insert into ConfigKeyMaster(ConfigKeyID ,ConfigKey ,DisplayText ,IsInternal) values
 (@GetconfigId,'NeedDeptLevel_Email','Is Patient Email sent to Dept level ? ','Y')
 
 insert Into ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID) values (@GetconfigId,'Y',168)
end
GO

 DECLARE @OrgID INT,@MetaDataID INT
 SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Diag%'
  
 IF NOT EXISTS (SELECT  1 FROM MetaData (NOLOCK) WHERE Domain='ReportLanguage' AND Code='en-GB' AND DisplayText='English')
 BEGIN
    INSERT INTO MetaData (Domain,Code,DisplayText,LangCode,CreatedAt,CreatedBy)
	SELECT 'ReportLanguage','en-GB','English','en-GB',GETDATE(),182   
 END

 SELECT @MetaDataID =MetaDataID FROM MetaData WHERE Domain='ReportLanguage' AND Code='en-GB' AND DisplayText='English'
 IF NOT EXISTS (SELECT  1 FROM MetaDataOrgMapping (NOLOCK) WHERE LangCode='en-GB'  AND MetadataID=@MetaDataID AND DisplayText='English' AND OrgID=@OrgID)
 BEGIN
    INSERT INTO MetaDataOrgMapping (MetaDataID,DisplayText,LangCode,OrgID,CreatedAt,CreatedBy)
	SELECT @MetaDataID,'English','en-GB',@OrgID,GETDATE(),182   
 END
  
 IF NOT EXISTS (SELECT  1 FROM MetaData (NOLOCK) WHERE Domain='ReportLanguage' AND Code='en-VI' AND DisplayText='Vietnamese')
 BEGIN
    INSERT INTO MetaData (Domain,Code,DisplayText,LangCode,CreatedAt,CreatedBy)
	SELECT 'ReportLanguage','en-VI','Vietnamese','en-GB',GETDATE(),182   
 END

 SELECT @MetaDataID =MetaDataID FROM MetaData WHERE Domain='ReportLanguage' AND Code='en-VI' AND DisplayText='Vietnamese'
 IF NOT EXISTS (SELECT  1 FROM MetaDataOrgMapping (NOLOCK) WHERE LangCode='en-GB' AND MetadataID=@MetaDataID AND DisplayText='Vietnamese' AND OrgID=@OrgID)
 BEGIN
    INSERT INTO MetaDataOrgMapping (MetaDataID,DisplayText,LangCode,OrgID,CreatedAt,CreatedBy)
	SELECT @MetaDataID,'Vietnamese','en-GB',@OrgID,GETDATE(),182   
 END

 
 IF NOT EXISTS (SELECT  1 FROM MetaData (NOLOCK) WHERE Domain='ReportLanguage' AND Code='en-FR' AND DisplayText='French')
 BEGIN
    INSERT INTO MetaData (Domain,Code,DisplayText,LangCode,CreatedAt,CreatedBy)
	SELECT 'ReportLanguage','en-FR','French','en-GB',GETDATE(),182   
 END

 SELECT @MetaDataID =MetaDataID FROM MetaData WHERE Domain='ReportLanguage' AND Code='en-FR' AND DisplayText='French'
 IF NOT EXISTS (SELECT  1 FROM MetaDataOrgMapping (NOLOCK) WHERE LangCode='en-GB'  AND MetadataID=@MetaDataID AND DisplayText='French' AND OrgID=@OrgID)
 BEGIN
    INSERT INTO MetaDataOrgMapping (MetaDataID,DisplayText,LangCode,OrgID,CreatedAt,CreatedBy)
	SELECT @MetaDataID,'French','en-GB',@OrgID,GETDATE(),182   
 END
 
 GO
 
 
 DECLARE @OrgID INT , @ConfigkeyID INT 
 SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Diag%'

 SELECT @ConfigkeyID=MAX(ConfigkeyID)+1 FROM ConfigkeyMaster 
 
 IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE Configkey='LanguageBasedReport' AND DisplayText='Do you want to print report based on language?')
 BEGIN
    INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,CreatedAt,CreatedBy)
	SELECT @ConfigkeyID,'LanguageBasedReport','Do you want to print report based on language?','N',GETDATE(),182 
 END

 SELECT @ConfigkeyID=ConfigkeyID FROM   ConfigKeyMaster WHERE Configkey='LanguageBasedReport' AND DisplayText='Do you want to print report based on language?'
 IF NOT EXISTS (SELECT  1 FROM ConfigOrgMaster WHERE  ConfigkeyID=@ConfigkeyID AND OrgID=@OrgID)
 BEGIN
	INSERT INTO ConfigOrgMaster (ConfigkeyID,Configvalue,orgID,CreatedAT,Createdby)
	SELECT @ConfigkeyID,'Y',@OrgID,GETDATE(),182
 END
 
 GO
 DECLARE @OrgID INT,@RoleID BIGINT,@ActionID INT,@PageID INT,@SearchTypeID INT
SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Diag%'
SELECT @RoleID=ROleID FROM Role WHERE RoleName='Dispatch Controller' AND OrgID=@OrgID
SELECT @PageID=PageID FROM Pages where PageURL='/Investigation/InvestigationReport.aspx'
SELECT @SearchTypeID=SearchTypeID FROM SearchTypeMaster Where SearchTypeName='Lab'


SELECT  @ActionID=MAX(ActionID)+1 FROM ActionMaster 
IF NOT EXISTS (SELECT 1 FROM ActionMaster WHERE ActionName='Manual Generate Report' AND ActionCode='Manual_Generate_Report')
BEGIN
	INSERT INTO ActionMaster (ActionID,ActionName,ActionCode,IsShareable,LanguageCode,CreatedAt,CreatedBy)
	SELECT @ActionID,'Manual Generate Report','Manual_Generate_Report','N','en-GB',GETDATE(),182
END

SELECT @ActionID=ActionID FROM ActionMaster WHERE ActionName='Manual Generate Report' AND ActionCode='Manual_Generate_Report'

IF NOT EXISTS (SELECT 1 FROm ActionRoleMapping WHERE ActionID=@ActionID AND RoleID =@RoleID AND RedirectPageID=@PageID AND SearchTypeID=@SearchTypeID )
BEGIN
	INSERT INTO ActionRoleMapping(ActionID,RoleID,RedirectPageID,SearchTypeID,Createdat,Createdby,ismapped)
	SELECT @ActionID, @RoleID,@PageID,@SearchTypeID,GETDATE(),182,'Y'
END
GO


IF NOT EXISTS(SELECT 1 FROM InvestigationPattern WHERE DisplayText='TablepatternV2')
BEGIN 
	insert into InvestigationPattern(PatternID,PatternName,DisplayText,OrgID)
	select 69,'~/Investigation/TablePatternV2.ascx','TablepatternV2',159
END
GO 


------- Config Script for Clinical History ------

Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='EnablehistoryforTest')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'EnablehistoryforTest','Do you want show history for test level?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='EnablehistoryforTest'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='EnablehistoryforTest' AND COM.OrgID=168)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',168,GETDATE())
				END


				IF not Exists (select 1 from Actionmaster where Actionname='Edit Clinical History' and ActionCode = 'Edit_Clinical_History')
BEGIN
Insert into ActionMaster (ActionID,ActionName,QueryString,ActionCode,IsShareable,LanguageCode)
Select (MAx(ActionID)+1),'Edit Clinical History','../Billing/LabQuickBilling.aspx?PID={PatientID}&VID={PatientVisitID}&PNAME={PatientName}&ISClinicHistory=Y','Edit_Clinical_History','Y','en-GB' from ActionMaster
END


Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='ShowInstructionForTest')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'ShowInstructionForTest','Do you want show Instruction for test level?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='ShowInstructionForTest'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='ShowInstructionForTest' AND COM.OrgID=168)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',168,GETDATE())
				END
---------------------------- End ---------------------

IF NOT EXISTS(SELECT 1 FROM DatePatternValue WHERE OrgID=202 AND PatternType='YY')
BEGIN 
	INSERT INTO DatePatternValue(OrgID,PatternType,[Key],[Value])
	SELECT 202,'YY','20','A'
	UNION ALL 
	SELECT 202,'YY','21','B'
	UNION ALL 
	SELECT 202,'YY','22','C'
	UNION ALL 
	SELECT 202,'YY','23','D'
	UNION ALL 
	SELECT 202,'YY','24','E'
	UNION ALL 
	SELECT 202,'YY','25','F'
	UNION ALL 
	SELECT 202,'YY','26','G'
	UNION ALL 
	SELECT 202,'YY','27','I'
END 
GO 
IF NOT EXISTS(SELECT 1 FROM DatePatternValue WHERE OrgID=202 AND PatternType='MM')
BEGIN 
	INSERT INTO DatePatternValue(OrgID,PatternType,[Key],[Value])
	SELECT 202,'MM','01','A'
	UNION ALL 
	SELECT 202,'MM','02','B'
	UNION ALL 
	SELECT 202,'MM','03','C'
	UNION ALL 
	SELECT 202,'MM','04','D'
	UNION ALL 
	SELECT 202,'MM','05','E'
	UNION ALL 
	SELECT 202,'MM','06','F'
	UNION ALL 
	SELECT 202,'MM','07','G'
	UNION ALL 
	SELECT 202,'MM','08','I'
	UNION ALL 
	SELECT 202,'MM','09','J'
	UNION ALL 
	SELECT 202,'MM','10','K'
	UNION ALL 
	SELECT 202,'MM','11','M'
	UNION ALL 
	SELECT 202,'MM','12','N'
END 
GO 

-------- Lab code Config -------------
DECLARE @OrgID INT,@ConfigKeyID INT

SELECT @OrgID =202

SELECT @ConfigKeyID=MAX(ConfigkeyID)+1 FROM ConfigkeyMaster
IF NOT EXISTS (SELECT 1 FROM ConfigkeyMaster WHERE Configkey='NeedLabCodeforTest' )
BEGIN
INSERT INTO ConfigkeyMaster (ConfigkeyID,Configkey,DisplayText,IsInternal,CreatedAt,CreatedBy)
SELECT @ConfigKeyID,'NeedLabCodeforTest','Lab Code for Each test ?','N',getdate(),405
END
SELECT @ConfigKeyID=ConfigkeyID FROM ConfigkeyMaster WHERE Configkey='NeedLabCodeforTest'
 
IF NOT EXISTS (SELECT 1 FROM  ConfigOrgMaster WHERE ConfigkeyID=@ConfigKeyID AND OrgID=@OrgID AND @OrgID>0 )
BEGIN
 INSERT INTO ConfigOrgMaster (ConfigkeyID,OrgID,ConfigValue,CreatedAt)
 SELECT @ConfigKeyID,@OrgID,'Y',GETDATE()
END
 
GO



DECLARE @MaxID INT;

SELECT @MaxID=MAX(ConfigKeyID)+1 FROM ConfigKeyMaster
select @MaxID
IF NOT EXISTS (SELECT 1 FROM ConfigkeyMaster WHERE Configkey='OutSourceReportspdffolderpath' )
BEGIN
INSERT INTO configkeymaster(ConfigKeyID,Configkey,DisplayText)
SELECT @MaxID,'OutSourceReportspdffolderpath','Which folder do you want to move?'

INSERT INTO ConfigOrgMaster(ConfigkeyID,ConfigValue,OrgID)
SELECT @MaxID,'E:\\Attune\\RLSOutSourceProcessedPdf\\',202
END

SELECT @MaxID=MAX(ConfigKeyID)+1 FROM ConfigKeyMaster
select @MaxID
IF NOT EXISTS (SELECT 1 FROM ConfigkeyMaster WHERE Configkey='OutSourceReportpdfprocessfolderpath' )
BEGIN
INSERT INTO configkeymaster(ConfigKeyID,Configkey,DisplayText)
SELECT @MaxID,'OutSourceReportpdfprocessfolderpath','Do you want to merge outsource pdf?'

INSERT INTO ConfigOrgMaster(ConfigkeyID,ConfigValue,OrgID)
SELECT @MaxID,'E:\\Attune\\RLSOutSourcePdf\\',202
END

IF NOT EXISTS (SELECT 1 FROM invreportmaster WHERE ReportTemplateName='OUTSOURCE' AND OrgID=202 )
BEGIN
INSERT INTO invreportmaster(TemplateID,ReportTemplateName,Isdefault,OrgID,IsActive,Type)
SELECT MAX(TemplateID)+1,'OUTSOURCE','N',202,'A','OUTSOURCE' FROM invreportmaster WHERE OrgID=202
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='authId')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','authId','rls',0,GETDATE(),182  
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='authToken')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','authToken','0asZOJYRjgEydqOO9Op89w',0,GETDATE(),182
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='StructUrl')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','StructUrl','https://qa3files.healthhub.net.in/HealthHubWebServices/uploadStructureData',0,GETDATE(),182 
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='reportpdffolderpath')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','reportpdffolderpath','E:\Liskernel-demo\LISPDF',0,GETDATE(),182  
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='PDFUploadURL')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','PDFUploadURL','https://qa3files.healthhub.net.in/HealthHubWebServices/uploadMedicalRecord',0,GETDATE(),182 
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='SmartreportUrl')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','SmartreportUrl','https://api.dev.health.jiolabs.com/smart-report-computation-service/computation/',0,GETDATE(),182  
END  

Declare @OrgID bigint,@CreatedAt DATETIME,@CreatedBy BIGINT,@RoleID bigint
	select top 1 @OrgID=OrgID from organization where Name = 'RLS-Gorakhpur'
	SELECT @CreatedAt=GETDATE(),@CreatedBy=189
	select @RoleID=max(RoleID+1) from Role where OrgID=@OrgID AND RoleID like '%66%'
	if(@OrgID is not null)
	Begin
	if not Exists(select 1 from Role where RoleName='Scheduler' and OrgID=@OrgID  AND LangCode='en-GB')
	Begin
		insert into Role (RoleID,RoleName,Description,OrgID,CreatedAt,CreatedBy,LangCode) values(
		 @RoleID,'Scheduler','Scheduler',@OrgID,@CreatedAt,@CreatedBy,'en-GB' )
	End
	end
	Go


CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='RLS-Gorakhpur' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Home Collection - Task Scheduling',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO



CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='RLS-Gorakhpur' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Home Collection - Task Scheduling',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO


Declare @PageID bigint
Declare @PageName NVarchar(250)
Declare @PageURL NVarchar(500)
SET @PageName='Home Collection - Task Scheduling'
SET @PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
If Not Exists(Select 1 from Pages Where PageName=@PageName and ISNULL(PageURL,'')=@PageURL)
begin
	----set @PageID=1--Max(PageID)+1 from Pages ---- use when truncate the pages table
	select @PageID=Max(PageID)+1 from Pages
	Insert into Pages(PageID,PageName,PageURL,CreatedBy,CreatedAt) values (@PageID,@PageName,@PageURL,0,GETDATE())
end
SELECT @PageID =PageID FROM  Pages where pagename=@PageName and ISNULL(PageURL,'')=@PageURL
IF NOT EXISTS (Select 1 FROM PageLangMapping where Pageid=@PageID and Langcode='en-GB')
BEGIN
INSERT INTO PageLangMapping (PageID,DisplayText,LangCode,CreatedAt,CreatedBy)select @PageID,@PageName,'en-GB',getdate(),100
End
go


CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='RLS Mumbai' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Home Collection - Task Scheduling',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO



CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='RLS Mumbai' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Home Collection - Task Scheduling',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO


Declare @OrgID bigint,@CreatedAt DATETIME,@CreatedBy BIGINT,@RoleID bigint
	select top 1 @OrgID=OrgID from organization where Name = 'RLS Mumbai'
	SELECT @CreatedAt=GETDATE(),@CreatedBy=189
	select @RoleID=max(RoleID+1) from Role where OrgID=@OrgID --AND RoleID like '%66%'
	if(@OrgID is not null)
	Begin
	if not Exists(select 1 from Role where RoleName='Scheduler' and OrgID=@OrgID  AND LangCode='en-GB')
	Begin
		insert into Role (RoleID,RoleName,Description,OrgID,CreatedAt,CreatedBy,LangCode) values(
		 @RoleID,'Scheduler','Scheduler',@OrgID,@CreatedAt,@CreatedBy,'en-GB' )
	End
	end
	Go
	
	DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationQuickApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApprove'
SET @ButtonValue='Approve'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|Investigation.pdf|{VisitNumber}|{Name}|{Date}|{Time}','reportmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|Investigation.pdf|{VisitNumber}|{Name}|{Date}|{Time}','reportmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}|','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

/** **/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}|','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='WhatPatientRegistration'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Generate Work Order'
SET @ButtonValue='btnFinish'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END
 

/***/

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END
 

/***/



 /*** ***/

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO B2B' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END
 /***/
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationQuickApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApprove'
SET @ButtonValue='Approve'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|{VisitNumber}|{Date}|{Time}','reportreadinessSMS','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|{VisitNumber}|{Date}|{Time}','reportreadinessSMS','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/BatchwiseEnterresult.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSave'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/BatchwiseEnterresult.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Button2'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Lab/InvestigationSample.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl+'%'
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='WhatSampleReject'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Phlebotomist' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
  
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Lab/DeptSamplesCollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSubmit'
SET @ButtonValue='Submit'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl+'%'
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Accession' AND OrgID=@OrgID
SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 
 GO
  
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='Lab/PendingSampleCollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnOK'
SET @ButtonValue='OK'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl+'%'
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Phlebotomist' AND OrgID=@OrgID
SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Accession' AND OrgID=@OrgID
SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO 
 
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationResultsCapture.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApproval1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationResultsCapture.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApproval'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='SrLabTech' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='SrLabTech' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSave'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Name}|{VisitNumber}|{BookingNo}','bookingconfirmation',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO Home Visit' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','bookingassigned',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','bookingassigned',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Reason}','cancelbooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Reason}','cancelbooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','updatedbookinginfo',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','updatedbookinginfo',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/** **/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Generate Work Order'
SET @ButtonValue='btnFinish'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END
 

/***/

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END
 

/***/



 /*** ***/

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO B2B' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END
------------------------arun changes start- disabled the check box in invstatuschange screen------------------------------

DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'DisabledSelect')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'DisabledSelect','InvStatusChangescreen','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'DisabledSelect')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 244)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',244)
END
------------------------arun changes end- disabled the check box in invstatuschange screen------------------------------
--------- Outsource Round PDF Merge --------------

Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='OutSourceReportRoundpdfprocessfolderpath')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'OutSourceReportRoundpdfprocessfolderpath','Which  folder you want to move processed outsource Round pdf?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='OutSourceReportRoundpdfprocessfolderpath'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='OutSourceReportRoundpdfprocessfolderpath' AND COM.OrgID=202)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'E:\\Attune\\RLSOutSourceProcessedRoundPdf\\',202,GETDATE())
				END
				GO

				Declare @ConfigKeyID bigint

                IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='OutSourceReportsRoundpdffolderpath')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'OutSourceReportsRoundpdffolderpath','Which folder do you want to move Round PDF?','N','N')
				END
			   SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='OutSourceReportsRoundpdffolderpath'
			   IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='OutSourceReportsRoundpdffolderpath' AND COM.OrgID=202)
			   BEGIN
			   INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'E:\\Attune\\RLSOutSourceRoundPdf\\',202,GETDATE())
			    END
				
--------- Outsource Round PDF Merge --------------
------------------------arun changes start- add reprint trf barcode in visit search screen------------------------------
DECLARE @ActionId INT, @RoleID BIGINT, @RedirectPageID BIGINT
SET @ActionId = (SELECT ActionID from ActionMaster where actioncode ='Reprint_TRFBarcode_SampleSearch')
SET @RoleID = (select ROLEID from Role where Rolename = 'LabReception' and OrgID =220) 
SET @RedirectPageID = (select Pageid from Pages where PageName ='VisitDetails')
IF NOT EXISTS (SELECT 1 FROM ActionRoleMapping WHERE actionid = @ActionId and roleid = @RoleID and RedirectPageID = @RedirectPageID and searchtypeid =11)
BEGIN
	INSERT INTO ActionRoleMapping(Actionid,RoleId,Redirectpageid,searchtypeid,createdat,IsMapped)
	VALUES(@ActionId,@RoleID,@RedirectPageID,11,GETDATE(),'Y')
END
------------------------arun changes End- add reprint trf barcode in visit search screen------------------------------

------------------------arun changes start- restrict Billing without TRF Files Upload------------------------------
DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'IsTRFMandatory')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'IsTRFMandatory','Upload TRFMandatory','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'IsTRFMandatory')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 220)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',220)
END
------------------------arun changes end- restrict Billing without TRF Files Upload------------------------------>>>>>>> .r14091
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSave'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Name}|{VisitNumber}|{BookingNo}','bookingconfirmation',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO Home Visit' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','bookingassigned',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','bookingassigned',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Reason}','cancelbooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Reason}','cancelbooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','updatedbookinginfo',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatebooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','updatebooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatebooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatebooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 

 ---------- Day Wise Collection Revenue Report Insert Query--------

 DECLARE @RoleID BIGINT
 DECLARE @PageID BIGINT
 SELECT @RoleID=RoleID FROM ROLE WHERE RoleName like '%Adminis%' and Orgid=220
 SELECT @PageID=MAX(PAGEID)+ 1 FROM Pages

 IF NOT EXISTS(SELECT PAGEID FROM PAGES WHERE PAGENAME='Daywise Collection Revenue Report')
 BEGIN
 INSERT INTO Pages(PageId,PageName,PageURL,IsShareable)
 VALUES(@PageID,'Daywise Collection Revenue Report','/ReportsLims/DaywiseCollectionRevenueReport.aspx','N')
 END
 
 DECLARE @ReportID BIGINT

 SELECT @ReportID = MAX(Reportid)+1 FROM ReportMaster
 
 INSERT INTO ReportMaster(Reportid,ReportDisplayText,ReportPath,RedirectURL,ReportGroupID,CreatedBy,CreatedAt,PageID)
 VALUES(@ReportID,'Daywise Collection Revenue Report',
 '/ReportsLims/DaywiseCollectionRevenueReport.aspx','../ReportsLims/DaywiseCollectionRevenueReport.aspx'
 ,5,1,'20-11-2020 14:47:06.660',@PageID)
 
 DECLARE @ReporID BIGINT
 SELECT @ReporID = ReportID from ReportMaster where ReportDisplayText='Daywise Collection Revenue Report'
 
 Insert into ReportOrgMapping(ReportID,RoleID,OrgID,IsMapped)
 values (@ReporID, @RoleID,220,'Y')


--------- Day Wise Collection Revenue Report Insert Query ------------

Declare @PageID bigint
Declare @PageName NVarchar(250)
Declare @PageURL NVarchar(500)
SET @PageName='Home Collection - Task Scheduling'
SET @PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
If Not Exists(Select 1 from Pages Where PageName=@PageName and ISNULL(PageURL,'')=@PageURL)
begin
	----set @PageID=1--Max(PageID)+1 from Pages ---- use when truncate the pages table
	select @PageID=Max(PageID)+1 from Pages
	Insert into Pages(PageID,PageName,PageURL,CreatedBy,CreatedAt) values (@PageID,@PageName,@PageURL,0,GETDATE())
end
SELECT @PageID =PageID FROM  Pages where pagename=@PageName and ISNULL(PageURL,'')=@PageURL
IF NOT EXISTS (Select 1 FROM PageLangMapping where Pageid=@PageID and Langcode='en-GB')
BEGIN
INSERT INTO PageLangMapping (PageID,DisplayText,LangCode,CreatedAt,CreatedBy)select @PageID,@PageName,'en-GB',getdate(),100
End
go


CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='Prima Diagnostics' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Home Collection - Task Scheduling',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO



CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='Prima Diagnostics' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Home Collection - Task Scheduling',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO


Declare @PageID bigint
Declare @PageName NVarchar(250)
Declare @PageURL NVarchar(500)
SET @PageName='Live Location Tracking'
SET @PageURL='/HomeCollection/HCLocation.aspx'
If Not Exists(Select 1 from Pages Where PageName=@PageName and ISNULL(PageURL,'')=@PageURL)
begin
	----set @PageID=1--Max(PageID)+1 from Pages ---- use when truncate the pages table
	select @PageID=Max(PageID)+1 from Pages
	Insert into Pages(PageID,PageName,PageURL,CreatedBy,CreatedAt) values (@PageID,@PageName,@PageURL,0,GETDATE())
end
SELECT @PageID =PageID FROM  Pages where pagename=@PageName and ISNULL(PageURL,'')=@PageURL
IF NOT EXISTS (Select 1 FROM PageLangMapping where Pageid=@PageID and Langcode='en-GB')
BEGIN
INSERT INTO PageLangMapping (PageID,DisplayText,LangCode,CreatedAt,CreatedBy)select @PageID,@PageName,'en-GB',getdate(),100
End
go


CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='Prima Diagnostics' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/HCLocation.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Live Location Tracking',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO



CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='Prima Diagnostics' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/HCLocation.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Live Location Tracking',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO

Declare @OrgID int, @PageID bigint, @RoleID bigint, @pPageID bigint
Select @OrgID=OrgID from Organization where name='Prima Diagnostics'
select @RoleID=RoleID from role where orgid=@OrgID and RoleName='Scheduler' and Description = 'Scheduler' and LangCode ='en-GB'
select @PageID=PageID from pages where PageName='Home Collection - Task Scheduling' and PageURL='/HomeCollection/homecollectiontaskscheduler.aspx'
select @pPageID=PageID from pages where PageName='PatientRegistration' and PageURL='/Reception/PatientRegistration.aspx'
IF not EXISTS(SELECT 1 FROM PageMapping WHERE PageID=@PageID and RoleID=@RoleID)
  BEGIN
    IF EXISTS (SELECT 1 FROM PageMapping WHERE PageID=@pPageID and RoleID=@RoleID)
      BEGIN
        UPDATE PageMapping set PageID = @PageID where RoleID = @RoleID AND PageID = @pPageID
      END
	  else
	  begin
	  insert into PageMapping(RoleId,PageID,Description,SeqNo) values(@RoleID,@PageID,'Home Collection - Task Scheduling',1)
	  end
  END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='B'
set @SubTypeCode1='Booked'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='A'
set @SubTypeCode1='Assigned'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='C'
set @SubTypeCode1='Canceled'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF NOT  EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO
declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='TS'
set @SubTypeCode1='Trip Started'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF  NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='TC'
set @SubTypeCode1='Trip Can-celled'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF NOT  EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='RD'
set @SubTypeCode1='Reached Destination'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF NOT  EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='CD'
set @SubTypeCode1='Completed'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF NOT  EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO

declare @Orgid bigint
declare @LangCode varchar(10)
Declare @Code VARCHAR(20)
Declare @Domain VARCHAR(20)
Declare @SubTypeCode1 VARCHAR(20)

Declare @ParentID Bigint
Declare @MetaDataID1 Bigint

select @Orgid=OrgID from Organization where OrgDisplayName = 'Prima Diagnostics'
set @LangCode='en-GB'
set @Domain='HC-BookingStatus'
set @Code='IP'
set @SubTypeCode1='In-progress'

Select @ParentID=MetaDataID from MetaData Where Domain=@Domain and LangCode=@LangCode AND Code=@Code
IF   NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
 BEGIN
		 IF NOT EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode 
		 AND Code=@SubTypeCode1 and ParentID=@ParentID)
		 BEGIN
			 INSERT INTO [dbo].[MetaData](Domain,Code,DisplayText,LangCode,ParentID)
			 VALUES (@Domain,@Code,@SubTypeCode1,@LangCode,@ParentID)
		 END
		 IF EXISTS (select 1 from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code)
		 BEGIN
			select @MetaDataID1=MetaDataID from MetaData where Domain=@Domain and LangCode=@LangCode AND Code=@Code 
			IF NOT EXISTS (select 1 from MetaDataOrgMapping where MetadataID=@MetaDataID1 and OrgID=@Orgid and LangCode=@LangCode and DisplayText=@SubTypeCode1 )
			BEGIN
				INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,LangCode,DisplayText,IsActive) values (@MetaDataID1,@Orgid,@LangCode,@SubTypeCode1,'Y')
			END
		 END
END
GO
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationQuickApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApprove'
SET @ButtonValue='Approve'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|Investigation.pdf|{VisitNumber}|{Name}|{Date}|{Time}','reportmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|Investigation.pdf|{VisitNumber}|{Name}|{Date}|{Time}','reportmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportmessage'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}|','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

/** **/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}|','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='WhatPatientRegistration'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Generate Work Order'
SET @ButtonValue='btnFinish'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END
 

/***/

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END
 

/***/



 /*** ***/

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'{Name}|{OrgName}|{VisitNumber}|{Reg_Date} at {Reg_Time}|{PatintNumber}','registrationSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='registrationSMS'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO B2B' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END
 /***/
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationQuickApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApprove'
SET @ButtonValue='Approve'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|{VisitNumber}|{Date}|{Time}','reportreadinessSMS','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Report'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={LoginName}&Password={Password}&ReferenceNumber={VisitNumber}|{VisitNumber}|{Date}|{Time}','reportreadinessSMS','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='reportreadinessSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/*** ***/

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/BatchwiseEnterresult.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSave'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/BatchwiseEnterresult.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Button2'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Lab/InvestigationSample.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl+'%'
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='WhatSampleReject'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Phlebotomist' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
  
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Lab/DeptSamplesCollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSubmit'
SET @ButtonValue='Submit'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl+'%'
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Accession' AND OrgID=@OrgID
SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 
 GO
  
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='Lab/PendingSampleCollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnOK'
SET @ButtonValue='OK'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl+'%'
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Phlebotomist' AND OrgID=@OrgID
SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Accession' AND OrgID=@OrgID
SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO 
 
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationResultsCapture.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApproval1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationResultsCapture.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApproval'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Lab Technician' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='SrLabTech' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='SrLabTech' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRecollectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','recollectSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='recollectSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RCN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnFinish'
SET @ButtonValue='Generate Work Order'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='SampleRejectAlert'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{Name}|{VisitNumber}|{Date}|{TestsOrdered}|{SampleTypeReceived}|{Reason}','rejectionSMS',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='rejectionSMS'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'RJN','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSave'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Name}|{VisitNumber}|{BookingNo}','bookingconfirmation',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO Home Visit' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingconfirmation'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','bookingassigned',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','bookingassigned',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='bookingassigned'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Reason}','cancelbooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{Reason}','cancelbooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='cancelbooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Apply'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','updatedbookinginfo',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingNo}','updatedbookinginfo',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatedbookinginfo'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO
 
 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/** **/

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/LabQuickBilling.aspx?&RCP=Y'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Generate Work Order'
SET @ButtonValue='btnFinish'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END
 

/***/

/***/


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like  '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END
 

/***/



 /*** ***/

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT

 

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%Diag%'
SET @PageUrl='/Billing/ClientBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Generate Bill'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='billmessage')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,AttachmentName,CreatedAt,CreatedBy)
    SELECT @TemplateTypeID,'document|http://180.151.56.37/LIMSAPI/Api/Report/GetPDF?OrgCode=LIMSAPI&Type=Report&LoginName={PatintNumber}&Password={Password}&ReferenceNumber={VisitNumber}|billmessage.pdf|{VisitNumber}|{Name}|{Date}|{Time}','billmessage','Report-{VisitNumber}_{Name}_{Date}_{Time}.pdf',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='billmessage'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='DEO B2B' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'P','WhatsApp','Y',@CreatedAt,@CreatedBy
END

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like '%RLS-Gorakhpur%'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp')
BEGIN
	INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
	SELECT 'WhatsApp','Y','REPWhat','Whatsapp','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='Booking'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='updatebooking')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'{OrgName}|{Reg_Date} at {Reg_Time}|{UserName}|{BookingID}|888-927-1826','updatebooking',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatebooking'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='updatebooking'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='WhatsApp' AND Type='Whatsapp'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'HCR','WhatsApp','N',@CreatedAt,@CreatedBy
END

 GO


 ----------- RLS Covid Report -- Seetha ----------------
 
DECLARE @pageID INT
DECLARE @OrgID INT
SELECT @OrgID=OrgID from organization where Name='RLS' 
---page insertion
IF Not Exists(SELECT 1 FROM Pages WHERE PageName='CovidReport')
BEGIN
INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt,CreatedBy)
SELECT MAX(PageID)+1,'CovidReport','/Lab/InvValuesforDynamicLoad.aspx',GETDATE(),405 FROM Pages
END
--
SELECT top 1 @pageID=pageID FROM Pages WHERE PageName='CovidReport'
--
IF Not Exists (SELECT 1 FROM Menumaster WHERE DisplayText='Covid Report' and OrgID=@OrgId and PageID=@pageID)
BEGIN
INSERT INTO  Menumaster(DisplayText,CreatedAt,CreatedBy,Parentid,PageID,OrgID,LanguageCode,MenuID)
SELECT 'Covid Report',GETDATE(),405,0,@pageID,@OrgID,'en-GB',MAX(MenuID)+1 FROM Menumaster
END
--
DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='Covid Report'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='Lab Technician'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),405,'Y'
END
Go

DECLARE @MenuID INT
--
SELECT top 1 @MenuID=MenuID FROM Menumaster WHERE DisplayText='Covid Report'and PageID=@pageID and OrgId=@OrgID
--
DECLARE @RoleID INT
SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID and RoleName='SrLabTech'
IF Not Exists(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID and MenuID=@MenuID)
BEGIN
INSERT INTO RoleMenu(MenuID,RoleID,CreatedAt,CreatedBy,IsMapped)
SELECT @MenuID,@RoleID,GETDATE(),405,'Y'
END
Go

 ----------- RLS Covid Report -- Seetha -- End ----------------

Declare @PageID bigint
Declare @PageName NVarchar(250)
Declare @PageURL NVarchar(500)
SET @PageName='Download for Bulk Registration'
SET @PageURL='/HomeCollection/BulkRegistrationBookings.aspx'
If Not Exists(Select 1 from Pages Where PageName=@PageName and ISNULL(PageURL,'')=@PageURL)
begin
	select @PageID=Max(PageID)+1 from Pages
	Insert into Pages(PageID,PageName,PageURL,CreatedBy,CreatedAt) values (@PageID,@PageName,@PageURL,0,GETDATE())
end
SELECT @PageID =PageID FROM  Pages where pagename=@PageName and ISNULL(PageURL,'')=@PageURL
IF NOT EXISTS (Select 1 FROM PageLangMapping where Pageid=@PageID and Langcode='en-GB')
BEGIN
INSERT INTO PageLangMapping (PageID,DisplayText,LangCode,CreatedAt,CreatedBy)select @PageID,@PageName,'en-GB',getdate(),100
End
go


CREATE TABLE #TempOrgID (ID INT IDENTITY(1,1),OrgID INT)
INSERT INTO #TempOrgID
SELECT OrgID from Organization WITH(NOLOCK) where Name='RLS-Covid (Mumbai)' ORDER BY OrgID
DECLARE @MinValue int 
DECLARE @MaxValue int
DECLARE @MenuID bigint 
DECLARE @PageID bigint
DECLARE @RoleID bigint
DECLARE @OrgID INT
SET @MinValue=(SELECT MIN(ID) FROM #TempOrgID) 
SET @MaxValue=(SELECT MAX(ID) FROM #TempOrgID) 
SET @MenuID=(SELECT MAX(MenuID)+1 FROM MenuMaster)

SELECT @PageID=PageID FROM Pages WHERE PageURL='/HomeCollection/BulkRegistrationBookings.aspx'
WHILE @MinValue <= @MaxValue 
BEGIN

SELECT @OrgID=OrgID FROM #TempOrgID WITH(NOLOCK) WHERE ID=@MinValue

SELECT @RoleID=RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID

IF EXISTS(SELECT OrgID FROM Organization WITH(NOLOCK) WHERE OrgID=@OrgID) 
BEGIN
	IF EXISTS(SELECT RoleID FROM Role WITH(NOLOCK) WHERE RoleID=@RoleID) 
	BEGIN
		IF EXISTS(SELECT PageID FROM Pages WITH(NOLOCK) WHERE PageID=@PageID) 
		BEGIN
			IF NOT EXISTS(SELECT MenuID FROM MenuMaster WHERE PageID=@PageID AND OrgId=@OrgID)
			BEGIN
				INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
				SELECT @MenuID,'Download for Bulk Registration',0,@OrgID,@PageID
			END
			IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID WHERE PageID=@PageID AND MM.OrgId=@OrgID)
			BEGIN
				INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
				SELECT @MenuID,@RoleID,'Y'
			END
		END
	END
END
SET @MinValue = @MinValue + 1
SET @MenuID = @MenuID + 1
END
DROP TABLE #TempOrgID
GO
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='SmartauthToken')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','SmartauthToken','2cf4b888e6c4440b8edb959e8267901c',0,GETDATE(),182  
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='CovidauthToken')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','CovidauthToken','2cf4b888e6c4440b8edb959e8267901c',0,GETDATE(),182  
END
IF NOT EXISTS (SELECT 1 FROM CommunicationConfig where Type='BulkRegJioIntegration' AND Name='CovidreportUrl')
BEGIN
	INSERT INTO CommunicationConfig (Type,Name,Value,OrgID,CreatedAt,CreatedBy)
    SELECT 'BulkRegJioIntegration','CovidreportUrl','https://api.dev.health.jiolabs.com/rf-covid-lh-interface-service/jio/health/s2sReport',0,GETDATE(),182  
END
GO


-------- Rerun values need to show delta check --------
Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='NeedRerunValuesinDelta')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'NeedRerunValuesinDelta','Do you want show rerun Values in Delta check?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='NeedRerunValuesinDelta'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='NeedModeofPaymentinBillWise' AND COM.OrgID=242)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',242,GETDATE())
				END
--------Rerun values need to show delta check ---------


Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='NeedbillofSupplyNoInvoice')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'NeedbillofSupplyNoInvoice','Do you want to add bill of supply number in invoice?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='NeedbillofSupplyNoInvoice'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='NeedbillofSupplyNoInvoice' AND COM.OrgID=202)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',202,GETDATE())
				END


				
 Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='ClientBillCancellationrestriction')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'ClientBillCancellationrestriction','Restrict Cancel bill based on Client invoice cycle?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='ClientBillCancellationrestriction'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='ClientBillCancellationrestriction' AND COM.OrgID=202)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',202,GETDATE())
				END
				

	IF NOT EXISTS (SELECT 1 FROM APIConfiguration WHERE SpName='pGetTestMasterWithSample_LIMSAPI' AND APIName='GetTestMasterWithSample')
BEGIN
	INSERT INTO APIConfiguration (APIName,SPName,MaximumRecordCount)
	SELECT 'GetTestMasterWithSample','pGetTestMasterWithSample_LIMSAPI',200
END
-------Added by Arun  Invoice Checkbox - Invoie cylce -if one selected and need to select another one  -RLS
DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'AlrtInvoiceCycleMandatory')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'AlrtInvoiceCycleMandatory','AlrtInvoiceCycleMandatory','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'AlrtInvoiceCycleMandatory')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 202)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',202)
END
-----------
-------Added by Arun  if client not having any Baserate Ratecard then the alert should be changed- RLS
DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'AlrtBaseRateNotMappng')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'AlrtBaseRateNotMappng','AlrtForRateCardNtMapngInBilng','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'AlrtBaseRateNotMappng')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 202)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',202)
END
----------------
-------Added by Arun  invoice generated only if INVOICE checkboxisenabled- RLS
DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'InvoieGenBasdOnCheckbox')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'InvoieGenBasdOnCheckbox','InvoieGenBasdOnCheckbox','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'InvoieGenBasdOnCheckbox')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 202)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',202)
END
---------
-------------------Arun - Save PDF added in Dispatch Controller Start-------------------
DECLARE @ROLEID INT =0,@ActionId INT = 0,@SearchTypeID INT =0,@PageId INT=0

SET @ROLEID = (SELECT TOP 1 RoleId FROM Role WHERE RoleName = 'Dispatch Controller' and OrgID = 220)
SET @SearchTypeID = (SELECT SearchTypeID FROM SearchTypeMaster WHERE SearchTypeName = 'Lab')
SET @PageId = (SELECT TOP 1 Pageid FROM Pages WHERE PageName ='Report Dispatch')
SET @ActionId =(SELECT COUNT(1) FROM ActionMaster)
IF NOT EXISTS (SELECT 1 FROM ActionMaster where ActionName ='Save PDF')
Begin
	INSERT INTO ActionMaster (ActionID,ActionName,ActionCode,IsShareable,LanguageCode)
	VALUES(@ActionId,'Save PDF','Save_PDF','N','en-GB')
	--SET @ActionId = SCOPE_IDENTITY()
END
--select @ROLEID as ROLEID,@SearchTypeID as '@SearchTypeID',@PageId as '@PageId',@ActionId as '@ActionId'
IF NOT EXISTS (SELECT 1 FROM ActionRoleMapping WHERE RoleID = @ROLEID AND ActionID = @ActionId AND SearchTypeID = @SearchTypeID AND RedirectPageID = @PageId)
BEGIN
	INSERT INTO ActionRoleMapping (ActionID,RoleID,RedirectPageID,SearchTypeID,IsMapped)
	VALUES(@ActionId,@ROLEID,@PageId,@SearchTypeID,'Y')
END
-------------------Arun - Save PDF added in Dispatch Controller End-------------------

 DECLARE @OrgID INT , @ConfigkeyID INT 
 SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Prima Diagnostics%'
 SELECT @ConfigkeyID=MAX(ConfigkeyID)+1 FROM ConfigkeyMaster 
 
 IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE Configkey='Showconsentform' AND DisplayText='Do you want to print consent form?')
 BEGIN
    INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,CreatedAt,CreatedBy)
    SELECT @ConfigkeyID,'Showconsentform','Do you want to print consent form?','N',GETDATE(),182 
 END

 SELECT @ConfigkeyID=ConfigkeyID FROM   ConfigKeyMaster WHERE Configkey='Showconsentform' AND DisplayText='Do you want to print consent form?'
 IF NOT EXISTS (SELECT  1 FROM ConfigOrgMaster WHERE  ConfigkeyID=@ConfigkeyID AND OrgID=@OrgID)
 BEGIN
    INSERT INTO ConfigOrgMaster (ConfigkeyID,Configvalue,orgID,CreatedAT,Createdby)
    SELECT @ConfigkeyID,'Y',@OrgID,GETDATE(),182
 END
 
 GO 
DECLARE @OrgID INT,@ActionID INT,@SearchTypeID INT,@RoleID BIGINT,@CreatedAt DATETIME,@CreatedBy BIGINT,@PageID BIGINT
SELECT @CreatedAt=GETDATE(),@CreatedBy=182
SELECT @OrgID=OrgID FROM Organization where name ='Prima Diagnostics'
SELECT @RoleID =RoleID FROM ROle where OrgID=@OrgID AND RoleName='LabReception'
SELECT @PageID=PageID FROM Pages WHERE PageName='ViewPrintPage'
SELECT @ActionID=MAX(ActionID)+1 FROM ActionMaster
IF NOT EXISTS (SELECT 1 FROM ActionMaster WHERE ActionName='Print Consent Form' AND Actioncode='Print_Consent_Form'  AND LanguageCode='en-GB')
BEGIN
   INSERT INTO ActionMaster (ActionID,ActionName,ActionCode,IsShareable,LanguageCode,CreatedAt,CreatedBy)
   select @ActionID,'Print Consent Form','Print_Consent_Form','N','en-GB',@CreatedAt,@CreatedBy
END

SELECT @SearchTypeID=SearchTypeID from SearchTypeMaster WHERE SearchTypeName='BillSearch'
SELECT @ActionID=ActionID FROM ActionMaster WHERE ActionName='Print Consent Form' AND Actioncode='Print_Consent_Form'  AND LanguageCode='en-GB'
IF NOT EXISTS (SELECT 1 FROM ActionRoleMapping WHERE ActionID=@ActionID AND RoleID=@RoleID AND SearchTypeID=@SearchTypeID)
BEGIN
    INSERT INTO ActionRoleMapping (ActionID,RoleID,SearchTypeID,RedirectPageID,IsMapped,CreatedAt,CreatedBy)
	SELECT @ActionID,@RoleID,@SearchTypeID,@PageID,'Y',@CreatedAt,@CreatedBy
END

 
GO
DECLARE @TemplateID INT,@OrgID INT
SELECT @OrgID =OrgID FROM Organization WHERE name = 'Prima Diagnostics'
SELECT @TemplateID=MAX(TemplateID)+1 FROM InvReportMaster
IF NOT EXISTS (SELECT 1 FROM InvReportMaster WHERE ReportTemplateName='/LISKERNEL/Prima/ConsentFromCTKannada' ANd Type='ConsentForm' AND TemplateName='ConsentFromCTKannada')
BEGIN
	INSERT INTO InvReportMaster (TemplateID,ReportTemplateName,Type,TemplateName,isDefault,IsActive,OrgID,IsSeperatePrint,Langcode)
	select @TemplateID,'/LISKERNEL/Prima/ConsentFromCTKannada','ConsentForm','ConsentFromCTKannada','N','A',@OrgID,'Y','en-GB'
END
SELECT @TemplateID=MAX(TemplateID)+1 FROM InvReportMaster
IF NOT EXISTS (SELECT 1 FROM InvReportMaster WHERE ReportTemplateName='/LISKERNEL/Prima/ConsentFromCTEnglish' ANd Type='ConsentForm' AND TemplateName='ConsentFromCTEnglish')
BEGIN
	INSERT INTO InvReportMaster (TemplateID,ReportTemplateName,Type,TemplateName,isDefault,IsActive,OrgID,IsSeperatePrint,Langcode)
	select @TemplateID,'/LISKERNEL/Prima/ConsentFromCTEnglish','ConsentForm','ConsentFromCTEnglish','N','A',@OrgID,'Y','en-GB'
END
SELECT @TemplateID=MAX(TemplateID)+1 FROM InvReportMaster
IF NOT EXISTS (SELECT 1 FROM InvReportMaster WHERE ReportTemplateName='/LISKERNEL/Prima/ConsentFromMRIKannada' ANd Type='ConsentForm' AND TemplateName='ConsentFromMRIKannada')
BEGIN
	INSERT INTO InvReportMaster (TemplateID,ReportTemplateName,Type,TemplateName,isDefault,IsActive,OrgID,IsSeperatePrint,Langcode)
	select @TemplateID,'/LISKERNEL/Prima/ConsentFromMRIKannada','ConsentForm','ConsentFromMRIKannada','N','A',@OrgID,'Y','en-GB'
END
SELECT @TemplateID=MAX(TemplateID)+1 FROM InvReportMaster
IF NOT EXISTS (SELECT 1 FROM InvReportMaster WHERE ReportTemplateName='/LISKERNEL/Prima/ConsentFromMRIEnglish' ANd Type='ConsentForm' AND TemplateName='ConsentFromMRIEnglish')
BEGIN
	INSERT INTO InvReportMaster (TemplateID,ReportTemplateName,Type,TemplateName,isDefault,IsActive,OrgID,IsSeperatePrint,Langcode)
	select @TemplateID,'/LISKERNEL/Prima/ConsentFromMRIEnglish','ConsentForm','ConsentFromMRIEnglish','N','A',@OrgID,'Y','en-GB'
END
GO
---------------------------------arun LIS-DEMO Issue fixes start--------------
DECLARE @ActionId INT =0,@RoleId INT =0,@searchtypeid int =0,@RedirectPageId INT= 0

SET @RedirectPageId = (select top 1 Pageid from Pages where PageName = 'Batch wise Enterresult')
SET @searchtypeid =(select top 1 searchtypeid from searchtypemaster where SearchTypeName ='BillSearch')
SET @ActionId = (select top 1 actionid from ActionMaster where actionname = 'Edit Bill')
SET @RoleID = (select top 1 Roleid from Role where orgid = 220 and Rolename = 'LabReception')

IF NOT EXISTS(select * from ActionRoleMapping where actionid =@actionid and roleid = @RoleId and Redirectpageid = @RedirectPageId and Searchtypeid = @searchtypeid)
BEGIN
	INSERT INTO ActionRoleMapping (actionid,roleid,redirectpageid,searchtypeid,IsMapped)
	values(@ActionId,@RoleID,@RedirectPageId,@searchtypeid,'Y')
END
--select * from ActionRoleMapping where actionid =@actionid and roleid = @RoleId  and Redirectpageid = @RedirectPageId and Searchtypeid = @searchtypeid
DECLARE @ReasonTypeId INT =0
SET @ReasonTypeId = (select Top 1 Typeid from ReasonType where displaytext = 'rerun')
--select * from reasonmaster where Reasontypeid = @ReasonTypeId
IF NOT EXISTS(select * from InvReasonOrgMapping where reasonid in(select Reasonid from reasonmaster where Reasontypeid = @ReasonTypeId) and orgid = 98)
BEGIN
	INSERT INTO InvReasonOrgMapping (StatusId,ReasonId,Orgid,DisplayText,LangCode)
	SELECT 0,Reasonid,98,Reason,'en-GB' FROM reasonmaster where Reasontypeid = @ReasonTypeId
END
--update RerunRecollect Config
DECLARE @Configkeyid int=0
set @Configkeyid =(select top 1 configkeyid from configkeymaster where configkey = 'RerunRecollect')
--select * from ConfigOrgMaster where configkeyid = 37 and orgid = 98
--select * from ConfigOrgMaster where configkeyid = @Configkeyid and orgid = 220
Update configorgmaster set configvalue='Y'  where configkeyid = @Configkeyid and orgid = 98

DECLARE @Pageid int = 0,@Pagecontextid int = 0,@actiontypeid int =0,@templateid int =0,@RoleId int =0
SET @Pageid = (select top 1 Pageid from pages where pagename ='New Report Dispatch')
SET @PageContextid = (select top 1 pagecontextid from pagecontext where buttonname = 'REPORTPRINTBTN' and pageid= @Pageid)
SET @RoleId = (select top 1 roleid from Role where rolename = 'Dispatch Controller' and orgid = 220)
SET @actiontypeid= (SELECT TOP 1 Actiontypeid from ActionManagerType where ActionType ='ROUNDBPRINT')
SET @templateid =(SELECT TOP 1 TemplateId FROM ActionTemplate where templatename = 'REPORT_ROUNDBPDF')

IF NOT EXISTS(SELECT 1 FROM pagecontextactionmapping where pagecontextid=@PageContextid and roleid = @RoleId and Actiontypeid = @actiontypeid and templateid = @templateid)
begin
	insert into pagecontextactionmapping (pagecontextid,roleid,actiontypeid,templateid,contexttype,additionalcontext,isattachment)
	values(@PageContextid,@RoleId,@actiontypeid,@templateid,'P','Report','Y'),(@PageContextid,@RoleId,@actiontypeid,@templateid,'CP','Report','Y')
end
IF NOT EXISTS(select 1 from LocationPrintMap where orgid=220)
BEGIN
	INSERT INTO LocationPrintMap (Code,Printername,orgid,orgaddressid,isactive,printertype)
	values(415,'Kiosk Printer',220,415,1,'Kiosk'),(434,'Canon iR3225 UFR II',220,434,1,'')
END
--select * from LocationPrintMap where orgid=220
DECLARE @InvStatusId INT =0,@CurrentStatusID INT =0

SET @InvStatusId = (select top 1 Investigationstatusid from InvestigationStatus where Status = 'Co-authorize')
SET @CurrentStatusID =(select top 1 Investigationstatusid from InvestigationStatus where Status ='Completed')

IF NOT EXISTS(select * from InvStatusmapping where InvestigationStatusid=@CurrentStatusID and Mappingid=@InvStatusId and orgid = 98)
BEGIN
	INSERT INTO InvStatusmapping (investigationstatusid,mappingid,orgid,seqno)
	values(@CurrentStatusID,@InvStatusId,98,19)
END
--select * from InvStatusmapping where InvestigationStatusid=@CurrentStatusID and Mappingid=@InvStatusId and orgid = 98
DECLARE @ConfigKeyId INT =0

SET @ConfigKeyId = (SELECT CONFIGKEYID FROM CONFIGKEYMASTER WHERE CONFIGKEY ='DueBillreport')
IF NOT EXISTS(SELECT 1 FROM configorgmaster WHERE ORGID = 236 AND Configkeyid =@Configkeyid)
BEGIN
	INSERT INTO configorgmaster(Configkeyid,Configvalue,Orgid)
	VALUES(@Configkeyid,'Y',236)
END
---------------------------------arun LIS-DEMO Issue fixes end--------------
GO


 GO 
DECLARE @OrgID INT , @ConfigkeyID INT 
 SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Prima Diagnostics%'
 SELECT @ConfigkeyID=MAX(ConfigkeyID)+1 FROM ConfigkeyMaster 
 
 IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE Configkey='AutoSave' AND DisplayText='AutoSave')
 BEGIN
    INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,CreatedAt,CreatedBy)
    SELECT @ConfigkeyID,'AutoSave','AutoSave','N',GETDATE(),182 
 END

 SELECT @ConfigkeyID=ConfigkeyID FROM   ConfigKeyMaster WHERE Configkey='AutoSave' AND DisplayText='AutoSave'
 IF NOT EXISTS (SELECT  1 FROM ConfigOrgMaster WHERE  ConfigkeyID=@ConfigkeyID AND OrgID=@OrgID)
 BEGIN
    INSERT INTO ConfigOrgMaster (ConfigkeyID,Configvalue,orgID,CreatedAT,Createdby)
    SELECT @ConfigkeyID,'Y',@OrgID,GETDATE(),182
 END
 
 GO 
 -----------------Arun - UPI added in PaymentType
 DECLARE @Orgid INT =0, @Paymenttypeid INT=0
SET @Orgid = 202 
IF NOT EXISTS (SELECT 1 FROM PaymentType WHERE PaymentName ='UPI Payments')
BEGIN
	SET @Paymenttypeid = (SELECT COUNT(1) FROM PaymentType)+1
	INSERT INTO PaymentType(PaymentTypeID,PaymentName)
	VALUES(@Paymenttypeid,'UPI Payments')	
END
IF NOT EXISTS (SELECT 1 FROM PaymentTypeOrgMapping WHERE OrgID = @Orgid AND PaymentTypeID=@Paymenttypeid)
BEGIN
	INSERT INTO PaymentTypeOrgMapping (PaymentTypeID,OrgID)
	VALUES(@Paymenttypeid,@Orgid)
END
 ---------------
 GO
 
DECLARE @OrgID INT,@RoleID BIGINT,@PageID INT
 SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Prima Diagnostics%'
 SELECT @RoleID=MAX(RoleID)+1 FROM Role  
 SELECT @PageID=PageID FROM Pages where pageurl like '/Reception/Home.aspx'
 
 IF NOT EXISTS (SELECT 1 FROM Role WHERE RoleName='Center Manager' AND OrgID=@OrgID AND LangCode='en-GB')
 BEGIN
	INSERT INTO Role (RoleID,OrgID,RoleName,Description,CreatedAt,CreatedBy,LangCode)
	SELECT @RoleID,@OrgID,'Center Manager','Center Manager',GETDATE(),182,'en-GB'
 END
 SELECT @RoleID=RoleID  FROM Role where RoleName='Center Manager' AND orgid=@OrgID

 IF NOT EXISTS (SELECT 1 FROM PageMapping WHERE PageID=@PageID AND RoleID=@RoleID)
 BEGIN
	INSERT INTO PageMapping (PageID,RoleID,SeqNo,CreatedAt,CreatedBy)
	SELECT @PageID,@RoleID,1,GETDATE(),182
 END
 GO
   DECLARE @OrgID INT , @ConfigkeyID INT 
 SELECT @OrgID=OrgID FROM Organization WHERE Name like '%Prima Diagnostics%'
 SELECT @ConfigkeyID=MAX(ConfigkeyID)+1 FROM ConfigkeyMaster 
 
 IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE Configkey='EditDrName' AND DisplayText='Do you want to change Dr name alone?')
 BEGIN
    INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,CreatedAt,CreatedBy)
    SELECT @ConfigkeyID,'EditDrName','Do you want to change Dr name alone?','N',GETDATE(),182 
 END

 SELECT @ConfigkeyID=ConfigkeyID FROM   ConfigKeyMaster WHERE Configkey='EditDrName' AND DisplayText='Do you want to change Dr name alone?'
 IF NOT EXISTS (SELECT  1 FROM ConfigOrgMaster WHERE  ConfigkeyID=@ConfigkeyID AND OrgID=@OrgID)
 BEGIN
    INSERT INTO ConfigOrgMaster (ConfigkeyID,Configvalue,orgID,CreatedAT,Createdby)
    SELECT @ConfigkeyID,'Y',@OrgID,GETDATE(),182
 END
  
 
 GO 
 DECLARE @OrgID INT,@ActionID INT,@SearchTypeID INT,@RoleID BIGINT,@CreatedAt DATETIME,@CreatedBy BIGINT,@PageID BIGINT
SELECT @CreatedAt=GETDATE(),@CreatedBy=182
SELECT @OrgID=OrgID FROM Organization where name ='Prima Diagnostics'
SELECT @RoleID =RoleID FROM ROle where OrgID=@OrgID AND RoleName='Center Manager'
SELECT @PageID=PageID FROM Pages WHERE Pageurl='/Billing/LabQuickBilling.aspx'
SELECT @ActionID=MAX(ActionID)+1 FROM ActionMaster
IF NOT EXISTS (SELECT 1 FROM ActionMaster WHERE ActionName='Edit Doctor' AND Actioncode='Edit_Doctor'  AND LanguageCode='en-GB')
BEGIN
   INSERT INTO ActionMaster (ActionID,ActionName,ActionCode,IsShareable,LanguageCode,CreatedAt,CreatedBy,Querystring)
   select @ActionID,'Edit Doctor','Edit_Doctor','N','en-GB',@CreatedAt,@CreatedBy,'../Billing/LabQuickBilling.aspx?PID={PatientID}&VID={PatientVisitID}&PNAME={PatientName}'
END

SELECT @SearchTypeID=SearchTypeID from SearchTypeMaster WHERE SearchTypeName='VisitSearch'
SELECT @ActionID=ActionID FROM ActionMaster WHERE ActionName='Edit Doctor' AND Actioncode='Edit_Doctor'  AND LanguageCode='en-GB'
IF NOT EXISTS (SELECT 1 FROM ActionRoleMapping WHERE ActionID=@ActionID AND RoleID=@RoleID AND SearchTypeID=@SearchTypeID)
BEGIN
    INSERT INTO ActionRoleMapping (ActionID,RoleID,SearchTypeID,RedirectPageID,IsMapped,CreatedAt,CreatedBy)
	SELECT @ActionID,@RoleID,@SearchTypeID,@PageID,'Y',@CreatedAt,@CreatedBy
END
GO
 DECLARE @OrgID INT,@RoleID BIGINT,@SpID INT,@ReportID INT
SELECT @OrgID=OrgID FROM Organization where name ='Prima Diagnostics'
SELECT @RoleID=ROleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE Name='pGetPatientReferringPhysicianlogReport' AND Description='Referring Physician Log Report')
BEGIN
	INSERT INTO ReportExcelSp(Name,Description)
	SELECT 'pGetPatientReferringPhysicianlogReport','Referring Physician Log Report'
END
SELECT @SpID=ID FROM ReportExcelSp WHERE Name='pGetPatientReferringPhysicianlogReport' AND Description='Referring Physician Log Report'
IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster WHERE ExcelName='ReferringPhysicianLogReport' AND SP=@SpID AND ReportName='Referring Physician Log Report' AND ParameterType='ShowDateRangePopup'  )
BEGIN
	INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
	SELECT 'ReferringPhysicianLogReport',@SpID,'Referring Physician Log Report','ShowDateRangePopup',1
END
SELECT @ReportID=ID FROM ReportExcelMaster  WHERE ExcelName='ReferringPhysicianLogReport' AND SP=@SpID AND ReportName='Referring Physician Log Report' AND ParameterType='ShowDateRangePopup'
IF NOT EXISTS (SELECT 1 FROM reportexcelrolemapping WHERE ReportID =@ReportID AND RoleID=@RoleID  )
BEGIN
	INSERT INTO reportexcelrolemapping(ReportID,RoleID,CreatedAt,IsActive)
	SELECT @ReportID,@RoleID,GETDATE(),1
END
GO

 DECLARE @PageContextID INT,@RoleID BIGINT, @OrgID INT,@PageID INT,
        @ActionTemplateID INT ,@ActionTypeID INT 
SELECT @OrgID =OrgID FROM Organization WHERE Name like 'Prima Diagnostics'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Center Manager'
SELECT  @PageID=PageID FROM Pages WHERE PageUrl like '%/Billing/LabQuickBilling.aspx'
SELECT @ActionTypeID=ActionTypeID FROM ActionManagerType WHERE ActionType='Pdf'   AND Type is null

IF NOT EXISTS (SELECT 1 FROM PageContext WHERE PageID=460 AND ButtonName ='btnGenerate' AND ButtionValue='Update')
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,PageName,CreatedAt,CreatedBy)
	SELECT @PageID,'btnGenerate','Update','',GETDATE(),182
END

IF NOT EXISTS (SELECT 1 FROM ActionTemplate WHERE TemplateTypeID=1 AND TemplateName='P_Report_pdf' AND Template='\REPORT\{OrgID}\{pdfDate}\' )
BEGIN
	INSERT INTO ActionTemplate (TemplateTypeID,TemplateName,Template,CreatedAt,CreatedBy)
	SELECT 1,'P_Report_pdf','\REPORT\{OrgID}\{pdfDate}\',GETDATE(),182
END

SELECT @ActionTemplateID=TemplateID FROM ActionTemplate WHERE TemplateTypeID=1 AND TemplateName='P_Report_pdf' AND Template='\REPORT\{OrgID}\{pdfDate}\' 
SELECT @PageContextID=PageContextID FROM PageContext  WHERE PageID=@PageID AND ButtonName ='btnGenerate' AND ButtionValue='Update'

IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND ActionTypeID=@ActionTypeID AND TemplateID=@ActionTemplateID)
BEGIN

	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@ActionTemplateID,'P','Report','Y',GETDATE(),182
END


IF NOT EXISTS (SELECT 1 FROM ActionTemplate WHERE TemplateTypeID=1 AND TemplateName='CP_Report_pdf' AND Template='\REPORT\{OrgID}\{pdfDate}\' )
BEGIN
	INSERT INTO ActionTemplate (TemplateTypeID,TemplateName,Template,CreatedAt,CreatedBy)
	SELECT 1,'CP_Report_pdf','\REPORT\{OrgID}\{pdfDate}\',GETDATE(),182
END

SELECT @ActionTemplateID=TemplateID FROM ActionTemplate WHERE TemplateTypeID=1 AND TemplateName='CP_Report_pdf' AND Template='\REPORT\{OrgID}\{pdfDate}\' 
SELECT @PageContextID=PageContextID FROM PageContext  WHERE PageID=@PageID AND ButtonName ='btnGenerate' AND ButtionValue='Update'

IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND ActionTypeID=@ActionTypeID AND TemplateID=@ActionTemplateID)
BEGIN

	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@ActionTemplateID,'CP','Report','Y',GETDATE(),182
END

SELECT @ActionTypeID=ActionTypeID FROM ActionManagerType WHERE ActionType='ROUNDBPDF'  
IF NOT EXISTS (SELECT 1 FROM ActionTemplate WHERE TemplateTypeID=1 AND TemplateName='REPORT_ROUNDBPDF' AND Template='\REPORT\{OrgID}\ROUNDB\{pdfDate}\' )
BEGIN
	INSERT INTO ActionTemplate (TemplateTypeID,TemplateName,Template,CreatedAt,CreatedBy)
	SELECT 1,'REPORT_ROUNDBPDF','\REPORT\{OrgID}\ROUNDB\{pdfDate}\',GETDATE(),182
END

SELECT @ActionTemplateID=TemplateID FROM ActionTemplate WHERE TemplateTypeID=1 AND TemplateName='REPORT_ROUNDBPDF' AND Template='\REPORT\{OrgID}\ROUNDB\{pdfDate}\' 
SELECT @PageContextID=PageContextID FROM PageContext  WHERE PageID=@PageID AND ButtonName ='btnGenerate' AND ButtionValue='Update'

IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND ActionTypeID=@ActionTypeID AND TemplateID=@ActionTemplateID)
BEGIN

	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@ActionTemplateID,'CP','Report','Y',GETDATE(),182
END
GO


 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like 'Prima Diagnostics'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Save'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END
 
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms'  AND Type='Notify'
 
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='AbnormalAlerts' 
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}','RSMS_P',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P'  AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'CV','Report','N',@CreatedAt,@CreatedBy
END

 GO


 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like 'Prima Diagnostics'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END
 
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms'  AND Type='Notify'
 
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='AbnormalAlerts' 
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}','RSMS_P',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P'  AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'CV','Report','N',@CreatedAt,@CreatedBy
END

 GO

 DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like 'Prima Diagnostics'
SET @PageUrl='/Investigation/InvestigationApprovel.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSaveToDispatch1'
SET @ButtonValue='Save And Home'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END
 
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms'  AND Type='Notify'
 
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='AbnormalAlerts' 
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}','RSMS_P',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Doctor' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P'  AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'CV','Report','N',@CreatedAt,@CreatedBy
END

 GO
  DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
		@TemplateTypeID INT,@TemplateID INT

SELECT @OrgID=OrgID FROM Organization WHERE Name Like 'Prima Diagnostics'
SET @PageUrl='/Billing/LabQuickBilling.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnGenerate'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE '%'+@PageUrl 
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
	INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
	SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END
 
	SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms'  AND Type='Notify'
 
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='AbnormalAlerts' 
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}')
BEGIN
	INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy)
	SELECT @TemplateTypeID,'Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}','RSMS_P',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
	SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P' AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
END 
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Center Manager' AND OrgID=@OrgID AND LangCode='en-GB'

SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='RSMS_P'  AND Template='Dear Dr.{RefDoctorName},  {Name}, Visit No.{VisitNumber}, {TestName} and Critical Value: {InvsNValues} - {OrgName}'
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify'
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
	INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
	SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'CV','Report','N',@CreatedAt,@CreatedBy
END
GO


Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='NeedItemLevelDiscount')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'NeedItemLevelDiscount','Do you need Item level discount?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='NeedItemLevelDiscount'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='NeedItemLevelDiscount' AND COM.OrgID=249)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',249,GETDATE())
				END
				
				
				Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='DiscountfromMaterorValue')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'DiscountfromMaterorValue','Do you need Item level discount from MAster or Value?','N','N')
				/END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='DiscountfromMaterorValue'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='DiscountfromMaterorValue' AND COM.OrgID=249)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',249,GETDATE())
				END
				GO
				
				
-------------------------Department wise BulkApproval ---- arun-----
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @NewRoleID BIGINT
Declare @Newtaskactionid int
DECLARE @OrgID INT
SET @OrgID=202

 

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID)+1 FROM Pages
SELECT @NewRoleID=MAX(roleid) + 1 FROM Role 
SELECT @Newtaskactionid=MAX(taskactionid) + 1 FROM TaskActions 

 

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Investigation/BulkDeptwiseApproval.aspx?Action=BulkApprove')
BEGIN
    INSERT INTO Pages(PageID,PageName,PageURL) 
    SELECT @PageID,'BulkDeptwiseApproval','/Investigation/BulkDeptwiseApproval.aspx?Action=BulkApprove'
END

 

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Investigation/BulkDeptwiseApproval.aspx?Action=BulkApprove' AND MM.OrgId=@OrgID)
BEGIN
    INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
    SELECT @MenuID+1,'Bulk Deptwise Approval',0,@OrgID,@PageID
END
   
    IF NOT EXISTS(SELECT RoleName FROM Role WHERE RoleName='Pathologist')
   BEGIN
    INSERT INTO Role (RoleID,RoleName,Description,OrgID)VALUES(@NewRoleID,'Pathologist','Pathologist',@orgid)
    END

 

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Investigation/BulkDeptwiseApproval.aspx?Action=BulkApprove' AND MM.OrgId=@OrgID)
BEGIN
    INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
    SELECT @MenuID+1,@NewRoleID,'Y'
END

 

if not exists (select 1 from TaskActions where category='BulkApprove')
Begin
INSERT INTO TaskActions (TaskActionID,ActionName,RedirectURL,DisplayTextTemplate,Category,IsShareable,OrgID)
    VALUES(@Newtaskactionid,'BulkApprove','~\Investigation\BulkDeptwiseApproval.aspx?pid={PatientID}&vid={PatientVisitID}&gUID={UID}','Approve Investigation Result for {PatientName}({PatientNumber})(Lab Number:{ExternalVisitId})','BulkApprove','N',@OrgID)
End

 
IF NOT EXISTS(SELECT 1 FROM TaskEntityMap WHERE TaskActionID= @Newtaskactionid)
BEGIN
Insert into TaskEntityMap(MappingType,MappingID,TaskActionID)
select MappingType,MappingID,@Newtaskactionid from TaskEntityMap where taskactionid=92 and orgid is null
union 
select 'InvestigationStatus',4,@Newtaskactionid
union 
select 'InvestigationStatus',4,@Newtaskactionid
END
 

if not exists (select 1 from RoleDeptMap where RoleID=@NewRoleID)
Begin
insert into RoleDeptMap(roleid,DeptID,IsActive,Createdat,CreatedBy)
select @NewRoleID,DeptID,IsActive,Createdat,CreatedBy from RoleDeptMap where roleid in (select roleid from role where rolename='Pathologist' and orgid=202)
End

go

if not exists(select * from SCPHolidayList where Description='Happy New Year')  
BEGIN
INSERT INTO SCPHolidayList (StartDate,Description,Status,Type,CreatedBy,CreatedAt)VALUES ('2021-01-01' ,'Happy New Year',1)
END
go
if not exists(select * from SCPHolidayList where Description='RepublicDay')  
BEGIN
INSERT INTO SCPHolidayList (StartDate,Description,Status,Type,CreatedBy,CreatedAt)VALUES ('2021-01-26' ,'RepublicDay',1)
END

go
-----------------------
DECLARE @OrgID INT,@URNTypeId BIGINT
SELECT @OrgID=OrgID FROM Organization WHERE Name like '%One Diagnostics%'

IF NOT EXISTS (SELECT 1 FROM URNTypes WHERE URNType='Aadhar No')
BEGIN
	INSERT INTO URNTypes (URNType)
	SELECT 'Aadhar No'
END
SELECT @URNTypeId=URNTypeID FROM URNTypes WHERE URNType='Aadhar No'
IF NOT EXISTS (SELECT 1 FROM URNOrgMapping WHERE URNtypeid=@URNTypeId AND OrgiD=@OrgID AND Displaytext='Aadhar No')
BEGIN
	INSERT INTO URNOrgMapping (URNtypeid,OrgID,DisplayText,SeqNo,Langcode)
	select @URNTypeId,@OrgID,'Aadhar No',8,'en-GB'
END

GO

DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS-Covid (Mumbai)'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetCovidIntegrationStatus','Covid Integration Status Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Covid Integration Status Report',@SpID,'Covid Integration Status Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
	INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
	SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO
DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='Prima Diagnostics'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetPrimaWhatsappStatusReport' AND Description='Whatsapp Notification Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetPrimaWhatsappStatusReport','Whatsapp Notification Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetPrimaWhatsappStatusReport' AND Description='Whatsapp Notification Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Whatsapp Notification Report' AND SP=@SpID AND ReportName='Whatsapp Notification Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Whatsapp Notification Report',@SpID,'Whatsapp Notification Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Whatsapp Notification Report' AND SP=@SpID AND ReportName='Whatsapp Notification Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
	INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
	SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO
-----arunchanges -- rate master labshare amount hide show
DECLARE @ConfigKeyId123 BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'HideLabShareAmnt')
BEGIN
	SET @ConfigKeyId123 = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId123,'HideLabShareAmnt','Lab Franchisee share amount capture','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId123 = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'HideLabShareAmnt')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId123 AND OrgID in(202,248,249))
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId123,'Y',202),(@ConfigKeyId123,'Y',248),(@ConfigKeyId123,'Y',249)
END

-------
------------------arun changes -- bulk srf id upload page added and spot mis script 
DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT
SET @OrgID=168

 

SELECT @MenuID=MAX(MenuID) FROM MenuMaster
SELECT @PageID=MAX(PageID) FROM Pages
set  @RoleID= (SELECT top 1 RoleID FROM [Role] WHERE OrgID=@OrgID and RoleName='LabReception')

 --select @RoleID

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Patient/BulkSRFIdupload.aspx')
BEGIN
    INSERT INTO Pages(PageID,PageName,PageURL) 
    SELECT @PageID+1,'Bulk SRF ID Upload','/Patient/BulkSRFIdupload.aspx'
END

 

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Patient/BulkSRFIdupload.aspx' AND MM.OrgId=@OrgID)
BEGIN
    INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
    SELECT @MenuID+1,'Bulk SRF ID Upload',0,@OrgID,@PageID+1
END

 

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Patient/BulkSRFIdupload.aspx' AND MM.OrgId=@OrgID)
BEGIN
    INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
    SELECT @MenuID+1,@RoleID,'Y'
END
---spot mis
DECLARE @Reportid INT =0, @ROLEID INT =0

SET @ROLEID = (select top 1 Roleid from role where orgid = 168 and rolename = 'labreception')
IF NOT EXISTS(select 1 from reportexcelsp where name = 'pGetSRFIDAvailorNotReport')
BEGIN
	insert reportexcelsp select 'pGetSRFIDAvailorNotReport','pGetSRFIDAvailorNotReport',null,null,null,null
END
IF NOT EXISTS(select 1 from reportexcelmaster where excelname = 'Dummy MIS For Bulk SRF ID')
BEGIN
	insert reportexcelmaster select 'Dummy MIS For Bulk SRF ID',id,'Dummy MIS For Bulk SRF ID','ShowDateRangePopup',null,1 from reportexcelsp where 
	name='pGetSRFIDAvailorNotReport'
END
SET @Reportid = (select top 1 id from reportexcelmaster where excelname = 'Dummy MIS For Bulk SRF ID')
IF NOT EXISTS(select 1 from reportexcelrolemapping where Roleid = @ROLEID and reportid = @Reportid)
BEGIN
	insert reportexcelrolemapping select id,@ROLEID,1,getdate() from reportexcelmaster where reportname='Dummy MIS For Bulk SRF ID'
END
---------------
GO
DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT
SELECT @OrgID=OrgID FROM Organization WHERE  Name Like 'Prima Diagnostics'
SET @PageUrl='/HomeCollection/homecollection.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnSave'
SET @ButtonValue='Save'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'Sms','Y','RSMS','Notify','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='NewBooking')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy,Subject)
    SELECT @TemplateTypeID,'You home collection appointment is booked in {OrgName} on {Reg_Date} at {Reg_Time}. And the Booking number is {BookingID} . Call our office at 888-927-1826 if you have any questions or need to reschedule.','NewBooking',@CreatedAt,@CreatedBy,'New Booking Confirmation'
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='NewBooking'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='NewBooking'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='LabReception' AND OrgID=@OrgID

IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'HCB','Notify','N',@CreatedAt,@CreatedBy
END
GO

DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT
SELECT @OrgID=OrgID FROM Organization WHERE  Name Like 'Prima Diagnostics'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='btnApply'
SET @ButtonValue='Save And Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END

 

IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'Sms','Y','RSMS','Notify','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
END
SELECT @TemplateTypeID =TemplateTypeID FROM ActionTemplateType WHERE TemplateType='PatientRegistration'
IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='PersonAssigned')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy,Subject)
    SELECT @TemplateTypeID,'You home collection appointment is booked in {OrgName} on {Reg_Date} at {Reg_Time}. with the Sample collection person {UserName} and the Booking number is {BookingID} . Call our office at 888-927-1826 if you have any questions or need to reschedule.','PersonAssigned',@CreatedAt,@CreatedBy,'Person Assigned'
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='PersonAssigned'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='PersonAssigned'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'HCA','Notify','N',@CreatedAt,@CreatedBy
END


IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='Cancelled')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy,Subject)
    SELECT @TemplateTypeID,'You home collection appointment is Cancelled in {OrgName} for the following reason- patient want to cancel the test. Call our office at 888-927-1826 if you have any questions or need to reschedule.','Cancelled',@CreatedAt,@CreatedBy,'Cancelled'
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='Cancelled'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='Cancelled'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'HCCAN','Notify','N',@CreatedAt,@CreatedBy
END


IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='Rescheduled')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy,Subject)
    SELECT @TemplateTypeID,'You home collection appointment is Rescheduled in {OrgName} on {Reg_Date} at {Reg_Time}. with the Sample collection person {UserName} and the Booking number is {BookingID} . Call our office at 888-927-1826 if you have any questions or need to reschedule.','Rescheduled',@CreatedAt,@CreatedBy,'Rescheduled'
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='Rescheduled'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='Rescheduled'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'HCR','Notify','N',@CreatedAt,@CreatedBy
END
GO


DECLARE @PageID INT,@RoleID BIGINT,@OrgID INT,@PageContextID INT,@TypeID INT,@PageUrl NVARCHAR(200),
        @CreatedAt DATETIME,@CreatedBy BIGINT,@ButtonName NVARCHAR(100),@ButtonValue NVARCHAR(100),@ActionTypeID INT,
        @TemplateTypeID INT,@TemplateID INT
SELECT @OrgID=OrgID FROM Organization WHERE  Name Like 'Prima Diagnostics'
SET @PageUrl='/HomeCollection/homecollectiontaskscheduler.aspx'
SET @CreatedAt=GETDATE()
SET @CreatedBy =182
SET @ButtonName='Update'
SET @ButtonValue='Update'
SELECT @PageID =PageID FROM Pages (NOLOCK) WHERE PageURL LIKE ''+@PageUrl+''
select @PageID,@PageUrl,@ButtonName,@ButtonValue
IF EXISTS (SELECT  1 FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue)
BEGIN
  SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
END
ELSE
BEGIN
    INSERT INTO PageContext (PageID,ButtonName,ButtionValue,CreatedAt,CreatedBy)
    SELECT @PageID,@ButtonName,@ButtonValue,@CreatedAt,@CreatedBy
END



IF NOT EXISTS (SELECT  1 FROM ActionManagerType (NOLOCK) WHERE ActionType='Sms' AND Type='Notify')
BEGIN
    INSERT INTO ActionManagerType (ActionType,IsDisplay,ActionCode,Type,LangCode,CreatedAt,CreatedBy)
    SELECT 'Sms','Y','RSMS','Notify','en-GB',@CreatedAt,@CreatedBy
END
ELSE
BEGIN
    SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
END



IF NOT EXISTS (SELECT 1 FROm ActionTemplate (NOLOCK) WHERE TemplateName='Rescheduled')
BEGIN
    INSERT INTO ActionTemplate(TemplateTypeID,Template,TemplateName,CreatedAt,CreatedBy,Subject)
    SELECT @TemplateTypeID,'You home collection appointment is Rescheduled in {OrgName} on {Reg_Date} at {Reg_Time}. with the Sample collection person {UserName} and the Booking number is {BookingID} . Call our office at 888-927-1826 if you have any questions or need to reschedule.','Rescheduled',@CreatedAt,@CreatedBy,'Rescheduled'
END
ELSE
BEGIN
    SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='Rescheduled'
END 
SELECT  @ActionTypeID=ActionTypeID FROM ActionManagerType (NOLOCK) WHERE  ActionType='Sms' AND Type='Notify'
 SELECT @TemplateID=TemplateID FROM ActionTemplate (NOLOCK) WHERE TemplateName='Rescheduled'
SELECT @PageContextID =PageContextID FROM PageContext (NOLOCK) WHERE PageID=@PageID AND ButtonName=@ButtonName AND ButtionValue=@ButtonValue
SELECT @RoleID =RoleID FROM Role WHERE RoleName='Scheduler' AND OrgID=@OrgID
IF NOT EXISTS (SELECT 1 FROM PageContextActionMapping (NOLOCK) WHERE PageContextID=@PageContextID AND RoleID=@RoleID AND TemplateID=@TemplateID AND ActionTypeID=@ActionTypeID)
BEGIN
    INSERT INTO PageContextActionMapping (PageContextID,RoleID,ActionTypeID,TemplateID,ContextType,AdditionalContext,IsAttachment,Createdat,CreatedBy)
    SELECT @PageContextID,@RoleID,@ActionTypeID,@TemplateID,'HCR','Notify','N',@CreatedAt,@CreatedBy
END
GO
-------------------------arun changes - credit note page insert start---------
DECLARE @PageID123 BIGINT
DECLARE @MenuID123 INT
DECLARE @RoleID123 BIGINT
DECLARE @OrgID123 INT
SET @OrgID123=249

SELECT @MenuID123=MAX(MenuID) FROM MenuMaster
SELECT @PageID123=MAX(PageID) FROM Pages
set  @RoleID123= (SELECT top 1 RoleID FROM [Role] WHERE OrgID=@OrgID123 and RoleName='Credit Controller')

 --select @RoleID123

IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Invoice/CreditNoteUpdation.aspx')
BEGIN
    INSERT INTO Pages(PageID,PageName,PageURL) 
    SELECT @PageID123+1,'Credit Note','/Invoice/CreditNoteUpdation.aspx'
END

IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM JOIN Pages P ON MM.PageID=P.PageID WHERE P.PageURL='/Invoice/CreditNoteUpdation.aspx' AND MM.OrgId=@OrgID123)
BEGIN
    INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID) 
    SELECT @MenuID123+1,'Credit Note',0,@OrgID123,@PageID123+1
END

IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM JOIN MenuMaster MM ON MM.MenuID=RM.MenuID JOIN Pages P ON P.PageID=MM.PageID WHERE P.PageURL='/Invoice/CreditNoteUpdation.aspx' AND MM.OrgId=@OrgID123)
BEGIN
    INSERT INTO RoleMenu(MenuID,RoleID,IsMapped) 
    SELECT @MenuID123+1,@RoleID123,'Y'
END
----------------Credit note page insert end--------------------
go
---------arun changes -- for credit client apisms should not show the content 'Rs. 0.00' start -----

DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'IsCreditClientRsHide')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'IsCreditClientRsHide','Rs.0 should not show for credit client sms','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'IsCreditClientRsHide')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 249)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',249)
END
---------arun changes -- for credit client apisms should not show the content 'Rs. 0.00' end -----


Declare @ConfigKeyID bigint

IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='NeedPassportAsVisitLevel')
				BEGIN	
					SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
					INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'NeedPassportAsVisitLevel','Do you Need to Passport No in Visit Level?','N','N')
				END
			SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='NeedPassportAsVisitLevel'
			IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='NeedPassportAsVisitLevel' AND COM.OrgID=249)
				BEGIN
					INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',249,GETDATE())
				END
				
--------------arun changes -- password scope changes-config start
DECLARE @ConfigKeyId BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'IsPasswordScope')
BEGIN
	SET @ConfigKeyId = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId,'IsPasswordScope','Pswd new scope validation','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'IsPasswordScope')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId AND OrgID = 249)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId,'Y',249)
END	
--------------arun changes -- password scope changes-config end			


Declare @ConfigKeyID int
IF NOT EXISTS(SELECT ConfigKey FROM ConfigKeyMaster WHERE ConfigKey='NeedRefPhysicianatPatientLevel')
BEGIN

SELECT @ConfigKeyID= max(ConfigKeyID)+1 from ConfigKeyMaster
INSERT INTO ConfigKeyMaster(ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)VALUES(@ConfigKeyID,'NeedRefPhysicianatPatientLevel','Need Ref Physician at Patient Level not at Visit Level','N','N')
END
SELECT @ConfigKeyID= ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='NeedRefPhysicianatPatientLevel'
IF NOT EXISTS(SELECT CKM.ConfigKeyID FROM ConfigOrgMaster COM JOIN ConfigKeyMaster CKM ON CKM.ConfigKeyID=COM.ConfigKeyID WHERE CKM.ConfigKey='NeedRefPhysicianatPatientLevel' AND COM.OrgID=248)
BEGIN
INSERT INTO ConfigOrgMaster(ConfigKeyID,ConfigValue,OrgID,CreatedAt)VALUES(@ConfigKeyID,'Y',248,GETDATE())
END
GO
---------arun changes -- 
-------for credit client registration sms - Rs. 0.00 should be hide
DECLARE @ConfigKeyId113 BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'IsCreditClientRsHide')
BEGIN
	SET @ConfigKeyId113 = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyId113,'IsCreditClientRsHide','Rs.0 should not show for credit client sms','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyId113 = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'IsCreditClientRsHide')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId113 AND OrgID = 249)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId113,'Y',249)
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId113 AND OrgID = 248)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId113,'Y',248)
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyId113 AND OrgID = 202)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyId113,'Y',202)
END


-------for client billing - patient sms entry insert into patientdispatchdetails table
DECLARE @ConfigKeyIdNew113 BIGINT

IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey = 'IsNotifySMSNeededClientBill')
BEGIN
	SET @ConfigKeyIdNew113 = (SELECT COUNT(1) from ConfigKeyMaster) +1

	INSERT INTO ConfigKeyMaster (ConfigKeyID,ConfigKey,DisplayText,IsInternal,ControlType)
	VALUES (@ConfigKeyIdNew113,'IsNotifySMSNeededClientBill','SMS to patient from client billing page','N','CHB')	
END
ELSE
BEGIN
	SET @ConfigKeyIdNew113 = (SELECT ConfigKeyID from ConfigKeyMaster WHERE ConfigKey = 'IsNotifySMSNeededClientBill')
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyIdNew113 AND OrgID = 249)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyIdNew113,'Y',249)
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyIdNew113 AND OrgID = 248)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyIdNew113,'Y',248)
END
IF NOT EXISTS (SELECT 1 FROM ConfigOrgMaster WHERE ConfigKeyID = @ConfigKeyIdNew113 AND OrgID = 202)
BEGIN
	INSERT INTO ConfigOrgMaster (ConfigKeyID,ConfigValue,OrgID)
	VALUES (@ConfigKeyIdNew113,'Y',202)
END
----
GO
----------From client billing - registration sms not came for TAT and NON-TAT Visits issue fixed
DECLARE @Roleid155 INT, @PageId INT, @PageContextid INT, @ActionTypeId INT, @OrgId INT, @PageContextid1 INT
set @OrgId = 249
SET @Roleid155 = (select top 1 ROLEID from role where rolename = 'DEO B2B' and orgid = 249)
SET @PageId = (select top 1 PageId from pages where pagename = 'Client Billing')
SET @ActionTypeId = (select top 1 ActionTypeID from ActionManagerType where ActionType = 'APISMS')
SET @PageContextid = (select top 1 PagecontextId from Pagecontext where ButtonName = 'btnGenerate' and pageid = @PageId)
IF NOT EXISTS (SELECT 1 FROM Pagecontextactionmapping WHERE actiontypeid = @ActionTypeId and roleid = @Roleid155 AND pagecontextid = @PageContextid and ContextType = 'P')
BEGIN
	INSERT INTO Pagecontextactionmapping(PageContextID,RoleID,ActionTypeID,TemplateId,ContextType,AdditionalContext,Isattachment)
	values(@PageContextid,@Roleid155,@ActionTypeId,54,'P','Notify','N'),
	(@PageContextid,@Roleid155,@ActionTypeId,97,'P','Notify','N')-- in client billing --for non tat visit sms not came issue fixes
	--,(@PageContextid,@Roleid155,@ActionTypeId,103,'P','Notify','N')
END

DECLARE @Roleid133 INT
SET @Roleid133 = (select top 1 ROLEID from role where rolename = 'DEO B2B' and orgid = 248)

IF NOT EXISTS (SELECT 1 FROM Pagecontextactionmapping WHERE actiontypeid = @ActionTypeId and roleid = @Roleid133 AND pagecontextid = @PageContextid and ContextType = 'P')
BEGIN
	INSERT INTO Pagecontextactionmapping(PageContextID,RoleID,ActionTypeID,TemplateId,ContextType,AdditionalContext,Isattachment)
	values(@PageContextid,@Roleid133,@ActionTypeId,54,'P','Notify','N'),
	(@PageContextid,@Roleid133,@ActionTypeId,97,'P','Notify','N')-- in client billing --for non tat visit sms not came issue fixes
	--,(@PageContextid,@Roleid133,@ActionTypeId,103,'P','Notify','N')
END

DECLARE @Roleid1144 INT
SET @Roleid1144 = (select top 1 ROLEID from role where rolename = 'DEO B2B' and orgid = 202)

IF NOT EXISTS (SELECT 1 FROM Pagecontextactionmapping WHERE actiontypeid = @ActionTypeId and roleid = @Roleid1144 AND pagecontextid = @PageContextid and ContextType = 'P')
BEGIN
	INSERT INTO Pagecontextactionmapping(PageContextID,RoleID,ActionTypeID,TemplateId,ContextType,AdditionalContext,Isattachment)
	values(@PageContextid,@Roleid1144,@ActionTypeId,54,'P','Notify','N'),
	(@PageContextid,@Roleid1144,@ActionTypeId,97,'P','Notify','N')-- in client billing --for non tat visit sms not came issue fixes
	--,(@PageContextid,@Roleid1144,@ActionTypeId,103,'P','Notify','N')
END

Go
---------Arun -- RLS CUSTOMER CARE NUMBER UPDATE Script
IF EXISTS (SELECT 1 FROM ActionTemplate where template like '%1800 889 2444%')
BEGIN
	UPDATE ActionTemplate SET template = REPLACE(template,'1800 889 2444','1800 889 2555') where template like '%1800 889 2444%'
END
--------------------------
GO
----arun ----delete the irrelevant entry of notification,the Template Name as 'rejectionSMS' while client billing
DECLARE @Roleid555 INT, @PageId555 INT, @PageContextid555 INT, @ActionTypeId555 INT, @OrgId555 INT, @templatetypeid555 INT, @templateid555 INT
set @OrgId555 = 202
SET @templatetypeid555 = (select top 1 templatetypeid from Actiontemplatetype where TemplateType = 'SampleRecollectAlert')
SET @Roleid555 = (select top 1 ROLEID from role where rolename = 'DEO B2B' and orgid = 202)
SET @PageId555 = (select top 1 PageId from pages where pagename = 'Client Billing')
SET @templateid555 = (SELECT top 1 TemplateID FROM Actiontemplate where templatetypeid = @templatetypeid555 and TemplateName = 'recollectSMS')
SET @PageContextid555 = (select top 1 PagecontextId from Pagecontext where ButtonName = 'btnGenerate' and pageid = @PageId555)
--select @templateid555 '@templateid555', @Roleid555 '@Roleid555', @PageContextid555 '@PageContextid555'
IF EXISTS (SELECT 1 FROM Pagecontextactionmapping WHERE templateid = @templateid555 and roleid = @Roleid555 AND pagecontextid = @PageContextid555 and ContextType = 'P')
BEGIN
	delete Pagecontextactionmapping where templateid = @templateid555 and roleid = @Roleid555 AND pagecontextid = @PageContextid555 and ContextType = 'P'
END
GO

DECLARE @ConfigKeyID BIGINT, @OrgID BIGINT
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Gorakhpur'
 
   IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='ProcessingCentreAlone')
   BEGIN
      INSERT INTO ConfigKeyMaster (ConfigkeyID,Configkey,Displaytext,isinternal,createdat)
	  SELECT MAX(ConfigkeyID)+1,'ProcessingCentreAlone','Do you want to load processing centre alone?','N',GETDATE() FROM ConfigKeyMaster 
   END
    SELECT @ConfigKeyID=  ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='ProcessingCentreAlone'
    

    IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Mumbai'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Covid (Mumbai)'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
    go

	
DECLARE @TaskActionID INT,@RoleID BIGINT,@OrgID INT
SELECT @OrgID =OrgID FROM Organization(NOLOCK) WHERE Name='RLS-Covid (Mumbai)'
SELECT @RoleID=RoleID FROM ROLE(NOLOCK) WHERE OrgID=@OrgID AND RoleName='Sr Credit Controller' AND Description='Sr Credit Controller'
SELECT @TaskActionID=TaskActionID FROM Taskactions(NOLOCK) where ActionName='PerformCancel' AND Category='Payment' 

IF NOT EXISTS (SELECT 1 FROM TaskActionOrgMapping (NOLOCK) WHERE TaskActionID=@TaskActionID AND OrgID=@OrgID AND RoleID=@RoleID)
BEGIN
	INSERT INTO TaskActionOrgMapping(TaskActionID,RoleID,OrgID,CreatedAt,CreatedBy)
	SELECT @TaskActionID,@RoleID,@OrgID,GETDATE(),182
END

SELECT @TaskActionID=TaskActionID FROM Taskactions(NOLOCK) where ActionName='PerformRefund' AND Category='Payment' 

IF NOT EXISTS (SELECT 1 FROM TaskActionOrgMapping (NOLOCK) WHERE TaskActionID=@TaskActionID AND OrgID=@OrgID AND RoleID=@RoleID)
BEGIN
	INSERT INTO TaskActionOrgMapping(TaskActionID,RoleID,OrgID,CreatedAt,CreatedBy)
	SELECT @TaskActionID,@RoleID,@OrgID,GETDATE(),182
END

GO


DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS-Covid (Mumbai)'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetDumpBeforeInvoice' AND Description='Dump Before Invoice')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetDumpBeforeInvoice','Dump Before Invoice'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetDumpBeforeInvoice' AND Description='Dump Before Invoice'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Dump Before Invoice' AND SP=@SpID AND ReportName='Dump Before Invoice' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Dump Before Invoice',@SpID,'Dump Before Invoice','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Dump Before Invoice' AND SP=@SpID AND ReportName='Dump Before Invoice' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
	INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
	SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO
DECLARE @ConfigKeyID BIGINT, @OrgID BIGINT
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Gorakhpur'
 
   IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='ProcessingCentreAlone')
   BEGIN
      INSERT INTO ConfigKeyMaster (ConfigkeyID,Configkey,Displaytext,isinternal,createdat)
	  SELECT MAX(ConfigkeyID)+1,'ProcessingCentreAlone','Do you want to load processing centre alone?','N',GETDATE() FROM ConfigKeyMaster 
   END
    SELECT @ConfigKeyID=  ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='ProcessingCentreAlone'
    

    IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Mumbai'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Covid (Mumbai)'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
    go
 IF EXISTS (SELECT 1 FROM reasonMaster R (NOLOCK) INNER JOIN reasontype RT (NOLOCK) ON R.ReasonTypeID=RT.typeID AND TypeCode='RM' AND Displaytext='Audit Reason' AND Status='A')
			 BEGIN
				UPDATE R
				SET R.Status='D'
				FROM reasonMaster R (NOLOCK) INNER JOIN reasontype RT (NOLOCK) ON R.ReasonTypeID=RT.typeID AND TypeCode='RM' AND Displaytext='Audit Reason' AND Status='A'
			 END
			 IF EXISTS (SELECT 1 FROM reasonMaster R (NOLOCK) INNER JOIN reasontype RT (NOLOCK) ON R.ReasonTypeID=RT.typeID AND TypeCode='TM' AND Displaytext='Audit Reason'  AND Status='A')
			 BEGIN
				UPDATE R
				SET R.Status='D'
				FROM reasonMaster R (NOLOCK) INNER JOIN reasontype RT (NOLOCK) ON R.ReasonTypeID=RT.typeID AND TypeCode='CMR' AND Displaytext='Audit Reason'  AND Status='A'
			 END
			 IF EXISTS (SELECT 1 FROM reasonMaster R (NOLOCK) INNER JOIN reasontype RT (NOLOCK) ON R.ReasonTypeID=RT.typeID AND TypeCode='CMR' AND Displaytext='Audit Reason' AND Status='A')
			 BEGIN
				UPDATE R
				SET R.Status='D'
				FROM reasonMaster R (NOLOCK) INNER JOIN reasontype RT (NOLOCK) ON R.ReasonTypeID=RT.typeID AND TypeCode='CMR' AND Displaytext='Audit Reason'
			 END
GO

 DECLARE @MenuID BIGINT,@RoleID BIGINT,@PageID INT,@OrgID INT
 SELECT @PageID=PageID FROM Pages (NOLOCK) where Pageurl='/HomeCollection/homecollection.aspx'
 SELECT @OrgID =OrgID FROM Organization (NOLOCK) WHERE Name='RLS-Covid (Mumbai)'
 SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='DEO Home Visit'
 SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster
 IF NOT EXISTS (SELECT 1 FROM MenuMaster where DisplayText='Home collection' AND PageID=@PageID AND OrgID=@OrgID And Languagecode='en-GB')
 BEGIN
		INSERT INTO MenuMaster (MenuID,DisplayText,ParentID,OrgID,PageID,Languagecode,Createdat)
		SELECT @MenuID,'Home collection',0,@OrgID,@PageID,'en-GB',GETDATE()
 END

 SELECT @MenuID=MenuID FROM MenuMaster where DisplayText='Home collection' AND PageID=@PageID AND OrgID=@OrgID And Languagecode='en-GB'

 If NOT EXISTS(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID AND MenuID=@MenuID)
 BEGIN
   INSERT INTO RoleMenu (RoleID,MenuID,Ismapped,Createdat)
   SELECT @RoleID,@MenuID,'Y',GETDATE()
 END 

 SELECT @OrgID =OrgID FROM Organization (NOLOCK) WHERE Name='RLS-Gorakhpur'
 SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='DEO Home Visit'
 SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster
 IF NOT EXISTS (SELECT 1 FROM MenuMaster where DisplayText='Home collection' AND PageID=@PageID AND OrgID=@OrgID And Languagecode='en-GB')
 BEGIN
		INSERT INTO MenuMaster (MenuID,DisplayText,ParentID,OrgID,PageID,Languagecode,Createdat)
		SELECT @MenuID,'Home collection',0,@OrgID,@PageID,'en-GB',GETDATE()
 END

 SELECT @MenuID=MenuID FROM MenuMaster where DisplayText='Home collection' AND PageID=@PageID AND OrgID=@OrgID And Languagecode='en-GB'

 If NOT EXISTS(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID AND MenuID=@MenuID)
 BEGIN
   INSERT INTO RoleMenu (RoleID,MenuID,Ismapped,Createdat)
   SELECT @RoleID,@MenuID,'Y',GETDATE()
 END 

 SELECT @OrgID =OrgID FROM Organization (NOLOCK) WHERE Name='RLS Mumbai'
 SELECT @RoleID=RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='DEO Home Visit'
 SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster
 IF NOT EXISTS (SELECT 1 FROM MenuMaster where DisplayText='Home collection' AND PageID=@PageID AND OrgID=@OrgID And Languagecode='en-GB')
 BEGIN
		INSERT INTO MenuMaster (MenuID,DisplayText,ParentID,OrgID,PageID,Languagecode,Createdat)
		SELECT @MenuID,'Home collection',0,@OrgID,@PageID,'en-GB',GETDATE()
 END

 SELECT @MenuID=MenuID FROM MenuMaster where DisplayText='Home collection' AND PageID=@PageID AND OrgID=@OrgID And Languagecode='en-GB'

 If NOT EXISTS(SELECT 1 FROM RoleMenu WHERE RoleID=@RoleID AND MenuID=@MenuID)
 BEGIN
   INSERT INTO RoleMenu (RoleID,MenuID,Ismapped,Createdat)
   SELECT @RoleID,@MenuID,'Y',GETDATE()
 END 

 GO
 DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT,@CreatedAT DATETIME
SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Gorakhpur'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster
SELECT @PageID=MAX(PageID)+1 FROM Pages
 
IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Billing/CheckingBillFeeDetails.aspx')
BEGIN
    INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt) 
    SELECT @PageID,'Check Bill Fee Details','/Billing/CheckingBillFeeDetails.aspx',GETDATE()
END
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Billing/CheckingBillFeeDetails.aspx'

IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Sr Credit Controller' AND Description='Sr Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

	
END
SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Mumbai'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster


IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Sr Credit Controller' AND Description='Sr Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

	
END

SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Covid (Mumbai)'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster


IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Sr Credit Controller' AND Description='Sr Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

END

SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Jamnagar'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster


IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Sr Credit Controller' AND Description='Sr Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

	
END

GO

DECLARE @PageID BIGINT
DECLARE @MenuID INT
DECLARE @RoleID BIGINT
DECLARE @OrgID INT,@CreatedAT DATETIME
SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Gorakhpur'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster
SELECT @PageID=MAX(PageID)+1 FROM Pages
 
IF NOT EXISTS(SELECT PageID FROM Pages WHERE PageURL='/Billing/CheckingBillFeeDetails.aspx')
BEGIN
    INSERT INTO Pages(PageID,PageName,PageURL,CreatedAt) 
    SELECT @PageID,'Check Bill Fee Details','/Billing/CheckingBillFeeDetails.aspx',GETDATE()
END
SELECT @PageID=PageID FROM Pages WHERE PageURL='/Billing/CheckingBillFeeDetails.aspx'

IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Credit Controller' AND Description='Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

	
END
SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Mumbai'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster


IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Credit Controller' AND Description='Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

	
END

SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Covid (Mumbai)'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster


IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Credit Controller' AND Description='Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

END

SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Jamnagar'
SET @CreatedAT=GETDATE()
SELECT @MenuID=MAX(MenuID)+1 FROM MenuMaster


IF ISNULL(@OrgID,0) > 0
BEGIN
	SELECT  @RoleID=  RoleID FROM [Role] WHERE OrgID=@OrgID  and RoleName='Credit Controller' AND Description='Credit Controller'
	IF ISNULL(@RoleID,0) > 0
	BEGIN
		IF NOT EXISTS(SELECT MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID)
		BEGIN
			INSERT INTO MenuMaster(MenuID,DisplayText,Parentid,OrgId,PageID,CreatedAT) 
			SELECT @MenuID,'Check Bill Fee Details',0,@OrgID,@PageID,@CreatedAT
		END
		SELECT @MenuID=MenuID FROM MenuMaster MM   WHERE PageId=@PageID AND Displaytext='Check Bill Fee Details' AND MM.OrgId=@OrgID
		IF NOT EXISTS(SELECT RoleID FROM RoleMenu RM WHERE MenuID=@MenuID AND ROleID=@RoleID  )
		BEGIN
			INSERT INTO RoleMenu(MenuID,RoleID,IsMapped,Createdat) 
			SELECT @MenuID,@RoleID,'Y',@Createdat
		END
	END

	
END

GO
DECLARE @MetadataID INT,@OrgID INT,@CreatedAt DATETIME,@CreatedBy BIGINT,@LangCode NVARCHAR(100)

SELECT @CreatedAt=GETDATE(),@CreatedBy=182,@LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM MetaData WHERE Domain='CreditNoSeach'  AND Code='ALL' AND DisplayText='All' AND Langcode=@LangCode)
BEGIN
	INSERT INTO MetaData(Domain,Code,DisplayText,CreatedAt,CreatedBy,LangCode)
	SELECT 'CreditNoSeach','ALL','All',@CreatedAt,@CreatedBy,@LangCode
END


IF NOT EXISTS (SELECT 1 FROM MetaData WHERE Domain='CreditNoSeach'  AND Code='CNNI' AND DisplayText='CreditNote not issued' AND Langcode=@LangCode)
BEGIN
	INSERT INTO MetaData(Domain,Code,DisplayText,CreatedAt,CreatedBy,LangCode)
	SELECT 'CreditNoSeach','CNNI','CreditNote not issued',@CreatedAt,@CreatedBy,@LangCode
END


IF NOT EXISTS (SELECT 1 FROM MetaData WHERE Domain='CreditNoSeach'  AND Code='CNI' AND DisplayText='CreditNote issued' AND Langcode=@LangCode)
BEGIN
	INSERT INTO MetaData(Domain,Code,DisplayText,CreatedAt,CreatedBy,LangCode)
	SELECT 'CreditNoSeach','CNI','CreditNote issued',@CreatedAt,@CreatedBy,@LangCode
END

SELECT @OrgID=OrgID FROM Organization WHERE Name='RLS-Covid (Mumbai)'
SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='ALL' AND DisplayText='All' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
	SELECT @MetadataID,@OrgID,'All',@CreatedAt,@CreatedBy,'Y',@LangCode
END


SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNNI' AND DisplayText='CreditNote not issued' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,Langcode)
	SELECT @MetadataID,@OrgID,'CreditNote not issued',@CreatedAt,@CreatedBy,'Y',@LangCode
END

SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNI' AND DisplayText='CreditNote issued' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
	SELECT @MetadataID,@OrgID,'CreditNote issued',@CreatedAt,@CreatedBy,'Y',@LangCode
END


SELECT @OrgID=OrgID FROM Organization WHERE Name='RLS-Gorakhpur'
SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='ALL' AND DisplayText='All' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
	SELECT @MetadataID,@OrgID,'All',@CreatedAt,@CreatedBy,'Y',@LangCode
END


SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNNI' AND DisplayText='CreditNote not issued' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,Langcode)
	SELECT @MetadataID,@OrgID,'CreditNote not issued',@CreatedAt,@CreatedBy,'Y',@LangCode
END

SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNI' AND DisplayText='CreditNote issued' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
	SELECT @MetadataID,@OrgID,'CreditNote issued',@CreatedAt,@CreatedBy,'Y',@LangCode
END

SELECT @OrgID=OrgID FROM Organization WHERE Name='RLS Mumbai'
SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='ALL' AND DisplayText='All' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
	SELECT @MetadataID,@OrgID,'All',@CreatedAt,@CreatedBy,'Y',@LangCode
END


SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNNI' AND DisplayText='CreditNote not issued' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,Langcode)
	SELECT @MetadataID,@OrgID,'CreditNote not issued',@CreatedAt,@CreatedBy,'Y',@LangCode
END

SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNI' AND DisplayText='CreditNote issued' AND Langcode=@LangCode

IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
BEGIN
	INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
	SELECT @MetadataID,@OrgID,'CreditNote issued',@CreatedAt,@CreatedBy,'Y',@LangCode
END


SELECT @OrgID=OrgID FROM Organization WHERE Name='RLS Jamnagar'
SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='ALL' AND DisplayText='All' AND Langcode=@LangCode
IF @OrgID IS NOT NULL
BEGIN
	IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
	BEGIN
		INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
		SELECT @MetadataID,@OrgID,'All',@CreatedAt,@CreatedBy,'Y',@LangCode
	END


	SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNNI' AND DisplayText='CreditNote not issued' AND Langcode=@LangCode

	IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
	BEGIN
		INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,Langcode)
		SELECT @MetadataID,@OrgID,'CreditNote not issued',@CreatedAt,@CreatedBy,'Y',@LangCode
	END

	SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNI' AND DisplayText='CreditNote issued' AND Langcode=@LangCode

	IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
	BEGIN
		INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
		SELECT @MetadataID,@OrgID,'CreditNote issued',@CreatedAt,@CreatedBy,'Y',@LangCode
	END
END

SELECT @OrgID=OrgID FROM Organization WHERE Name='RLS Surat'
SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='ALL' AND DisplayText='All' AND Langcode=@LangCode
IF @OrgID IS NOT NULL
BEGIN
	IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
	BEGIN
		INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
		SELECT @MetadataID,@OrgID,'All',@CreatedAt,@CreatedBy,'Y',@LangCode
	END


	SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNNI' AND DisplayText='CreditNote not issued' AND Langcode=@LangCode

	IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
	BEGIN
		INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,Langcode)
		SELECT @MetadataID,@OrgID,'CreditNote not issued',@CreatedAt,@CreatedBy,'Y',@LangCode
	END

	SELECT @MetadataID=MetadataID FROM Metadata WHERE Domain='CreditNoSeach'  AND Code='CNI' AND DisplayText='CreditNote issued' AND Langcode=@LangCode

	IF NOT EXISTS (SELECT 1 FROM MetaDataOrgMapping WHERE Metadataid=@MetadataID AND OrgID=@OrgID)
	BEGIN
		INSERT INTO MetaDataOrgMapping(MetadataID,OrgID,DisplayText,CreatedAt,CreatedBy,IsActive,LangCode)
		SELECT @MetadataID,@OrgID,'CreditNote issued',@CreatedAt,@CreatedBy,'Y',@LangCode
	END
END
GO


-- Prepaid Card Changes -- Seetha -- Start



DECLARE @ConfigKeyID BIGINT, @OrgID BIGINT
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Gorakhpur'
 
   IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='NeedPrepaidCardinsteadofDD')
   BEGIN
      INSERT INTO ConfigKeyMaster (ConfigkeyID,Configkey,Displaytext,isinternal,createdat)
	  SELECT MAX(ConfigkeyID)+1,'NeedPrepaidCardinsteadofDD','Do you need Prepaid card option instead of Demand Draft?','N',GETDATE() FROM ConfigKeyMaster 
   END
    SELECT @ConfigKeyID=  ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='NeedPrepaidCardinsteadofDD'
    

    IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Mumbai'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Covid (Mumbai)'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
    End
	SELECT @OrgID=OrgID FROM organization WHERE Name='RLS Jamnagar'
	IF @OrgID is not null
	BEGIN
		IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
		Begin
			INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
			SELECT @ConfigKeyID, 'Y', @OrgID, getdate(), -1
		End
	END
    go

-- Prepaid Card Changes -- Seetha -- END


-- Referring Doctor Scope Change -- Seetha Start

Declare @OrgID int, @configID int
Set @OrgID = 202
set @configID = (select ConfigKeyId from Configkeymaster where configkey='ManditaryRefPhy')
If Exists (select 1 from ConfigORgMaster where OrgID=@OrgID and ConfigkeyID=@configID)
BEGIN
Update ConfigOrgMaster set ConfigValue='N' where OrgID=@OrgID and ConfigkeyID=@configID
END
GO
Declare @OrgID int, @configID int
Set @OrgID = 249
set @configID = (select ConfigKeyId from Configkeymaster where configkey='ManditaryRefPhy')
If Exists (select 1 from ConfigORgMaster where OrgID=@OrgID and ConfigkeyID=@configID)
BEGIN
Update ConfigOrgMaster set ConfigValue='N' where OrgID=@OrgID and ConfigkeyID=@configID
END
GO
Declare @OrgID int, @configID int
Set @OrgID = 248
set @configID = (select ConfigKeyId from Configkeymaster where configkey='ManditaryRefPhy')
If Exists (select 1 from ConfigORgMaster where OrgID=@OrgID and ConfigkeyID=@configID)
BEGIN
Update ConfigOrgMaster set ConfigValue='N' where OrgID=@OrgID and ConfigkeyID=@configID
END
GO


-- Referring Doctor Scope Change -- Seetha END


DECLARE @ConfigKeyID BIGINT, @OrgID BIGINT
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Gorakhpur'
 
   IF NOT EXISTS (SELECT 1 FROM ConfigKeyMaster WHERE ConfigKey='AllowFreeTextinRefphysician')
   BEGIN
      INSERT INTO ConfigKeyMaster (ConfigkeyID,Configkey,Displaytext,isinternal,createdat)
	  SELECT MAX(ConfigkeyID)+1,'AllowFreeTextinRefphysician','AllowFreeTextinRefphysician','N',GETDATE() FROM ConfigKeyMaster 
   END
    SELECT @ConfigKeyID=  ConfigKeyID FROM ConfigKeyMaster WHERE ConfigKey='AllowFreeTextinRefphysician'
    

    IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'N', @OrgID, getdate(), -1
    End
	
	If EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
	BEGIN
	Update ConfigOrgMaster set ConfigValue='N' where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID
	END

	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS Mumbai'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'N', @OrgID, getdate(), -1
    End
	If EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
	BEGIN
	Update ConfigOrgMaster set ConfigValue='N' where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID
	END
	SELECT @OrgID = OrgID FROM organization WHERE Name='RLS-Covid (Mumbai)'
	IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
    Begin
        INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
        SELECT @ConfigKeyID, 'N', @OrgID, getdate(), -1
    End

	If EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
	BEGIN
	Update ConfigOrgMaster set ConfigValue='N' where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID
	END
	SELECT @OrgID=OrgID FROM organization WHERE Name='RLS Jamnagar'
	IF @OrgID is not null
	BEGIN
		IF NOT EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
		Begin
			INSERT INTO ConfigOrgMaster(ConfigKeyID, ConfigValue, OrgID, CreatedAt, CreatedBy) 
			SELECT @ConfigKeyID, 'N', @OrgID, getdate(), -1
		End
		If EXISTS(SELECT 1 FROM ConfigOrgMaster where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID) AND @ConfigKeyID > 0
	BEGIN
	Update ConfigOrgMaster set ConfigValue='N' where ConfigKeyID=@ConfigKeyID AND OrgID=@OrgID
	END
	END
    go


Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'INDIVIDUAL PREPAID ANNUAL'
Set @OrGId = 249
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'INDIVIDUAL PREPAID LIFETIME'
Set @OrGId = 249
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'FAMILY PREPAID ANNUAL'
Set @OrGId = 249
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'FAMILY PREPAID LIFETIME'
Set @OrGId = 249
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO

Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'INDIVIDUAL PREPAID ANNUAL'
Set @OrGId = 202
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'INDIVIDUAL PREPAID LIFETIME'
Set @OrGId = 202
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'FAMILY PREPAID ANNUAL'
Set @OrGId = 202
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'FAMILY PREPAID LIFETIME'
Set @OrGId = 202
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO

Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'INDIVIDUAL PREPAID ANNUAL'
Set @OrGId = 248
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'INDIVIDUAL PREPAID LIFETIME'
Set @OrGId = 248
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'FAMILY PREPAID ANNUAL'
Set @OrGId = 248
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO
Declare @CardType Nvarchar(100),@OrGId int
Set @CardType = 'FAMILY PREPAID LIFETIME'
Set @OrGId = 248
if Not Exists (select 1 from PrepaidCardType where CardType=@CardType and OrgId=@OrgID)
BEGIN
Insert into PrepaidCardType (CardType,OrGID)
select @CardType,@OrgID
END
GO

DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS-Covid (Mumbai)'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetCovidIntegrationStatus','Covid Integration Status Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Covid Integration Status Report',@SpID,'Covid Integration Status Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO

DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS-Gorakhpur)'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetCovidIntegrationStatus','Covid Integration Status Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Covid Integration Status Report',@SpID,'Covid Integration Status Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO

DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS Mumbai'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetCovidIntegrationStatus','Covid Integration Status Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Covid Integration Status Report',@SpID,'Covid Integration Status Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO


DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS Surat'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetCovidIntegrationStatus','Covid Integration Status Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Covid Integration Status Report',@SpID,'Covid Integration Status Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO

DECLARE @ReportID INT,@RoleID BIGINT,@OrgID INT,@SpID INT
SELECT @OrgID =OrgID FROM Organization WHERE Name='RLS Jamnagar'
SELECT @RoleID =RoleID FROM Role WHERE OrgID=@OrgID AND RoleName='Administrator' AND LangCode='en-GB'

IF NOT EXISTS (SELECT 1 FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report')
BEGIN
 INSERT INTO ReportExcelSp (Name,Description)
 SELECT 'pGetCovidIntegrationStatus','Covid Integration Status Report'
END
SELECT @SpID =ID FROM ReportExcelSp WHERE  Name='pGetCovidIntegrationStatus' AND Description='Covid Integration Status Report'

IF NOT EXISTS (SELECT 1 FROM ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup')
BEGIN
  INSERT INTO ReportExcelMaster(ExcelName,SP,ReportName,ParameterType,IsActive)
  SELECT 'Covid Integration Status Report',@SpID,'Covid Integration Status Report','ShowDateRangePopup',1
END

SELECT @ReportID =ID FROM   ReportExcelMaster (NOLOCK) WHERE ExcelName='Covid Integration Status Report' AND SP=@SpID AND ReportName='Covid Integration Status Report' AND Parametertype='ShowDateRangePopup'

IF NOT EXISTS ( SELECT 1 FROM ReportExcelRoleMapping (NOLOCK) WHERE   Reportid=@ReportID AND RoleID=@RoleID )
BEGIN
INSERT INTO ReportExcelRoleMapping (Reportid,RoleID,IsActive,Createdat)
SELECT @ReportID,@RoleID,1,GETDATE()
END  
GO